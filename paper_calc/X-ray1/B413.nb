(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    193603,       5060]
NotebookOptionsPosition[    189597,       4978]
NotebookOutlinePosition[    190463,       5008]
CellTagsIndexPosition[    190420,       5005]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["grid and integration ", "Title",
 CellChangeTimes->{{3.861949729115543*^9, 3.8619497555245047`*^9}, {
  3.862013358777443*^9, 3.862013370505025*^9}, {3.862110010914356*^9, 
  3.862110027031199*^9}},
 TextAlignment->Center,ExpressionUUID->"85ee1e26-2fae-4e19-98ad-c5d22ed128fd"],

Cell[CellGroupData[{

Cell["1. Global constants and basic functions", "Section",
 CellChangeTimes->{{3.8619497826752243`*^9, 3.861949792911045*^9}, {
  3.861950789185286*^9, 3.861950796134797*^9}, {3.862110038365808*^9, 
  3.862110045210286*^9}},ExpressionUUID->"1409faf0-fa3b-48b9-b0fe-\
28cdb8fefba3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hbar", "=", 
   RowBox[{"1.0545718176461565", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "27"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", "=", 
   RowBox[{"4.803204712570263", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "10"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"me", "=", 
   RowBox[{"9.1093837015", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "28"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mp", "=", 
   RowBox[{"1.67262192369", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "24"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", "1"}], ";", 
  RowBox[{"Z", "=", "1"}], ";", 
  RowBox[{"Ye", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kb", "=", 
   RowBox[{"1.380649", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "16"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kev2erg", "=", 
   RowBox[{"1.6021766339999998", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", "29979245800.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]T", "=", 
   RowBox[{"8", "*", 
    FractionBox["\[Pi]", "3"], "*", 
    FractionBox[
     SuperscriptBox["e", "4"], 
     RowBox[{
      SuperscriptBox["c", "4"], " ", 
      SuperscriptBox["me", "2"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]T", "=", 
   FractionBox["\[Sigma]T", "mp"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"6.674299999999999", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "8"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Ms", "=", 
   RowBox[{"1.988409870698051", "*", 
    RowBox[{"10", "^", "33"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"km", "=", 
   SuperscriptBox["10", "5"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]F", "=", 
   FractionBox[
    SuperscriptBox["e", "2"], 
    RowBox[{"hbar", " ", "c"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BQ", "=", 
   RowBox[{
    SuperscriptBox["me", "2"], "*", 
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "3"], "/", "e"}], "/", "hbar"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"10.0", "^", 
    RowBox[{"Range", "[", 
     RowBox[{"a", ",", "b", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"linearspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Range", "[", 
    RowBox[{"a", ",", "b", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", "-", "a"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C0", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "a"}], "-", 
    RowBox[{
     RowBox[{"Exp", "[", "a", "]"}], "*", 
     RowBox[{"ExpIntegralE", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"C1", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "a"}], ")"}], "*", 
     RowBox[{"Exp", "[", "a", "]"}], "*", 
     RowBox[{"ExpIntegralE", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radian", "[", "x_", "]"}], ":=", 
   RowBox[{
    FractionBox["x", "180"], "*", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Planck", "[", 
    RowBox[{"Es_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"2", "*", "hbar", "*", "2", "*", "\[Pi]", "*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Es", "*", 
        RowBox[{
         RowBox[{
          RowBox[{"kev2erg", "/", "hbar"}], "/", "2"}], "/", "\[Pi]"}]}], 
       ")"}], "^", "3"}], "/", 
     RowBox[{"c", "^", "2"}]}], "*", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Es", "*", "kev2erg"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}]}], "]"}], "-", "1"}], ")"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.86195011325911*^9, 3.861950161810429*^9}, {
  3.861950226622788*^9, 3.8619502705418053`*^9}, {3.861950450560298*^9, 
  3.86195050074433*^9}, {3.861950692125059*^9, 3.8619507100833673`*^9}, {
  3.861950761050561*^9, 3.861950765426078*^9}, {3.861961074401415*^9, 
  3.861961076247954*^9}, {3.862022828791157*^9, 3.8620228294910097`*^9}, {
  3.8621100714817133`*^9, 3.862110072547246*^9}, {3.862110711005892*^9, 
  3.862110711904375*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a36d15ba-8ec5-4d46-843a-f18f6d2fab97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temperature profile", "Section",
 CellChangeTimes->{{3.8620163980057573`*^9, 
  3.862016401340963*^9}},ExpressionUUID->"01ed5fe8-1806-4689-902c-\
6ccdd2a3b8df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"temperature", "[", "\[Tau]_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Tau]mid", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]mid", "=", "11.9"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a1", "=", "0.623"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a2", "=", 
       RowBox[{"-", "0.0425"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a3", "=", "0.0991"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a4", "=", "0.0412"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a5", "=", " ", 
       RowBox[{"-", "0.026"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a6", "=", "0.0036"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b3", "=", 
       RowBox[{"-", "0.0851"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b4", "=", 
       RowBox[{"-", "0.00392"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b5", "=", "0.0034"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b6", "=", "0.000418"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"temperature", "[", "\[Tau]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Tau]", ",", "0.001", ",", 
     SuperscriptBox["10", "4"]}], "}"}], ",", 
   RowBox[{"Background", "\[Rule]", "White"}], ",", 
   RowBox[{"PlotTheme", "->", "\"\<Monochrome\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{3.862110292583253*^9, 3.863135136434573*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"c532bf20-f6b3-406c-9708-12145a47ac2b"],

Cell[BoxData[
 GraphicsBox[{{{{}, {}, 
     TagBox[
      {GrayLevel[0], AbsoluteThickness[1.6], Opacity[1.], Dashing[{}], 
       CapForm["Butt"], LineBox[CompressedData["
1:eJwV1Xk41NsbAPCZiZsQZY+ELKlmvkklWrxHyU7ZUhnLiCxZU137j2ghSoiU
KUm6EUWJOylTXYWSUlGZirJFNbIz2+/MH9/nPJ/nPOd8z/Ke99Xxi3AJoJBI
pPv4E7fkroTUjKsabPav0oLAVVSU8LG3JK5Igz06X3nhHeypbqsnIQUabFve
97Mz2D97FpHtszTYB8PaHqavpqLO4dIkmVgNth5TqeEWlYpuCV/GZu7SYP81
F+swSVDRbgPNyDMidfY1aR3pc+tw/5GH9BwvdfaNmLhNk1uoyH9mgcI+oRo7
9JvzxrUuVMS9v0oz6L4q2+cf6WmjQCqqNTcm9R9WYZ8Ip/eMJlDRqfIdjTpq
yuwBV61V3eepiOZCe1faocjW87ru6VpFRV8/azcNRimw4xl1P9VaqeilMS+r
UHUxW6+2Ki91gIrUTrru1b0pz74SpSX5g0xDNZHNTrk/ZdnROQv5B7RpaPRN
P/estzQ72eKlfNBWGrre9BqFfJ7PfgqcyeX7aOhwylvb//Ql2Y99v4z7xdLQ
4L0kYXkRha3rnTXPK5+Gfvimdi5niRoLfKOqd9Ti+RJK5Svc5hrbH1eWtnbQ
EJxSKXZwmGwcXpZbbP+Lhk5aR1p0V3IbF7etVb0oRSAdL/c/OxP7G81PBxpE
aRPI1mDdvJP97xqz5FbGGpgSqBZ4rNNK6RBXWT047kCg0sgI77oL56D5/vn4
LY4ECrdgfDW8kQ9VLh+G0rBTokpGJf2KYXib2U5lJwIpKZ4YG0oqh6mactv1
OwmkWWEQ70Gvg0J7z8EQZwItnz7aKPeiCdTLFD1Y7gTS07zCCKG8h4YzJZe+
eBGIZlFxTGffezD5Q7Vf7k0gk4C6ax+q3wNr9H5zALZtZXu/FaMT0k8m0H5i
h28lheiyu2B+Qs2lKR8C1XsxDnESP0GHUDBL9iOQ42XdVKfZr9A6+9p0LIBA
q3tVO44Z9sDmcpvUNQcIZDTO9PN264GU9b6FodhmquWpyrd6INdZz3AA28Hn
SVOqZy9EOs60dQYSKIo7ZuvL+gY5e66sqgom0AN5N5clMf1g/aD4xvowAlld
1FKTvdoPpwzaSwOxX+uNfBa29AMzbs+hi9h9ZseC+zQGYEmZRZIIW87/TvLt
xgE4mtfl8TycQIx62ds75g/B4+kwSadIAs1nNMkcyh8GleIVAybRBMoZyX7j
3zgMrABOx37spUfpBR5Dw0C5q3smG9vo9PjyrZtGIH2lceQP7H21OpukvozA
i9MtPRcOE6hyQVLQZf1fEBH1IvD3EQK51pg0td7jwu4NCZXRMQS6v1/yDpfD
Bc5pnexC7EzpEMcMyig0/ymxaMTmPjA1vb1qFEZ/z18sHYvjZVnnwtm4Ucju
E/gwsS36Fv2bqfEH3CP+u8uKI9DeiBPy9+hjEOao/7k9gUDSzb/SnkWOwa2b
Malc7AZt97kPaWPQuWb5tFwigbQ6dPsFt8bgk7+NlSN2//rHLGvBGHi5FBx7
jh01xwvoZo5DSygpuCaJQOnHoxooXyfgZdqaIkYygea01Na3TEzA63z/mQTs
ENajirPSk7DZzFr1ArYDV+bSUpNJWLCfU9SGLbe3LNYkaxLM4llNG1IIlEft
NgnZPAWdCpRjc9gSz1OqjJynYKFWLEXhGIGOMAwNpg9MQSE8slyJvTv/iHJa
zhSokhLkPLCXkBZNMH9MgYq+Te1t7MtvLavfFEzDml5XS/dUAsmHjxheqJyG
oYOu3UHYyVI5xd5PpyFlyHZdAjZj69ezI7+nIXHJoH4Jtt6N2HBJqxlQ/B2t
NIKdZ6E98MJzBpb4NFTzsSU5z7xyombgXmCuvFwagQYWKTlqMWdAo/5fWSPs
m3FVq80mZuBoZrJMFLa6svs10YJZ+Hq3syIZO+M2T/2Z1izk2bjLZmOH9tlI
u9rPwgeHwoVV2ITT96HQkllorf8sP4h9T0etrHjXHGxxTJRyPE6goBhG/Zj/
HFw9NNLjga3RXt5qGTsHVo7KKX7YxxK2coeuzkHa7GG1v7F3dfmZrh2fA/d8
1xImtgRxyy51Pg8qmGfqyrDr0ibp7zV4oPhoY95t7GXGp1JiLXmwnFx1jY39
K7Oy9fF5HjQs1VbvwS7+PsVRLOfBuPXj4EFst02IG/CIB/o1acm/sRsGOxSl
B3lA/+wwj48dab7UgM7jASEwj6CcIJDu+QDTKnk+FC0hSqSwM7bN0F1M+fDA
7QtdCdu80CKi1IEPTJmsviXYf7gZKVO+fDjOVVynhb2HqVl2MZ0P+o+O663E
lp04UP+TyYe3cd7PadiNdndazWv4kCg1YmSMbTCzjfvtEx8yM3gem7A/OWWS
N3D5IH86TNkcO+v6e8WT8wTw6nBEoQU24i8z+KgqAHXfme+W2BMuQaarqQK4
FCqasMb+52a1XSISgOPj+Jd22J4kHr3dTQCnMv1DHLHlPCwjdIIFQJaofrUT
+0llVkp0ogBa/ffMOmMflejKbTonAM9x52FX7JWe2mWqZQI4x8u76o7NqQ6u
D2YJoOa1mpYHdrbU3dYHrwQQ2fbObw+2pQ+fs/C7AEZc2aF7sadrd3B9pgVQ
19axZR92uexZco2MEDgV896K7b3/g6KEthA+HLBb44mtwNIx2L1eCDeTLjuL
3bTooOk/NkJ4FjdtJnZM4D27OboQVg87DInHUx8J6A5RQnDbn08Xu0fJOuLy
cSHYpb3IF/8/92B2ymihEC6Ofc8Xr8/qycfcbVVC8PPsoovXP6emW5b3RAg7
o5lD4v1VRYTWD3QK4doUbZMbNuNZbavpiBCMbyY7u2AraYo4GSIhhO3OInZh
N0fbcDmKIvB7Y/9GfL4JrefIawxFwJq4a2aPbaTTrZiyRQRNJQ8DbbALXoWZ
6geIIMDpvNI2bOnAKYfV8SJgrvx7h/i+E0RJjLXnRBC/pWStOB78jLIztj4U
QdLJis1rsd81q13Z/lYEwYVH9lKxrRlX79r+EMHpfF/jFdgqtnt/l0uT0OH4
KOWl2LvOM2cqlUkoMSdVSwU7vbeXUq1NQjvHz/TJY/NjQ1TrTEhoQWDIFXH8
95bHo6d+JMSw1Ovqw+9DfbrR7lkYCclmjtZxxO9pu4R7SwwJLe0Jcn2H/aw7
M7j9DAkpfN7IeoJ9S/ZyTjeLhNZybKyKsAf2fCv60kRC93+G885ha103uNH7
moQajk+FnMTO2Xr7weAACfn3SMZGYf8dzu4bVyCjkSzDXduw77AkuFOaZKQz
4tW1AXv4L9vZWUMySpKvVFuJTb/yZiEJyKiu+EiLHPa2199MZA+S0SFhw7dO
nJ/il66wkD9KRot828yaxfkq6KC9QgoZyeTW2P2LvYI84aNWQEZ5zR8LL2LL
Gkum6z0lo5Dwmp97sa2SbHNXvCIjJJW82Bb7f61ZzFUfycjcpYe7EXvMT6XG
iEtGRo2mH5Wwu3JXdG/RoCBFfrDXC5yPSyZtae7RFLSqn6e3GjtHpp2tl0RB
8STX7SrYKTpubhOnKOiDtIsmGdvX0Ts+9zIFNRNUiU5cL5ZdP9TypoWCWAPZ
RQnYF90uBThpz0PHn1qMNeB6NMa9WRXaNA/FuLRt18L16//Q0TNW
        "]], 
       LineBox[CompressedData["
1:eJwV1nk4VWsXAHDDOWefczijIcmQYzoqu0PjLcMiY7mfUiHikqmkzNVFQpKi
DEnSkSEajJkSpYQSUeqrNKA+RUqhonuT+JY/9rOf3/Pu591rv+9ea70aOwId
fKQkJCQq8Zq7k7f5shGvpME2rcR66BAJwW9+tA4NSEPNNk71I/RGGcnPR/6V
hsQvHnmZaLaXwppWTQoEmDyzE6KP802eQwQFKo12qrlGkxAhbNnFPUKBln61
cXP0LhOb329SKCBnP62wGG3j76B1qIgCM7Wz7tMHSaA1+4Y0dlNA7cXASAE6
LjiFvUaXCj4DPaoS6FODPoH2BlRYPVqWNBpFQuE2o27vtVQIr9xv2Ye+Z/Yx
LcWeChU5sTk30Ez+OoXB/VSI18h7F4lekDB/31QsFdRrrGoD0Eumxp5zkqnw
Rsh76ob+z4A4a00eFbSWFf0EdFrVjwWp96mQfbF1mIku0OmKKnpChb6eBN2Z
SBKqsi/0NfRS4WfuiZqv6KdxG3MHx3G+5on6l+jBHzoSv6aosDcg2/Ah+of/
bw8ulQap6zlTzWilzcWCtfNpMFM0Gl6G1muLObxRkwZVyeJFF9Br1jq999Gn
wWREHnkWvV2TcjHVjAaGV0jtBHTedze9oV00oNydeOSFrvRbfvxXKA2ciUGp
7ejm18wRbjQNGFf1E7ag37fUla5Np0HYpEW0FXpy1UnWJjENTN03fTdF00q9
9/pepMHNuwb1f6CFGTxRWgMN+Oc/rCLRf9CHUy+20kBL6ue4EL0+6tbXGw9p
cHSD4y9NtOt4hsPjFzTofavipI4O8N5dPTRAA53RXZQF6IMvzOSnP9Og39tF
eh76pJ1SOO8fGihNM7fIoc83jT7TkSQgRZT1g4OuWH53pZEMAfct1EZk0U2X
z53ZpECAtlm9ARPdrRLyr686AZIT8R0E+n+pNtui9Aho+yqupaK/UdQb0pYR
wDqt8l0aLf33pPIlYwLKZtQOS6HlvzyIvGlNwGuF2z6SaG3Pgt7HmwgwT5x3
TgK98tkB4w+uBKh0mGvO2drW/vy0DwE2iq4zsxEkODdqz/KCCNi5N2LJ3Pgu
g+m/dCMI+J7dUDbniKInTUbxBDgvXhE3N3/S/CsaDicxnn3SxXPvF584FOeX
RcDVLBNtCrpM0vFdVAEBygdmv8/Ffyt8iUV6KQGRTe6KdHT5ccHF2DoCWoJj
7859f26uEj24mYCohJU9LHRqDdvfo4uAjxniDTx0TDul0/4FAQcHHwsU0EH9
U/qm7wighU5sn4/2/D6eQo4S8OCTxpQq2ly1bzOLQodjD/juc/traPjf2mk2
HV7KcrXn9l/Tun3e5/l02PExyX45mhJc+7pjKR2MewIfmaEnjpQYN6yhw1UX
jrbt3P+fnZ97xZIOn9zE/RvR91pPeCW60uF5zKeDnuhrLw/f3e9LB+3Kt17+
6Eujf+v6BdPhVhxZHopOVPIdsTxKB/dPq4KOog/ob/9zRTod9JfrDKfNrbe5
Q4VWDh0ERx+3iuf+xwCTUOlqjDf8Tmn1XP7ELn/2rZEOZntWXr+NXpy5aNXA
fTr4arcLO9GyTYq/mvrpEOJa9McQ+qHcWFw0kwHlpnUq6pjvt4SD7/coMEDn
cvZmEl1h/NrKbSEDrLbajxujU/3amEYrGXCqPcbVHe1wIzf9pycD+lab/7qA
Nu8+PTEcwIDxobEd19DLBpMcX+xngJDFNWhHy3MOKNedwPmnv0mMo5/v2FgQ
Vs+ABdbmweZY7+7tt6J4tzLgQno82xldl2zku/kRA0Li7/P3orOuCRcZDjKg
4PKZjefQLkzJqjEuEzj5chem0G8qK+/472SCfEb+1U6st+NaP8dzQ5gg6fP0
3RBaKgsWPotiwuC2jGBJrN860Y+iTdOY0JbyTrwKvXf9l7XyDUxYMNmx7DJ6
ZkB4rVFGBupfhfhnx5DAdQwa/KYgAwed69c3oAXtdfLChTKwQk8h4RXaqsIq
NH25DAS+1GWrxGK+R3qL/Nxk4LBcgPcFtJp8XjG3AsfNPcmWOBJERz+8tKyX
gSDl5uZhtPkUyYhskQFz2ZNV7MMk+L5t9BvskYFD38MLXdHlpa+1GiRkwUJ/
4PFPtLHlvFwvB1lgyQRvtT6C9XLfyVPXJmWhIrGL0E0kQata0e76rCzMpwgU
nNCfx85TGhgs0H7lH3EUHbWrIrxRlQXLtjy2+4jO2d7t1GrJAq/Ucm7lMRL6
zfkqT06z4NkFJn9TEgkenMzCLyvY8AtG+p6cxHppp+Y2ZsqG0JY7A6wUXO/E
iwpfbdlQJZ42sUXHSNUlTLixwWsg7ncTOn+yZ+evI2yQ1JNKr0klYeD1fH3G
czY4fu3mlaaT4HU5p1ZrHwc6RYr6vZnYzxIsAyViOfBEdgVFeAb7j9cXYW8S
B4r/6YEwtJS6sfhUPgeOFe/5xMrC/nC6N06qiwMXj+j+tjxLQuAdlnCcxwV3
jVJ++zmsN+V2k107uRBr0B2nnI/xH+tIOabIA271Z+pQKeaHrvXm7AU8+JJ+
e3hdGQlfW1sUSxbyoCl0j3oBukGiMadzEQ/ccimJf5WTYHegooRjyoPIhuZ1
/RV4fvDLaDvtx4NC28UOI1X4vKX7bP51HgSazuqtqyfhT6lvextc+KDs07Lj
/T3sr0Ezhqs9+LDDukbFow37ZT/zn1ofPvxW7TPoRZ+/oXmoMogPV3ZY7Xl2
H9c3bGvK5QQ+nOJGa3V24Pngw/WKzCo+DI1tCOt4SMLLzkPjIUw5sGlRTWP0
kOBzhhWyuEEOWh67KB8bJqF4fIu6o5QCbFDNOHVCdinUxNRO8CwUwfj4SjXx
sqVQuYQ5ysqfB1Pp1W0RnkuhV3w8rWVICT5F3rvz6eRSmBLOOtdbK8PqeS6H
bZqXQt9Isg0ULACfTbY3F/1YCqMhVgMxgypw/u8x8SU5EXxVmMiVtFAD6Zyw
42GkCAQHuwijJHWgNHZXh1uLIJn19oG070KIHc1WevuXCGL8/1vEkNeA/Obq
F+YRIki60rsl4JoGOLWpx75PF8Hw4AZ/s3oNKNxt0uVwSgQWghuHFG9qAIdo
V72Dnsk+W9x0RwPk1sV35mSIICTZUUKhSwMK7O28nDJF4BLYXdL4TgP+5Kck
PzgrAr0VrVIcngCqmN5J1/NEkBC8TOm9nABcovWydPNFMFBWoF+vKICV7I7S
TLRYJ9bZS0UAH9PnjYYViICrZFJepyuA02/tnhoUiuDfqbptHiYCsMzmbCi7
JIKtq3QDV5gJYE+a23uVyyKoCs2MZ1oIwNrx+NFkdMDnsIoaWwHoOtM/774i
grd9BlTGVgHEGroYLC4RgbFyvnK/kwB2q3qqnkNnO3JF1S4C8Ny8XV6mVARb
Ho26uHkIIGHjLc0RdKWMe5ChlwAcJwOMXMtEwLbpOkL4CqAwL9fjAdo/3uhc
704BrG2LSF1bLoK2ppKrlbsFUCan2VmC/j9KF5EJ
        "]]},
      Annotation[#, 
       "Charting`Private`Tag$3071#1"]& ], {}}, {{}, {}}, {{}, {}}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-6.907755278982137, 14.082821596987628`},
  AxesStyle->GrayLevel[0],
  Background->GrayLevel[1],
  BaseStyle->GrayLevel[0],
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Exp[
       Part[#, 1]], 
      Exp[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Exp[
       Part[#, 1]], 
      Exp[
       Part[#, 2]]}& )},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->GrayLevel[0],
  FrameTicks->{{Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
     Charting`ScaledFrameTicks[{Log, Exp}]}, {Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
     Charting`ScaledFrameTicks[{Log, Exp}]}},
  FrameTicksStyle->GrayLevel[0],
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0], 
    AbsoluteThickness[1], 
    AbsoluteDashing[{1, 2}]],
  ImagePadding->All,
  ImageSize->{838.00390625, Automatic},
  LabelStyle->{FontFamily -> "Helvetica", 
    GrayLevel[0]},
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->NCache[{{-6.907755278982137, 
      Log[10000]}, {14.082821596987628`, 
     16.68230892044419}}, {{-6.907755278982137, 9.210340371976184}, {
    14.082821596987628`, 16.68230892044419}}],
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 
       6}]]& }, {{{-6.907755278982137, 
       FormBox["0.001`", TraditionalForm], {0.01, 0.}}, {-2.3025850929940455`, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.100\"", 0.1, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 3}]& ], TraditionalForm], {0.01, 0.}}, {
      2.302585092994046, 
       FormBox["10", TraditionalForm], {0.01, 0.}}, {6.907755278982137, 
       FormBox["1000", TraditionalForm], {0.01, 0.}}, {-4.605170185988091, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      4.605170185988092, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.210340371976184, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.512925464970229`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.608235644774552`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.695247021764184`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}}, {{
      14.508657738524219`, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "2", 
          
          TemplateBox[{"10", "6"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}}, {15.424948470398375`, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "5", 
          
          TemplateBox[{"10", "6"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}}, {16.11809565095832, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "1", 
          TemplateBox[{"10", "7"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}}, {16.811242831518264`, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "2", 
          
          TemplateBox[{"10", "7"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}}, {13.815510557964274`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      14.22097566607244, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      14.914122846632385`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      15.201804919084164`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      15.60727002719233, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      15.761420707019587`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      15.89495209964411, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      16.012735135300492`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      16.523560759066484`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      17.216707939626428`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      17.50439001207821, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      17.72753356339242, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      17.909855120186375`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.064005800013632`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.197537192638155`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.31532022829454, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.420680743952367`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}}}],
  TicksStyle->GrayLevel[0]]], "Output",
 CellChangeTimes->{3.862016561060396*^9, 3.862022834627824*^9, 
  3.862024180879179*^9, 3.8620242392526817`*^9, 3.862024374373705*^9, 
  3.862110297248711*^9, 3.862110343314375*^9, 3.862110717315637*^9, 
  3.862112709690319*^9, 3.8621128887815657`*^9, 3.862114628829155*^9, 
  3.8621154565154543`*^9, 3.862115592514832*^9, 3.8621159599116983`*^9, 
  3.8621163990147133`*^9, 3.862136449741943*^9, 3.8622001109243507`*^9, 
  3.862216052639635*^9, 3.8622167667948923`*^9, 3.862218101244329*^9, 
  3.8622189566511717`*^9, 3.862276910381792*^9, 3.8622853273272867`*^9, 
  3.862290816360045*^9, 3.86229085268187*^9, 3.862541398549402*^9, 
  3.862880820689501*^9, 3.863002604851598*^9, 3.863063077071743*^9, 
  3.8631283657759438`*^9, 3.863135096466135*^9, 3.863135137628304*^9, 
  3.8631372255043983`*^9, 3.863140062974222*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"3a49f4d2-ffab-43bb-8dc8-b8841aa34ef4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scatter opacity", "Section",
 CellChangeTimes->{{3.86211078365486*^9, 
  3.862110787266242*^9}},ExpressionUUID->"e66a0de1-3c1c-49b8-83a7-\
4953f4343738"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aint", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Eci", ",", 
      "Epe", ",", "Epi", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "b",
       ",", "a", ",", "q", ",", "m", ",", "ri", ",", "\[Epsilon]p", ",", 
      "\[Eta]p", ",", "g", ",", "\[Epsilon]", ",", "\[Eta]", ",", "\[Beta]i", 
      ",", "K1i", ",", "K2i", ",", "Kz1i", ",", "Kz2i", ",", "ep1i", ",", 
      "em1i", ",", "ep2i", ",", "em2i", ",", "e01i", ",", "e02i", ",", "Ap1", 
      ",", "Am1", ",", "A01", ",", "Ap2", ",", "Am2", ",", "A02", ",", "Ap", 
      ",", "Am", ",", "A0", ",", "\[Rho]", ",", "x", ",", "T", ",", "Mns", 
      ",", "Rns", ",", "gns", ",", "\[Tau]mid", ",", "\[Gamma]eiL", ",", 
      "\[Gamma]eip", ",", "y1", ",", "y2", ",", "\[Gamma]re", ",", 
      "\[Gamma]ri", ",", "gl", ",", "gp", ",", "\[Epsilon]pg", ",", 
      "\[Epsilon]mg", ",", "\[Delta]v"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "11.9"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.623"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{"-", "0.0425"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", "0.0991"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", "0.0412"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", 
      RowBox[{"-", "0.026"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", "0.0036"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{"-", "0.0851"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", 
      RowBox[{"-", "0.00392"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", "0.0034"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", "0.000418"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"1", "+", 
         RowBox[{
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]], 
          RowBox[{"(", 
           RowBox[{"1.195", "-", 
            RowBox[{
             FractionBox["2", "3"], 
             RowBox[{"Log", "[", "b", "]"}]}], "-", 
            RowBox[{
             FractionBox["1", "b"], 
             RowBox[{"(", 
              RowBox[{"0.8553", "+", 
               RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
            FractionBox["1", 
             RowBox[{"2", 
              SuperscriptBox["b", "2"]}]]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
           RowBox[{
            FractionBox["1", "b"], 
            RowBox[{"(", 
             RowBox[{"0.3070", "+", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           RowBox[{"0.7003", " ", 
            FractionBox["1", 
             SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]]}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["2", "3"], "+", 
           RowBox[{
            FractionBox["1", "b"], 
            RowBox[{"(", 
             RowBox[{"0.1447", "-", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           FractionBox["1", 
            SuperscriptBox["b", "2"]]}], ")"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "low", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", " ", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "-", 
       RowBox[{"2", "*", "\[Delta]v"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "y2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ri", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]i", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]i", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1i", "=", 
      RowBox[{"\[Beta]i", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["ri", 
             SuperscriptBox["\[Beta]i", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2i", "=", 
      RowBox[{"\[Beta]i", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["ri", 
             SuperscriptBox["\[Beta]i", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1i", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}], "K1i"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]i", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]i", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2i", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}], "K2i"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]i", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]i", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1i", "*", 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
          RowBox[{"Kz1i", "*", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2i", "*", 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
          RowBox[{"Kz2i", "*", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1i", "*", 
             RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
            RowBox[{"Kz1i", "*", 
             RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2i", "*", 
             RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
            RowBox[{"Kz2i", "*", 
             RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1i", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}], "-", 
          RowBox[{"Kz1i", "*", 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2i", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}], "-", 
          RowBox[{"Kz2i", "*", 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"ep1i", "+", "ep2i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Am", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"em1i", "+", "em2i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A0", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"e01i", "+", "e02i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap2", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", "ep2i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     RowBox[{"Am2", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", "em2i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A02", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", "e02i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap1", "=", 
      RowBox[{"Ap", "-", "Ap2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Am1", "=", 
      RowBox[{"Am", "-", "Am2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A01", "=", 
      RowBox[{"A0", "-", "A02"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Ap1", ",", "Ap2", ",", "Am1", ",", "Am2", ",", "A01", ",", "A02"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.862112477793551*^9, 3.862112636743717*^9}, {
   3.862112667241892*^9, 3.862112688654994*^9}, 3.862112731447269*^9, {
   3.8621130987238693`*^9, 3.862113105786236*^9}, {3.8621133699680347`*^9, 
   3.862113382297454*^9}, {3.862115479104953*^9, 3.8621154797951117`*^9}, {
   3.862200119724718*^9, 3.862200129813558*^9}, {3.8622031711794167`*^9, 
   3.862203171521489*^9}, 3.862215349862418*^9, {3.862215400577221*^9, 
   3.8622154438097467`*^9}, {3.862215494701984*^9, 3.8622155171940613`*^9}, {
   3.86221556634977*^9, 3.862215684434338*^9}, {3.862216211947282*^9, 
   3.862216291258833*^9}, {3.863063089033567*^9, 3.863063101055191*^9}, {
   3.863129851781396*^9, 3.8631299141935177`*^9}, 3.8631351428912573`*^9, {
   3.863136958805778*^9, 3.86313698855448*^9}, {3.863140230063138*^9, 
   3.8631402332844963`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"0c32b016-d668-47dd-b836-94deef2c4550"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scatteropacity", "[", 
   RowBox[{
   "Es_", ",", "B_", ",", "\[Tau]_", ",", "\[Theta]b_", ",", "Ap1_", ",", 
    "Ap2_", ",", "Am1_", ",", "Am2_", ",", "A01_", ",", "A02_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Eci", ",", 
      "Epe", ",", "Epi", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "b",
       ",", "a", ",", "q", ",", "m", ",", "r", ",", "\[Epsilon]p", ",", 
      "\[Eta]p", ",", "g", ",", "\[Epsilon]", ",", "\[Eta]", ",", "\[Beta]", 
      ",", "K1", ",", "K2", ",", "Kz1", ",", "Kz2", ",", "ep1", ",", "em1", 
      ",", "ep2", ",", "em2", ",", "e01", ",", "e02", ",", "gl", ",", "gp", 
      ",", "\[Omega]ci", ",", "\[Tau]mid", ",", "x", ",", "T", ",", "\[Rho]", 
      ",", "Mns", ",", "Rns", ",", "gns", ",", "\[Gamma]eiL", ",", 
      "\[Gamma]eip", ",", "y1", ",", "y2", ",", "\[Gamma]re", ",", 
      "\[Gamma]ri", ",", "\[Epsilon]pg", ",", "\[Epsilon]mg", ",", 
      "\[Gamma]ep", ",", "\[Gamma]em", ",", "\[Gamma]e0", ",", "\[Gamma]ip", 
      ",", "\[Gamma]im", ",", "\[Gamma]i0", ",", "\[Kappa]s1e1", ",", 
      "\[Kappa]s1i1", ",", "\[Kappa]s2e1", ",", "\[Kappa]s2i1", ",", 
      "\[Kappa]s11", ",", "\[Kappa]s12", ",", "\[Kappa]s1e2", ",", 
      "\[Kappa]s1i2", ",", "\[Kappa]s2e2", ",", "\[Kappa]s2i2", ",", 
      "\[Kappa]s21", ",", "\[Kappa]s22", ",", "\[Delta]v"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "11.9"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.623"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{"-", "0.0425"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", "0.0991"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", "0.0412"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", 
      RowBox[{"-", "0.026"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", "0.0036"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{"-", "0.0851"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", 
      RowBox[{"-", "0.00392"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", "0.0034"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", "0.000418"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]ci", "=", " ", 
      FractionBox[
       RowBox[{"Z", " ", "e", " ", "B"}], 
       RowBox[{"A", " ", "mp", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"1", "+", 
         RowBox[{
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]], 
          RowBox[{"(", 
           RowBox[{"1.195", "-", 
            RowBox[{
             FractionBox["2", "3"], 
             RowBox[{"Log", "[", "b", "]"}]}], "-", 
            RowBox[{
             FractionBox["1", "b"], 
             RowBox[{"(", 
              RowBox[{"0.8553", "+", 
               RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
            FractionBox["1", 
             RowBox[{"2", 
              SuperscriptBox["b", "2"]}]]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
           RowBox[{
            FractionBox["1", "b"], 
            RowBox[{"(", 
             RowBox[{"0.3070", "+", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           RowBox[{"0.7003", " ", 
            FractionBox["1", 
             SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]]}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["2", "3"], "+", 
           RowBox[{
            FractionBox["1", "b"], 
            RowBox[{"(", 
             RowBox[{"0.1447", "-", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           FractionBox["1", 
            SuperscriptBox["b", "2"]]}], ")"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "low", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", " ", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "-", 
       RowBox[{"2", "*", "\[Delta]v"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "y2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K1", "2"], "+", 
        SuperscriptBox["Kz1", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K2", "2"], "+", 
        SuperscriptBox["Kz2", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ep", "=", 
      RowBox[{"\[Gamma]eiL", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]em", "=", 
      RowBox[{"\[Gamma]eiL", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]e0", "=", 
      RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ip", "=", 
      RowBox[{
       RowBox[{
        FractionBox["me", "mp"], "\[Gamma]eiL"}], "+", "\[Gamma]ri"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]im", "=", 
      RowBox[{
       RowBox[{
        FractionBox["me", "mp"], "\[Gamma]eiL"}], "+", "\[Gamma]ri"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]i0", "=", 
      RowBox[{
       RowBox[{
        FractionBox["me", "mp"], "\[Gamma]eip"}], "+", "\[Gamma]ri"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1e1", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1i1", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s11", "=", 
      RowBox[{"\[Kappa]s1e1", "+", "\[Kappa]s1i1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1e2", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1i2", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s12", "=", 
      RowBox[{"\[Kappa]s1e2", "+", "\[Kappa]s1i2"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2e1", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2i1", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s21", "=", 
      RowBox[{"\[Kappa]s2e1", "+", "\[Kappa]s2i1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2e2", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2i2", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s22", "=", 
      RowBox[{"\[Kappa]s2e2", "+", "\[Kappa]s2i2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\[Kappa]s11", ",", "\[Kappa]s12", ",", "\[Kappa]s21", ",", 
       "\[Kappa]s22"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8619662542964487`*^9, 3.861966255752267*^9}, {
   3.861966286990212*^9, 3.861966310815189*^9}, {3.861966366553494*^9, 
   3.8619664126295967`*^9}, {3.861966460014474*^9, 3.861966483428029*^9}, {
   3.86196654554508*^9, 3.8619666605210953`*^9}, {3.861966709209655*^9, 
   3.86196678522508*^9}, {3.861966857722144*^9, 3.861966977802162*^9}, {
   3.8619670078662767`*^9, 3.8619670086754303`*^9}, {3.861967823028294*^9, 
   3.861967865685066*^9}, {3.861967957327875*^9, 3.861967968782711*^9}, {
   3.861968034251009*^9, 3.8619680398823147`*^9}, {3.861968080697742*^9, 
   3.861968292401668*^9}, {3.861968369720783*^9, 3.8619684150963163`*^9}, {
   3.8619687055175047`*^9, 3.8619687111944933`*^9}, {3.861968936893284*^9, 
   3.861968958711403*^9}, {3.861969646033495*^9, 3.861969668735609*^9}, {
   3.8620571419812107`*^9, 3.8620571591419067`*^9}, {3.8620572319040737`*^9, 
   3.862057237408332*^9}, {3.862057475001934*^9, 3.862057483808165*^9}, {
   3.8620575360617447`*^9, 3.862057543897107*^9}, {3.862110942743116*^9, 
   3.86211098309041*^9}, 3.862111016017262*^9, {3.8621110568299513`*^9, 
   3.862111121471571*^9}, {3.862111353442923*^9, 3.8621113538948927`*^9}, {
   3.862112308960351*^9, 3.862112323281927*^9}, {3.862112384822692*^9, 
   3.8621123879649*^9}, {3.862200170712943*^9, 3.862200180229312*^9}, {
   3.862203182069058*^9, 3.862203182648527*^9}, 3.8622163742307997`*^9, {
   3.862216414326277*^9, 3.862216449143799*^9}, {3.8622164956373568`*^9, 
   3.862216582432743*^9}, 3.862216825168517*^9, 3.862216860282577*^9, {
   3.862541415688201*^9, 3.862541439282734*^9}, {3.8630631157456303`*^9, 
   3.8630631231784563`*^9}, 3.863135178089592*^9, {3.863137033512491*^9, 
   3.863137041567505*^9}, {3.863140209779917*^9, 3.8631402102899714`*^9}, {
   3.863140358251576*^9, 3.863140361025423*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b31cc2f8-e8a2-4e8c-92c4-e986fc8dfa24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["free free opacity", "Section",
 CellChangeTimes->{{3.862111302735526*^9, 
  3.8621113078983707`*^9}},ExpressionUUID->"750a1e48-a2d7-415c-91e7-\
b6eab27e8bb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freeopacity", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Epsilon]p", ",", "\[Eta]p", ",", "\[Epsilon]", ",", "\[Eta]", ",", 
      "g", ",", "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", 
      "Epi", ",", "Eci", ",", "Epe", ",", "ue", ",", "ui", ",", "ve", ",", 
      "vi", ",", "\[Gamma]re", ",", "\[Gamma]ri", ",", "r1", ",", "r2", ",", 
      "\[Gamma]eiL", ",", "\[Gamma]eip", ",", "\[Epsilon]pg", ",", 
      "\[Epsilon]mg", ",", "b", ",", "a", ",", "q", ",", "m", ",", "r", ",", 
      "\[Beta]", ",", "K1", ",", "K2", ",", "Kz1", ",", "Kz2", ",", "ep1", 
      ",", "ep2", ",", "em1", ",", "em2", ",", "e01", ",", "e02", ",", 
      "\[Gamma]p", ",", "\[Gamma]m", ",", "\[CapitalLambda]p", ",", 
      "\[CapitalLambda]m", ",", "\[Kappa]p", ",", "\[Kappa]m", ",", 
      "\[Kappa]o", ",", "\[Kappa]ff1", ",", "\[Kappa]ff2", ",", "\[Tau]mid", 
      ",", "x", ",", "Mns", ",", "Rns", ",", "gns", ",", "gp", ",", "gl", ",",
       "\[Rho]", ",", "T", ",", "\[Delta]v"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "11.9"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.623"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{"-", "0.0425"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", "0.0991"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", "0.0412"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", 
      RowBox[{"-", "0.026"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", "0.0036"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{"-", "0.0851"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", 
      RowBox[{"-", "0.00392"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", "0.0034"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", "0.000418"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"1", "+", 
         RowBox[{
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]], 
          RowBox[{"(", 
           RowBox[{"1.195", "-", 
            RowBox[{
             FractionBox["2", "3"], 
             RowBox[{"Log", "[", "b", "]"}]}], "-", 
            RowBox[{
             FractionBox["1", "b"], 
             RowBox[{"(", 
              RowBox[{"0.8553", "+", 
               RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
            FractionBox["1", 
             RowBox[{"2", 
              SuperscriptBox["b", "2"]}]]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
           RowBox[{
            FractionBox["1", "b"], 
            RowBox[{"(", 
             RowBox[{"0.3070", "+", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           RowBox[{"0.7003", " ", 
            FractionBox["1", 
             SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]]}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["2", "3"], "+", 
           RowBox[{
            FractionBox["1", "b"], 
            RowBox[{"(", 
             RowBox[{"0.1447", "-", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           FractionBox["1", 
            SuperscriptBox["b", "2"]]}], ")"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", " ", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "-", 
       RowBox[{"2", "*", "\[Delta]v"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "r1"}], "*", "r2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"r2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "r1"}], "*", "r2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "r2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"r2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]p", "=", 
      RowBox[{"\[Gamma]eiL", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["ue", "0.5"]}], ")"}], "\[Gamma]ri"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["ui", "0.5"]}], ")"}], "\[Gamma]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]m", "=", 
      RowBox[{"\[Gamma]eiL", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["ue", "0.5"]}], ")"}], "\[Gamma]ri"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["ui", "0.5"]}], ")"}], "\[Gamma]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]p", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["ue", "0.5"]}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["ui", "0.5"]}], ")"}], "2"]}], "+", 
         SuperscriptBox["\[Gamma]p", "2"]}], ")"}], 
       RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]m", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["ue", "0.5"]}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["ui", "0.5"]}], ")"}], "2"]}], "+", 
         SuperscriptBox["\[Gamma]m", "2"]}], ")"}], 
       RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]p", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", " ", "\[CapitalLambda]p", " ",
        "\[Gamma]eiL"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]m", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", " ", "\[CapitalLambda]m", " ",
        "\[Gamma]eiL"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]o", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", "*", "\[Gamma]eip"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]ff1", "=", 
      RowBox[{
       RowBox[{"\[Kappa]p", "*", "ep1"}], " ", "+", " ", 
       RowBox[{"\[Kappa]m", "*", "em1"}], " ", "+", " ", 
       RowBox[{"\[Kappa]o", "*", "e01"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]ff2", "=", 
      RowBox[{
       RowBox[{"\[Kappa]p", "*", "ep2"}], " ", "+", " ", 
       RowBox[{"\[Kappa]m", "*", "em2"}], "+", " ", 
       RowBox[{"\[Kappa]o", "*", "e02"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]ff1", ",", "\[Kappa]ff2"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.862111315259729*^9, 3.862111341481821*^9}, {
   3.862111375592436*^9, 3.862111389641347*^9}, {3.862112257094551*^9, 
   3.862112282827321*^9}, 3.862116480450753*^9, {3.8622172708110237`*^9, 
   3.862217310231078*^9}, {3.862217358058984*^9, 3.862217388842092*^9}, 
   3.863135186511341*^9, {3.863137134862502*^9, 3.863137137873015*^9}, {
   3.863139876808804*^9, 3.863139877267421*^9}, 3.863139966160268*^9, {
   3.863140411549437*^9, 3.8631404143365307`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"441ad3d1-55e4-45f4-b2c4-36afd192e5bf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["jump condition", "Section",
 CellChangeTimes->{{3.8621116025960693`*^9, 
  3.862111605381013*^9}},ExpressionUUID->"6670b494-a3c8-4fb5-a991-\
dce31b98d1ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]reson", "[", 
    RowBox[{"Es_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q", ",", "m", ",", "\[Omega]c", ",", "Ebi", ",", "Mns", ",", "Rns", 
       ",", "Ead", ",", "b", ",", "\[Delta]v", ",", "fB", ",", "gns", ",", 
       "\[Rho]v", ",", "\[Tau]v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"q", "=", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["\[Alpha]F", 
            RowBox[{"2", "\[Pi]"}]]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
            RowBox[{
             FractionBox["1", "b"], 
             RowBox[{"(", 
              RowBox[{"0.3070", "+", 
               RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
            RowBox[{"0.7003", " ", 
             FractionBox["1", 
              SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["\[Alpha]F", 
            RowBox[{"2", "\[Pi]"}]]}], 
          RowBox[{"(", 
           RowBox[{
            FractionBox["2", "3"], "+", 
            RowBox[{
             FractionBox["1", "b"], 
             RowBox[{"(", 
              RowBox[{"0.1447", "-", 
               RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
            FractionBox["1", 
             SuperscriptBox["b", "2"]]}], ")"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]v", "=", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"45", "*", "\[Pi]"}]], 
        SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fB", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"3", "*", "\[Delta]v"}], 
          RowBox[{"q", "+", "m"}]], ")"}], "0.5"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mns", "=", 
       RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rns", "=", 
       SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gns", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"G", "*", "Mns"}], 
         SuperscriptBox["Rns", "2"]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", "G", " ", "Mns"}], 
            RowBox[{"Rns", " ", 
             SuperscriptBox["c", "2"]}]]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]v", "=", 
       RowBox[{"0.96", "*", " ", 
        SuperscriptBox["Ye", 
         RowBox[{"-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Es", "/", "1"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"B", "/", 
           SuperscriptBox["10", "14"]}], ")"}], "2"], 
        SuperscriptBox["fB", 
         RowBox[{"-", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]v", "=", 
       RowBox[{"\[Tau]x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"temperature", "[", "\[Tau]x", "]"}], "-", 
            RowBox[{"\[Tau]x", "*", 
             FractionBox[
              RowBox[{"mp", " ", "gns"}], 
              RowBox[{"\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb"}]]}]}],
            "\[Equal]", "0"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]x", ",", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"mp", " ", "gns"}], 
               RowBox[{
               "\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb", "*", "5", 
                "*", 
                SuperscriptBox["10", "6"]}]], ")"}], 
             RowBox[{"-", "1"}]]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[Tau]v"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pjump", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Tau]v", ",", "Tv", ",", "H\[Rho]", ",", "jump", ",", "b", ",", "q", 
      ",", "m", ",", "\[Delta]v", ",", "fB", ",", "Mns", ",", "Rns", ",", 
      "gns", ",", "\[Omega]c", ",", "Ebi", ",", "\[Rho]v", ",", "Ead"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"q", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
           RowBox[{
            FractionBox["1", "b"], 
            RowBox[{"(", 
             RowBox[{"0.3070", "+", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           RowBox[{"0.7003", " ", 
            FractionBox["1", 
             SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["\[Alpha]F", 
           RowBox[{"2", "\[Pi]"}]]}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["2", "3"], "+", 
           RowBox[{
            FractionBox["1", "b"], 
            RowBox[{"(", 
             RowBox[{"0.1447", "-", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           FractionBox["1", 
            SuperscriptBox["b", "2"]]}], ")"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", "*", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fB", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"3", "*", "\[Delta]v"}], 
         RowBox[{"q", "+", "m"}]], ")"}], "0.5"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ebi", "=", 
      RowBox[{"hbar", "*", "\[Omega]c", "*", 
       RowBox[{
        FractionBox["me", "mp"], "/", "kev2erg"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", 
      RowBox[{"0.96", "*", " ", 
       SuperscriptBox["Ye", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Es", "/", "1"}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"B", "/", 
          SuperscriptBox["10", "14"]}], ")"}], "2"], 
       SuperscriptBox["fB", 
        RowBox[{"-", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]v", "=", 
      RowBox[{"\[Tau]x", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"temperature", "[", "\[Tau]x", "]"}], "-", 
           RowBox[{"\[Tau]x", "*", 
            FractionBox[
             RowBox[{"mp", " ", "gns"}], 
             RowBox[{"\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb"}]]}]}], 
          "\[Equal]", "0"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"\[Tau]x", ",", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"mp", " ", "gns"}], 
              RowBox[{
              "\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb", "*", "5", "*", 
               SuperscriptBox["10", "6"]}]], ")"}], 
            RowBox[{"-", "1"}]]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tv", "=", 
      RowBox[{"temperature", "[", "\[Tau]v", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"H\[Rho]", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"2", "*", "kb", "*", 
        RowBox[{"Tv", "/", 
         RowBox[{"(", 
          RowBox[{"mp", " ", "*", " ", "gns", " ", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ead", "=", 
      RowBox[{"2.52", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"fB", "*", 
            RowBox[{"Tan", "[", "\[Theta]b", "]"}]}], ")"}], "2"], ")"}], 
        RowBox[{"1", "/", "3"}]], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Abs", "[", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["Ebi", "Es"], ")"}], "2"]}], "]"}], ")"}], 
        RowBox[{"2", "/", "3"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", "H\[Rho]"], ")"}], 
        RowBox[{"1", "/", "3"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jump", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "\[Pi]"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["Es", "Ead"], ")"}], "3"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"N", "[", "jump", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.862112202826563*^9, 3.862112203943747*^9}, {
  3.8631371508973303`*^9, 3.863137178188325*^9}, {3.8631373074535093`*^9, 
  3.863137308846757*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"22914adb-9b21-4244-8aa6-4c18220b252f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generating the grid", "Section",
 CellChangeTimes->{{3.862113769441164*^9, 
  3.862113774126528*^9}},ExpressionUUID->"915f5a80-a629-4723-82a6-\
1bdb230f2708"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Es", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"4", "*", 
    SuperscriptBox["10", "13"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]v", "=", 
   RowBox[{"\[Tau]reson", "[", 
    RowBox[{"Es", ",", "B"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]x1", "=", 
   RowBox[{"logspace", "[", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", "\[Tau]v"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]v"}], "]"}], "]"}], "+", "3"}], ")"}], 
      "*", "20"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]x2", "=", 
   RowBox[{"logspace", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", "\[Tau]v"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"10", ",", "2"}], "]"}], "+", "4"}], ",", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "2"}], "]"}], "+", "4", "-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]v"}], "]"}]}], ")"}], "]"}], "*", 
      "20"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"\[Tau]x1", ",", "\[Tau]x2"}], "}"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"position", "=", 
   RowBox[{
    RowBox[{"IntegerPart", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "2"}], "]"}], "+", "4", "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]v"}], "]"}]}], ")"}], "]"}], "*", "20"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]x", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"Range", "[", 
       RowBox[{"0.001", ",", "89.9", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"89.9", "-", "0.001"}], ")"}], "/", "30"}]}], "]"}], "]"}], 
     "/", "180"}], "*", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1u", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I2u", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1d", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I2d", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1u", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox["1", "2"], ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "*", 
     RowBox[{"Planck", "[", 
      RowBox[{"Es", ",", 
       RowBox[{"temperature", "[", 
        RowBox[{"First", "[", "\[Tau]", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I2u", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox["1", "2"], ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "*", 
     RowBox[{"Planck", "[", 
      RowBox[{"Es", ",", 
       RowBox[{"temperature", "[", 
        RowBox[{"First", "[", "\[Tau]", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1d", "[", 
    RowBox[{"[", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", "1", ",", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I2d", "[", 
     RowBox[{"[", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "]"}], "]"}], "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "give", " ", "the", " ", "initial", " ", "data", " ", "for", " ", "source",
     " ", "function"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Tau]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Tau]1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "1"}], ",", 
   RowBox[{"j", "\[LessEqual]", 
    RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"S1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", "2"], "*", 
         RowBox[{"Planck", "[", 
          RowBox[{"Es", ",", 
           RowBox[{"temperature", "[", 
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"S2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", "2"], "*", 
         RowBox[{"Planck", "[", 
          RowBox[{"Es", ",", 
           RowBox[{"temperature", "[", 
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}]}]}], "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzjtIQnEYxuFDSRANEg1mFzLCpahAyqUydUnoMhhkYRIlRhaURImE1FBI
thRZ4SDdkAw6SUiUOpRLaiEi5KJpBamBnC6D1ST2/77h5YF3+tVPzMk1RRRF
1ZKBilK+T+NnJMuXFvRGJg+AC56tB/y/1GFw9O0gBjri/DSY0UtRvqglC7rk
YjS3Mjs2SVz3P42DNn1nCtxndOhHz5p2iiikk9Ogz1l9DUZSeg+YibCKtcTj
FS56tejumiF+XnBEoK0h+qgjNuaTqPPFGAd39poSYPn30s8msRB3/4G/durc
Cv2JEnSgatviIcpKnChj6q3zEit5CtRSQz8LA4xkUPWM9iW7hQlizKRGo0aH
lxNkJMGsD30dcve3EwWtt6iOZ38CXSEaTdlD5mHiQbNhA2zjHeZB1vwJmhPt
GkaIGu4Ruip9D4LsU+oevEt72EpiuOBHxaoyJSgTVKAGs/UM5HTQ6D+0/ggW

  "],
 CellLabel->
  "In[136]:=",ExpressionUUID->"dac479d8-99b9-4857-842f-02ffce54d0db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ff1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc11", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc12", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc21", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc22", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]t2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ap1", ",", "Ap2", ",", "Am1", ",", "Am2", ",", "A01", ",", "A02"}], 
      "}"}], "=", 
     RowBox[{"Aint", "[", 
      RowBox[{"Es", ",", "B", ",", 
       RowBox[{"\[Tau]", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"free", "=", 
        RowBox[{"freeopacity", "[", 
         RowBox[{"Es", ",", "B", ",", 
          RowBox[{"\[Tau]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]x", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ff1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"free", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"ff2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"free", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"scatter", "=", 
        RowBox[{"scatteropacity", "[", 
         RowBox[{"Es", ",", "B", ",", 
          RowBox[{"\[Tau]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]x", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "Ap1", ",", "Ap2", ",", "Am1",
           ",", "Am2", ",", "A01", ",", "A02"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc11", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc12", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc21", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc22", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Kappa]t1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"ff1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc11", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc12", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Kappa]t2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"ff2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc21", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc22", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.862115138038172*^9, 3.862115160476248*^9}, {
   3.8621152907759857`*^9, 3.862115296377151*^9}, {3.862115328660122*^9, 
   3.862115373677397*^9}, 3.8621163682830467`*^9, {3.8621166575966043`*^9, 
   3.862116675456362*^9}, {3.862118702061414*^9, 3.862118725051208*^9}, {
   3.862218884000979*^9, 3.86221890574004*^9}, {3.862285473422971*^9, 
   3.862285495742639*^9}, {3.862291275915362*^9, 3.862291280050645*^9}, {
   3.862541552800584*^9, 3.8625415541249723`*^9}, {3.862880758351844*^9, 
   3.862880792858878*^9}, {3.863002465789258*^9, 3.8630024884524717`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"c8e58968-f91f-4ee3-a0b6-5085db58a74e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", 
    RowBox[{"k", "\[LessEqual]", "10"}], ",", 
    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"m", "=", "1"}], ",", 
       RowBox[{"m", "\[LessEqual]", 
        RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
       RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"u1", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "=", 
         RowBox[{"2", "*", 
          FractionBox["\[Pi]", "c"], "*", 
          RowBox[{"(", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{"Transpose", "@", 
                 RowBox[{"{", 
                  RowBox[{"\[Theta]x", ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]x", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I1u", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", 
                    RowBox[{"I1d", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              "t", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"Min", "[", "\[Theta]x", "]"}], ",", 
               RowBox[{"Max", "[", "\[Theta]x", "]"}]}], "}"}]}], "]"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u2", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "=", 
         RowBox[{"2", "*", 
          FractionBox["\[Pi]", "c"], "*", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Transpose", "@", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]x", ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Theta]x", "]"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I2u", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", 
                    RowBox[{"I2d", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Min", "[", "\[Theta]x", "]"}], ",", 
              RowBox[{"Max", "[", "\[Theta]x", "]"}]}], "}"}]}], 
           "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"S1", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"ff1", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t1", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"Planck", "[", 
              RowBox[{"Es", ",", 
               RowBox[{"temperature", "[", 
                RowBox[{"\[Tau]", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "2"]}], "+", 
           
           RowBox[{
            FractionBox[
             RowBox[{"sc11", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t1", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"u1", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"sc12", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t1", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"u2", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"S2", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"ff2", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t2", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"Planck", "[", 
              RowBox[{"Es", ",", 
               RowBox[{"temperature", "[", 
                RowBox[{"\[Tau]", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "2"]}], "+", 
           
           RowBox[{
            FractionBox[
             RowBox[{"sc21", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t2", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"u1", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"sc22", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t2", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"u2", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}]}]}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Theta]", "=", 
         RowBox[{"\[Theta]x", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Mu]", "=", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
         "upward", " ", "integration", " ", "and", " ", "downward", " ", 
          "integration"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"S1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"ff1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{" ", 
                RowBox[{"\[Kappa]t1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}]], "*", 
              FractionBox[
               RowBox[{"Planck", "[", 
                RowBox[{"Es", ",", 
                 RowBox[{"temperature", "[", 
                  RowBox[{"\[Tau]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "2"]}], 
             "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc11", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc12", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S2", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"ff2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{" ", 
                RowBox[{"\[Kappa]t2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}]], "*", 
              FractionBox[
               RowBox[{"Planck", "[", 
                RowBox[{"Es", ",", 
                 RowBox[{"temperature", "[", 
                  RowBox[{"\[Tau]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "2"]}], 
             "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc21", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc22", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[Delta]\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"\[Tau]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"\[Tau]", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"I1u", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Delta]\[Tau]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Kappa]t1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Delta]\[Tau]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                    RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], 
                   RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
                RowBox[{"I1u", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "-", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Delta]\[Tau]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                  
                  RowBox[{
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"I2u", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Delta]\[Tau]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Kappa]t2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Delta]\[Tau]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                    RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], 
                   RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
                RowBox[{"I2u", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "-", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Delta]\[Tau]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                  
                  RowBox[{
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ax", "=", 
            RowBox[{"I1u", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bx", "=", 
            RowBox[{"I2u", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"i1", "=", 
            RowBox[{
             RowBox[{"Length", "[", "\[Tau]", "]"}], "+", "1", "-", "i"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S1", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"ff1", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{" ", 
                RowBox[{"\[Kappa]t1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]], "*", 
              FractionBox[
               RowBox[{"Planck", "[", 
                RowBox[{"Es", ",", 
                 RowBox[{"temperature", "[", 
                  RowBox[{"\[Tau]", "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "]"}]}], "]"}], "2"]}], 
             "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc11", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t1", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc12", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t1", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u2", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S2", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"ff2", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{" ", 
                RowBox[{"\[Kappa]t2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]], "*", 
              FractionBox[
               RowBox[{"Planck", "[", 
                RowBox[{"Es", ",", 
                 RowBox[{"temperature", "[", 
                  RowBox[{"\[Tau]", "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "]"}]}], "]"}], "2"]}], 
             "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc21", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t2", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc22", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t2", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u2", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[Delta]\[Tau]1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"\[Tau]", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "-", 
             RowBox[{"\[Tau]", "[", 
              RowBox[{"[", 
               RowBox[{"i1", "+", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"I1d", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Delta]\[Tau]1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Kappa]t1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Delta]\[Tau]1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                    RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], 
                   RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
                RowBox[{"I1d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
               
               RowBox[{
                FractionBox[
                 RowBox[{"\[Delta]\[Tau]1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], 
                 RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"I2d", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Delta]\[Tau]1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Kappa]t2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Delta]\[Tau]1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                    RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], 
                   RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
                RowBox[{"I2d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
               
               RowBox[{
                FractionBox[
                 RowBox[{"\[Delta]\[Tau]1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], 
                 RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ay", "=", 
            RowBox[{"I1d", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"by", "=", 
            RowBox[{"I2d", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "position"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"I1u", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Pjump", "[", 
                  RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                 "ax"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Pjump", "[", 
                    RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}],
                  "*", "bx"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"I2u", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Pjump", "[", 
                  RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                 "bx"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Pjump", "[", 
                    RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}],
                  "*", "ax"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"I1d", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Pjump", "[", 
                  RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                 "ay"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Pjump", "[", 
                    RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}],
                  "*", "by"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"I2d", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Pjump", "[", 
                  RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                 "by"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Pjump", "[", 
                    RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}],
                  "*", "ay"}]}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"I1u", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "ax"}], ";", 
              RowBox[{
               RowBox[{"I2u", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "bx"}], ";", 
              RowBox[{
               RowBox[{"I1d", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", "ay"}], ";", 
              RowBox[{
               RowBox[{"I2d", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", "by"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.86211717606938*^9, 3.86211717704187*^9}, {
   3.862118778887952*^9, 3.862118786404895*^9}, {3.862200674204689*^9, 
   3.862200723064382*^9}, {3.862201073869687*^9, 3.8622010832143507`*^9}, {
   3.862201211385579*^9, 3.862201219996892*^9}, 3.862202022613443*^9, {
   3.862202107025631*^9, 3.8622021073236113`*^9}, {3.8622855111535482`*^9, 
   3.862285628133222*^9}, 3.862541676877089*^9, {3.863135410758963*^9, 
   3.8631354168070374`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"741dba48-168c-4222-a15d-8017a21e0164"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"1.1641081357853787`*^11\\\"}], \\\"]\\\"}]\\) is too small to represent \
as a normalized machine number; precision may be lost.\"", 2, 168, 9, 
   24471289972189078632, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863002927155205*^9, 3.863063391777017*^9, 
  3.8630645198686857`*^9, 3.8631359010486298`*^9, 3.863136707373901*^9, 
  3.86313761406028*^9, 3.863138356441958*^9, 3.863138423320512*^9, 
  3.8631409406213303`*^9, 3.863141580199491*^9, 3.863142066047474*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[168]:=",ExpressionUUID->"afbea5af-352d-4b3a-\
b403-3945e321c816"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"1.1641081357853787`*^11\\\"}], \\\"]\\\"}]\\) is too small to represent \
as a normalized machine number; precision may be lost.\"", 2, 168, 10, 
   24471289972189078632, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863002927155205*^9, 3.863063391777017*^9, 
  3.8630645198686857`*^9, 3.8631359010486298`*^9, 3.863136707373901*^9, 
  3.86313761406028*^9, 3.863138356441958*^9, 3.863138423320512*^9, 
  3.8631409406213303`*^9, 3.863141580199491*^9, 3.8631420660830193`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[168]:=",ExpressionUUID->"0e5b1cd8-d82b-49d2-\
a9f9-6105c754066e"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"1.1641081357853787`*^11\\\"}], \\\"]\\\"}]\\) is too small to represent \
as a normalized machine number; precision may be lost.\"", 2, 168, 11, 
   24471289972189078632, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863002927155205*^9, 3.863063391777017*^9, 
  3.8630645198686857`*^9, 3.8631359010486298`*^9, 3.863136707373901*^9, 
  3.86313761406028*^9, 3.863138356441958*^9, 3.863138423320512*^9, 
  3.8631409406213303`*^9, 3.863141580199491*^9, 3.863142066116222*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[168]:=",ExpressionUUID->"1c6109c0-8e55-46f0-\
b03f-13ba13d4ff36"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 168, 12, 24471289972189078632, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.863002927155205*^9, 3.863063391777017*^9, 
  3.8630645198686857`*^9, 3.8631359010486298`*^9, 3.863136707373901*^9, 
  3.86313761406028*^9, 3.863138356441958*^9, 3.863138423320512*^9, 
  3.8631409406213303`*^9, 3.863141580199491*^9, 3.8631420661244173`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[168]:=",ExpressionUUID->"2c678d41-d50b-4f27-\
8cd6-312df87d7c59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I2u", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.863003532636674*^9, 3.8630035399710073`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"3fa2a536-2eaa-4213-b6b0-8b645275d6c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10476.470521271815`", ",", "607.9774459488226`", ",", "186.7187030178974`",
    ",", "192.78528670182064`", ",", "280.1238860459912`", ",", 
   "408.8219998557231`", ",", "552.1428854318148`", ",", "683.2727442913558`",
    ",", "780.4368969765248`", ",", "831.4317664532942`", ",", 
   "834.8005042112256`", ",", "797.9809786607188`", ",", "733.6953664465573`",
    ",", "656.0111121948487`", ",", "577.1816250404544`", ",", 
   "505.8226424451355`", ",", "446.4515436298105`", ",", "400.0601860311421`",
    ",", "365.24316664023445`", ",", "339.42697377097807`", ",", 
   "319.87427238092124`", ",", "304.30367606418673`", ",", 
   "291.1172993020236`", ",", "279.335859370084`", ",", "268.39097369785316`",
    ",", "257.9137436749294`", ",", "247.59498603530244`", ",", 
   "237.10636160737138`", ",", "226.01457274084623`", ",", 
   "213.56191919737958`", ",", "196.64403335393342`"}], "}"}]], "Output",
 CellChangeTimes->{3.863003540489505*^9, 3.86306349072572*^9, 
  3.863135963441474*^9, 3.863136776015089*^9, 3.863137666689595*^9, 
  3.8631384857345333`*^9, 3.863140997560614*^9, 3.8631416543530693`*^9, 
  3.863142116916203*^9},
 CellLabel->
  "Out[169]=",ExpressionUUID->"9e05f274-5475-433e-bfc5-b50d7fb28db5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I1u", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.86300354579881*^9, 3.863003549748732*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"d8f40d35-c050-497f-8526-4d57b2654357"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "8817.573351205629`", ",", "436.5776058832933`", ",", "67.56642202624991`", 
   ",", "48.078947298447986`", ",", "55.691177510963506`", ",", 
   "68.35779294078216`", ",", "82.8505665972318`", ",", "98.56005855511106`", 
   ",", "115.45012326085268`", ",", "133.56584094207042`", ",", 
   "152.90277452764843`", ",", "173.41188666253743`", ",", 
   "195.03114818504096`", ",", "217.70637199498304`", ",", 
   "241.39981533830456`", ",", "266.0921554093604`", ",", 
   "291.78169985806727`", ",", "318.4824399774432`", ",", 
   "346.22124596275984`", ",", "375.03364113573025`", ",", 
   "404.9570182377377`", ",", "436.0195618168887`", ",", "468.2226900348821`",
    ",", "501.5166849226554`", ",", "535.7732344017444`", ",", 
   "570.7344841876824`", ",", "605.649368160238`", ",", "636.4206340797746`", 
   ",", "635.9193678910901`", ",", "446.8722296026733`", ",", 
   "475.5842011269389`"}], "}"}]], "Output",
 CellChangeTimes->{3.863003550162427*^9, 3.863063493398975*^9, 
  3.863135967089161*^9, 3.863136778957653*^9, 3.86313766670475*^9, 
  3.8631384884573927`*^9, 3.863141001548952*^9, 3.8631416571407843`*^9, 
  3.863142116966346*^9},
 CellLabel->
  "Out[170]=",ExpressionUUID->"19c7acae-f4cd-4bfd-8c75-dde888373998"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"\[Theta]x", ",", 
      RowBox[{
       RowBox[{"I1u", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "+", 
       RowBox[{"I2u", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLogPlot", "[", 
  RowBox[{"data", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.863043011185392*^9, 3.863043057029903*^9}, {
  3.863043090424375*^9, 3.863043093223905*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"f5108614-9bd5-4067-b9d2-d1d89ac09e2b"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], LineBox[CompressedData["

1:eJwBAQL+/SFib1JlAgAAAB8AAAACAAAAdDQZIRVN8j7pti69L7wjQBwQkfJ/
yao/jkCGuC3OG0CK/j4hW8i6P77vWQ5hJxZAgrqaJPsVxD9LBmzj2u8VQMD1
lbjIx8o/lz5pdihEF0B+mEgmy7zQP5NNljvsqxhAHjZG8LEV1D9p4FdegNAZ
QL3TQ7qYbtc/65viMYWlGkBccUGEf8faP71eITz2MBtA+w4/TmYg3j86KsF/
Dn0bQE1WHoymvOA/d73XGt+UG0AbJR3xGWniPznHLA7SgxtA6vMbVo0V5D9+
Lgpr01UbQLrCGrsAwuU/qji0oU0XG0CJkRkgdG7nPy2I8PyN1BpAWWAYheca
6T8n1P54cpgaQCgvF+pax+o/GRFEFsNqGkD3/RVPznPsPxuiCxQUTxpAyMwU
tEEg7j/yFwnz8EQaQJebExm1zO8/so9Rmj5JGkAzNQk/lLzwPx9ppF8AWBpA
m5yI8c2S8T+kPCAwqG0aQAMECKQHafI/k1iY36CHGkBra4dWQT/zP13zSlA8
pBpA0tIGCXsV9D+2tGnYW8IaQDs6hru06/Q/2K3iIRLhGkCioQVu7sH1P2+U
MegF/xpACQmFICiY9j8spvx4FBcbQHFwBNNhbvc/7ZOdH2YJG0DY14OFm0T4
P95S7Bm6+BlAQD8DONUa+T+zWTQu2goaQMle3HY=
       "]]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6]}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6]}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 5.141213898758167},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{827.6484375, Automatic},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.5690509975429023`}, {5.141213898758167, 
    9.867551719620183}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{Automatic, 
     Charting`ScaledTicks[{Log, Exp}]}, {Automatic, {{6.214608098422191, 
       FormBox["500", TraditionalForm], {0.01, 0.}}, {6.907755278982137, 
       FormBox["1000", TraditionalForm], {0.01, 0.}}, {8.517193191416238, 
       FormBox["5000", TraditionalForm], {0.01, 0.}}, {9.210340371976184, 
       FormBox[
        TemplateBox[{"10", "4"}, "Superscript", SyntaxForm -> SuperscriptBox],
         TraditionalForm], {0.01, 0.}}, {4.605170185988092, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      5.298317366548036, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      5.703782474656201, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      5.991464547107982, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      6.396929655216146, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      6.551080335043404, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      6.684611727667927, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      6.802394763324311, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      7.600902459542082, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      8.006367567650246, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      8.294049640102028, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      8.699514748210191, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      8.85366542803745, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      8.987196820661973, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.104979856318357, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.903487552536127, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      10.308952660644293`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      10.596634733096073`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      10.819778284410283`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.002099841204238`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.156250521031495`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.289781913656018`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.407564949312402`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.512925464970229`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.918390573078392`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      12.206072645530174`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}}]]], "Output",
 CellChangeTimes->{3.863043057780188*^9, 3.863043093969924*^9, 
  3.863063510419593*^9, 3.863135989091092*^9, 3.863136788158424*^9, 
  3.863137666843884*^9, 3.863138492413093*^9, 3.863141008010168*^9, 
  3.863141660510189*^9, 3.863142117130927*^9},
 CellLabel->
  "Out[172]=",ExpressionUUID->"7d0d5e58-5ade-4b2b-a986-4fd87667ed97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data1", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"\[Theta]x", ",", 
      RowBox[{"I1u", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], ",", 
      RowBox[{"I2u", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<B4135kev.dat\>\"", ",", "data1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.86304315004424*^9, 3.863043154870356*^9}, {
   3.863063588553817*^9, 3.863063621828144*^9}, {3.863136824307472*^9, 
   3.863136828127976*^9}, 3.8631381511535254`*^9, {3.863140486493084*^9, 
   3.863140490016553*^9}, {3.86314107255457*^9, 3.863141072776235*^9}, {
   3.863141715509931*^9, 3.863141716231661*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"f30f94e4-e1e4-4ab5-84b5-5c46fd6443c0"],

Cell[BoxData["\<\"B4135kev.dat\"\>"], "Output",
 CellChangeTimes->{3.863063622171706*^9, 3.8631360102760344`*^9, 
  3.863136829118374*^9, 3.8631376669263897`*^9, 3.863138499560814*^9, 
  3.8631410161007223`*^9, 3.863141663493039*^9, 3.863142117207696*^9},
 CellLabel->
  "Out[175]=",ExpressionUUID->"5ad684bb-5499-4a02-ba55-805fc41a63d1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1655, 870},
WindowMargins->{{119, Automatic}, {Automatic, 32}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) \
(2020\:5e743\:670813\:65e5)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Report"}, "StandardReport.nb", CharacterEncoding -> 
       "UTF-8"]]], 
   Cell[
    StyleData["Input"], FontSize -> 24], 
   Cell[
    StyleData["Output"], FontSize -> 24], 
   Cell[
    StyleData["Text"], FontSize -> 24]}, Visible -> False, FrontEndVersion -> 
  "12.1 for Mac OS X x86 (64-bit) (2020\:5e743\:670813\:65e5)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"11b09b82-8214-49ec-aea7-f7fca90ff1d5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 283, 4, 97, "Title",ExpressionUUID->"85ee1e26-2fae-4e19-98ad-c5d22ed128fd"],
Cell[CellGroupData[{
Cell[888, 30, 281, 4, 69, "Section",ExpressionUUID->"1409faf0-fa3b-48b9-b0fe-28cdb8fefba3"],
Cell[1172, 36, 5022, 157, 1089, "Input",ExpressionUUID->"a36d15ba-8ec5-4d46-843a-f18f6d2fab97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6231, 198, 166, 3, 69, "Section",ExpressionUUID->"01ed5fe8-1806-4689-902c-6ccdd2a3b8df"],
Cell[CellGroupData[{
Cell[6422, 205, 3698, 89, 773, "Input",ExpressionUUID->"c532bf20-f6b3-406c-9708-12145a47ac2b"],
Cell[10123, 296, 14849, 302, 537, "Output",ExpressionUUID->"3a49f4d2-ffab-43bb-8dc8-b8841aa34ef4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25021, 604, 159, 3, 69, "Section",ExpressionUUID->"e66a0de1-3c1c-49b8-83a7-4953f4343738"],
Cell[25183, 609, 26696, 705, 4852, "Input",ExpressionUUID->"0c32b016-d668-47dd-b836-94deef2c4550"],
Cell[51882, 1316, 40712, 1092, 6495, "Input",ExpressionUUID->"b31cc2f8-e8a2-4e8c-92c4-e986fc8dfa24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92631, 2413, 164, 3, 69, "Section",ExpressionUUID->"750a1e48-a2d7-415c-91e7-b6eab27e8bb3"],
Cell[92798, 2418, 26439, 713, 4714, "Input",ExpressionUUID->"441ad3d1-55e4-45f4-b2c4-36afd192e5bf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119274, 3136, 161, 3, 69, "Section",ExpressionUUID->"6670b494-a3c8-4fb5-a991-dce31b98d1ed"],
Cell[119438, 3141, 10829, 302, 2206, "Input",ExpressionUUID->"22914adb-9b21-4244-8aa6-4c18220b252f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130304, 3448, 164, 3, 69, "Section",ExpressionUUID->"915f5a80-a629-4723-82a6-1bdb230f2708"],
Cell[130471, 3453, 8118, 244, 1851, "Input",ExpressionUUID->"dac479d8-99b9-4857-842f-02ffce54d0db"],
Cell[138592, 3699, 6753, 185, 1114, "Input",ExpressionUUID->"c8e58968-f91f-4ee3-a0b6-5085db58a74e"],
Cell[CellGroupData[{
Cell[145370, 3888, 29824, 741, 3630, "Input",ExpressionUUID->"741dba48-168c-4222-a15d-8017a21e0164"],
Cell[175197, 4631, 729, 14, 31, "Message",ExpressionUUID->"afbea5af-352d-4b3a-b403-3945e321c816"],
Cell[175929, 4647, 732, 14, 31, "Message",ExpressionUUID->"0e5b1cd8-d82b-49d2-a9f9-6105c754066e"],
Cell[176664, 4663, 730, 14, 31, "Message",ExpressionUUID->"1c6109c0-8e55-46f0-b03f-13ba13d4ff36"],
Cell[177397, 4679, 694, 13, 24, "Message",ExpressionUUID->"2c678d41-d50b-4f27-8cd6-312df87d7c59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178128, 4697, 249, 6, 55, "Input",ExpressionUUID->"3fa2a536-2eaa-4213-b6b0-8b645275d6c8"],
Cell[178380, 4705, 1265, 21, 132, "Output",ExpressionUUID->"9e05f274-5475-433e-bfc5-b50d7fb28db5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179682, 4731, 246, 6, 55, "Input",ExpressionUUID->"d8f40d35-c050-497f-8526-4d57b2654357"],
Cell[179931, 4739, 1268, 22, 132, "Output",ExpressionUUID->"19c7acae-f4cd-4bfd-8c75-dde888373998"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181236, 4766, 698, 20, 144, "Input",ExpressionUUID->"f5108614-9bd5-4067-b9d2-d1d89ac09e2b"],
Cell[181937, 4788, 6243, 148, 537, "Output",ExpressionUUID->"7d0d5e58-5ade-4b2b-a986-4fd87667ed97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188217, 4941, 999, 25, 208, "Input",ExpressionUUID->"f30f94e4-e1e4-4ab5-84b5-5c46fd6443c0"],
Cell[189219, 4968, 338, 5, 55, "Output",ExpressionUUID->"5ad684bb-5499-4a02-ba55-805fc41a63d1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

