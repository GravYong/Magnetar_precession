(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    219671,       5637]
NotebookOptionsPosition[    215182,       5547]
NotebookOutlinePosition[    216109,       5579]
CellTagsIndexPosition[    216066,       5576]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["grid and integration ", "Title",
 CellChangeTimes->{{3.861949729115543*^9, 3.8619497555245047`*^9}, {
  3.862013358777443*^9, 3.862013370505025*^9}, {3.862110010914356*^9, 
  3.862110027031199*^9}},
 TextAlignment->Center,ExpressionUUID->"85ee1e26-2fae-4e19-98ad-c5d22ed128fd"],

Cell[CellGroupData[{

Cell["1. Global constants and basic functions", "Section",
 CellChangeTimes->{{3.8619497826752243`*^9, 3.861949792911045*^9}, {
  3.861950789185286*^9, 3.861950796134797*^9}, {3.862110038365808*^9, 
  3.862110045210286*^9}},ExpressionUUID->"1409faf0-fa3b-48b9-b0fe-\
28cdb8fefba3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hbar", "=", 
   RowBox[{"1.0545718176461565", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "27"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", "=", 
   RowBox[{"4.803204712570263", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "10"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"me", "=", 
   RowBox[{"9.1093837015", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "28"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mp", "=", 
   RowBox[{"1.67262192369", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "24"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", "1"}], ";", 
  RowBox[{"Z", "=", "1"}], ";", 
  RowBox[{"Ye", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kb", "=", 
   RowBox[{"1.380649", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "16"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kev2erg", "=", 
   RowBox[{"1.6021766339999998", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", "29979245800.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]T", "=", 
   RowBox[{"8", "*", 
    FractionBox["\[Pi]", "3"], "*", 
    FractionBox[
     SuperscriptBox["e", "4"], 
     RowBox[{
      SuperscriptBox["c", "4"], " ", 
      SuperscriptBox["me", "2"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]T", "=", 
   FractionBox["\[Sigma]T", "mp"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"6.674299999999999", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "8"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Ms", "=", 
   RowBox[{"1.988409870698051", "*", 
    RowBox[{"10", "^", "33"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"km", "=", 
   SuperscriptBox["10", "5"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]F", "=", 
   FractionBox[
    SuperscriptBox["e", "2"], 
    RowBox[{"hbar", " ", "c"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BQ", "=", 
   RowBox[{
    SuperscriptBox["me", "2"], "*", 
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "3"], "/", "e"}], "/", "hbar"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"10.0", "^", 
    RowBox[{"Range", "[", 
     RowBox[{"a", ",", "b", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"linearspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Range", "[", 
    RowBox[{"a", ",", "b", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", "-", "a"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C0", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "a"}], "-", 
    RowBox[{
     RowBox[{"Exp", "[", "a", "]"}], "*", 
     RowBox[{"ExpIntegralE", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"C1", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "a"}], ")"}], "*", 
     RowBox[{"Exp", "[", "a", "]"}], "*", 
     RowBox[{"ExpIntegralE", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radian", "[", "x_", "]"}], ":=", 
   RowBox[{
    FractionBox["x", "180"], "*", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Planck", "[", 
    RowBox[{"Es_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"2", "*", "hbar", "*", "2", "*", "\[Pi]", "*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Es", "*", 
        RowBox[{
         RowBox[{
          RowBox[{"kev2erg", "/", "hbar"}], "/", "2"}], "/", "\[Pi]"}]}], 
       ")"}], "^", "3"}], "/", 
     RowBox[{"c", "^", "2"}]}], "*", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Es", "*", "kev2erg"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}]}], "]"}], "-", "1"}], ")"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.86195011325911*^9, 3.861950161810429*^9}, {
  3.861950226622788*^9, 3.8619502705418053`*^9}, {3.861950450560298*^9, 
  3.86195050074433*^9}, {3.861950692125059*^9, 3.8619507100833673`*^9}, {
  3.861950761050561*^9, 3.861950765426078*^9}, {3.861961074401415*^9, 
  3.861961076247954*^9}, {3.862022828791157*^9, 3.8620228294910097`*^9}, {
  3.8621100714817133`*^9, 3.862110072547246*^9}, {3.862110711005892*^9, 
  3.862110711904375*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a36d15ba-8ec5-4d46-843a-f18f6d2fab97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temperature profile", "Section",
 CellChangeTimes->{{3.8620163980057573`*^9, 
  3.862016401340963*^9}},ExpressionUUID->"01ed5fe8-1806-4689-902c-\
6ccdd2a3b8df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"temperature", "[", "\[Tau]_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Tau]mid", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]mid", "=", "27.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a1", "=", "0.793"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a2", "=", " ", "0.122"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a3", "=", 
       RowBox[{"-", "0.502"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a4", "=", "0.548"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a5", "=", " ", 
       RowBox[{"-", "0.205"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a6", "=", "0.0266"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b3", "=", "0.00445"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b4", "=", "0.0108"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b5", "=", "0.00211"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b6", "=", "0.0000574"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"temperature", "[", "\[Tau]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Tau]", ",", "0.001", ",", 
     SuperscriptBox["10", "4"]}], "}"}], ",", 
   RowBox[{"Background", "\[Rule]", "White"}], ",", 
   RowBox[{"PlotTheme", "->", "\"\<Monochrome\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{3.862110292583253*^9, 3.862462339204153*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"c532bf20-f6b3-406c-9708-12145a47ac2b"],

Cell[BoxData[
 GraphicsBox[{{{{}, {}, 
     TagBox[
      {GrayLevel[0], AbsoluteThickness[1.6], Opacity[1.], Dashing[{}], 
       CapForm["Butt"], LineBox[CompressedData["
1:eJwBIQPe/CFib1JlAgAAADEAAAACAAAAAdd8g4qhG8DiRBDIiiksQHzZ4aJ6
nBvAW9nLUMgpLED220bCapcbwPW56AMGKixA7OAQAUuNG8ApZ/7ogSosQNbq
pH4LeRvALyCirHsrLECs/sx5jFAbwKCiFwp3LSxAViYdcI7/GsCFLJKgjDEs
QKx1vVySXRrAhD+5WS86LEBk+AkSWv4YwFqnv33nTixA77YqHWi2F8CmVNqd
eGQsQLU+MgDldBbAx/3HqW57LECIqkW/IRgVwFskBBAXlixALVIt1KTSE8D2
aAWCW7AsQN/dIMXncRLAo+M4dRDOLEDMMvuNmRcRwCWWO/Y47CxAGIdTWSOp
D8Dn0OEvBQktQLJwyE6T7AzAWhgDub8oLUDw0eXvj14KwEW3a3qlRi1ApcXQ
QGrdB8C7RQkQDGQtQHSB00nEJQXA/ZZUbuCDLUDntH7+qpwCwMIoe/FcoS1A
6WCD1iK6/79KFTe18cAtQPB8pA+rVPq/UwcOL27fLUA/iBagTEz1vwVti5FM
+y1Ah0dwQdut779nqAPj0RguQCFdVfFPfeW/yt427qQzLkBJJjMDh+XUv/sK
1CncTy5AtT/7uosUiT8mLhy5qmouQCQdn2FqAtU/+neWE92CLkC7D1RSGXjl
PzrPWak4nC5AU7I2xcq07z8t5FEGGrMuQImFcbwC3/Q/CDzB+NTILkC0IRim
oFD6P42hvnix3y5Al85tOCVl/z/yFxQpcvQuQKL1SS1VcwJAkvmrPW0KL0CC
cY8OOicFQFCiE0SjHy9AvnUsRJKsB0DGpDJwPzMvQK6KIqaBtwdAcTwJYJQz
L0CfnxgIccIHQOeE4E/pMy9AgMkEzE/YB0D4+MkvkzQvQEId3VMNBAhAOroX
8uY1L0DGxI1jiFsIQF/oMI2OOC9AzhPvgn4KCUCWGWuD3j0vQL4o5eRtFQlA
r5BmjzM+L0CvPdtGXSAJQMwlN52IPi9AkGfHCjw2CUASIpS+Mj8vQFK7n5L5
YQlABkbmGYdAL0DWYlCidLkJQCR3SkAwQy9AWSO2QetaCkAnPJVVG0gvQLg4
Vu0=
        "]], LineBox[CompressedData["
1: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
zYa1DPkIfV8utDwpeFDsy4ZDDsOtt9D/B3HYy38=
        "]]},
      Annotation[#, 
       "Charting`Private`Tag$3156#1"]& ], {}}, {{}, {}}, {{}, {}}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-6.907755278982137, 14.08113694380376},
  AxesStyle->GrayLevel[0],
  Background->GrayLevel[1],
  BaseStyle->GrayLevel[0],
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Exp[
       Part[#, 1]], 
      Exp[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Exp[
       Part[#, 1]], 
      Exp[
       Part[#, 2]]}& )},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->GrayLevel[0],
  FrameTicks->{{Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
     Charting`ScaledFrameTicks[{Log, Exp}]}, {Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
     Charting`ScaledFrameTicks[{Log, Exp}]}},
  FrameTicksStyle->GrayLevel[0],
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0], 
    AbsoluteThickness[1], 
    AbsoluteDashing[{1, 2}]],
  ImagePadding->All,
  ImageSize->{838.00390625, Automatic},
  LabelStyle->{FontFamily -> "Helvetica", 
    GrayLevel[0]},
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->NCache[{{-6.907755278982137, 
      Log[10000]}, {14.08113694380376, 
     16.420483164104912`}}, {{-6.907755278982137, 9.210340371976184}, {
    14.08113694380376, 16.420483164104912`}}],
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 
       6}]]& }, {{{-6.907755278982137, 
       FormBox["0.001`", TraditionalForm], {0.01, 0.}}, {-2.3025850929940455`, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.100\"", 0.1, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 3}]& ], TraditionalForm], {0.01, 0.}}, {
      2.302585092994046, 
       FormBox["10", TraditionalForm], {0.01, 0.}}, {6.907755278982137, 
       FormBox["1000", TraditionalForm], {0.01, 0.}}, {-4.605170185988091, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      4.605170185988092, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.210340371976184, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.512925464970229`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.608235644774552`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.695247021764184`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}}, {{
      14.508657738524219`, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "2", 
          
          TemplateBox[{"10", "6"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}}, {15.424948470398375`, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "5", 
          
          TemplateBox[{"10", "6"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}}, {16.11809565095832, 
       FormBox[
        TemplateBox[{"\[Times]", "\"\[Times]\"", "1", 
          
          TemplateBox[{"10", "7"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]}, "RowWithSeparators"], TraditionalForm], {0.01, 
       0.}}, {13.815510557964274`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      14.22097566607244, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      14.914122846632385`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      15.201804919084164`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      15.60727002719233, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      15.761420707019587`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      15.89495209964411, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      16.012735135300492`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      16.523560759066484`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      16.811242831518264`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}}}],
  TicksStyle->GrayLevel[0]]], "Output",
 CellChangeTimes->{3.862016561060396*^9, 3.862022834627824*^9, 
  3.862024180879179*^9, 3.8620242392526817`*^9, 3.862024374373705*^9, 
  3.862110297248711*^9, 3.862110343314375*^9, 3.862110717315637*^9, 
  3.862112709690319*^9, 3.8621128887815657`*^9, 3.862114628829155*^9, 
  3.8621154565154543`*^9, 3.862115592514832*^9, 3.8621159599116983`*^9, 
  3.8621163990147133`*^9, 3.862136449741943*^9, 3.8622001109243507`*^9, 
  3.862216052639635*^9, 3.8622167667948923`*^9, 3.862218101244329*^9, 
  3.8622189566511717`*^9, 3.862276910381792*^9, 3.8622853273272867`*^9, 
  3.862290816360045*^9, 3.86229085268187*^9, 3.862462341162821*^9, 
  3.8624831905000553`*^9, 3.862489586036602*^9, 3.862536820778262*^9, 
  3.862547376808482*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"0c2aee2b-72b3-4fc9-83fe-a08c13b4bf30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"temperature", "[", "27.1", "]"}]], "Input",
 CellChangeTimes->{{3.862536822848233*^9, 3.862536881171431*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0ddc5fc2-881e-4e13-95f9-9e5f8d6565d8"],

Cell[BoxData["6.208690342300636`*^6"], "Output",
 CellChangeTimes->{
  3.862536831115386*^9, {3.86253686260712*^9, 3.862536881789216*^9}, 
   3.862547376937796*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"434e4965-7509-4f0a-b9d9-69dbe2fd82a5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scatter opacity", "Section",
 CellChangeTimes->{{3.86211078365486*^9, 
  3.862110787266242*^9}},ExpressionUUID->"e66a0de1-3c1c-49b8-83a7-\
4953f4343738"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aint", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Eci", ",", 
      "Epe", ",", "Epi", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "b",
       ",", "a", ",", "q", ",", "m", ",", "ri", ",", "\[Epsilon]p", ",", 
      "\[Eta]p", ",", "g", ",", "\[Epsilon]", ",", "\[Eta]", ",", "\[Beta]i", 
      ",", "K1i", ",", "K2i", ",", "Kz1i", ",", "Kz2i", ",", "ep1i", ",", 
      "em1i", ",", "ep2i", ",", "em2i", ",", "e01i", ",", "e02i", ",", "Ap1", 
      ",", "Am1", ",", "A01", ",", "Ap2", ",", "Am2", ",", "A02", ",", "Ap", 
      ",", "Am", ",", "A0", ",", "\[Rho]", ",", "x", ",", "T", ",", "Mns", 
      ",", "Rns", ",", "gns", ",", "\[Tau]mid", ",", "\[Gamma]eiL", ",", 
      "\[Gamma]eip", ",", "y1", ",", "y2", ",", "\[Gamma]re", ",", 
      "\[Gamma]ri", ",", "gl", ",", "gp", ",", "\[Epsilon]pg", ",", 
      "\[Epsilon]mg", ",", "\[Delta]v"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "27.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.793"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", " ", "0.122"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", 
      RowBox[{"-", "0.502"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", "0.548"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", 
      RowBox[{"-", "0.205"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", "0.0266"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", "0.00445"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", "0.0108"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", "0.00211"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", "0.0000574"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", " ", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "-", 
       RowBox[{"2", "*", "\[Delta]v"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "y2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ri", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]i", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]i", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1i", "=", 
      RowBox[{"\[Beta]i", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["ri", 
             SuperscriptBox["\[Beta]i", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2i", "=", 
      RowBox[{"\[Beta]i", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["ri", 
             SuperscriptBox["\[Beta]i", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1i", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}], "K1i"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]i", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]i", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2i", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}], "K2i"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]i", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]i", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1i", "*", 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
          RowBox[{"Kz1i", "*", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2i", "*", 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
          RowBox[{"Kz2i", "*", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1i", "*", 
             RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
            RowBox[{"Kz1i", "*", 
             RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2i", "*", 
             RowBox[{"Cos", "[", "\[Theta]i", "]"}]}], "+", 
            RowBox[{"Kz2i", "*", 
             RowBox[{"Sin", "[", "\[Theta]i", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1i", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}], "-", 
          RowBox[{"Kz1i", "*", 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2i", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]i", "]"}]}], "-", 
          RowBox[{"Kz2i", "*", 
           RowBox[{"Cos", "[", "\[Theta]i", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"ep1i", "+", "ep2i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Am", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"em1i", "+", "em2i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A0", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"e01i", "+", "e02i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap2", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", "ep2i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     RowBox[{"Am2", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", "em2i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A02", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]i", "]"}], "*", "e02i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]i", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap1", "=", 
      RowBox[{"Ap", "-", "Ap2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Am1", "=", 
      RowBox[{"Am", "-", "Am2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A01", "=", 
      RowBox[{"A0", "-", "A02"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Ap1", ",", "Ap2", ",", "Am1", ",", "Am2", ",", "A01", ",", "A02"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.862112477793551*^9, 3.862112636743717*^9}, {
   3.862112667241892*^9, 3.862112688654994*^9}, 3.862112731447269*^9, {
   3.8621130987238693`*^9, 3.862113105786236*^9}, {3.8621133699680347`*^9, 
   3.862113382297454*^9}, {3.862115479104953*^9, 3.8621154797951117`*^9}, {
   3.862200119724718*^9, 3.862200129813558*^9}, {3.8622031711794167`*^9, 
   3.862203171521489*^9}, 3.862215349862418*^9, {3.862215400577221*^9, 
   3.8622154438097467`*^9}, {3.862215494701984*^9, 3.8622155171940613`*^9}, {
   3.86221556634977*^9, 3.862215684434338*^9}, {3.862216211947282*^9, 
   3.862216291258833*^9}, 3.8624623473315*^9, {3.8624625336696033`*^9, 
   3.86246254814902*^9}, {3.8624702979564238`*^9, 3.862470363122987*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"0c32b016-d668-47dd-b836-94deef2c4550"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scatteropacity", "[", 
   RowBox[{
   "Es_", ",", "B_", ",", "\[Tau]_", ",", "\[Theta]b_", ",", "Ap1_", ",", 
    "Ap2_", ",", "Am1_", ",", "Am2_", ",", "A01_", ",", "A02_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Eci", ",", 
      "Epe", ",", "Epi", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "b",
       ",", "a", ",", "q", ",", "m", ",", "r", ",", "\[Epsilon]p", ",", 
      "\[Eta]p", ",", "g", ",", "\[Epsilon]", ",", "\[Eta]", ",", "\[Beta]", 
      ",", "K1", ",", "K2", ",", "Kz1", ",", "Kz2", ",", "ep1", ",", "em1", 
      ",", "ep2", ",", "em2", ",", "e01", ",", "e02", ",", "gl", ",", "gp", 
      ",", "\[Omega]ci", ",", "\[Tau]mid", ",", "x", ",", "T", ",", "\[Rho]", 
      ",", "Mns", ",", "Rns", ",", "gns", ",", "\[Gamma]eiL", ",", 
      "\[Gamma]eip", ",", "y1", ",", "y2", ",", "\[Gamma]re", ",", 
      "\[Gamma]ri", ",", "\[Epsilon]pg", ",", "\[Epsilon]mg", ",", 
      "\[Gamma]ep", ",", "\[Gamma]em", ",", "\[Gamma]e0", ",", "\[Gamma]ip", 
      ",", "\[Gamma]im", ",", "\[Gamma]i0", ",", "\[Kappa]s1e1", ",", 
      "\[Kappa]s1i1", ",", "\[Kappa]s2e1", ",", "\[Kappa]s2i1", ",", 
      "\[Kappa]s11", ",", "\[Kappa]s12", ",", "\[Kappa]s1e2", ",", 
      "\[Kappa]s1i2", ",", "\[Kappa]s2e2", ",", "\[Kappa]s2i2", ",", 
      "\[Kappa]s21", ",", "\[Kappa]s22", ",", "\[Delta]v"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "27.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.793"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", " ", "0.122"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", 
      RowBox[{"-", "0.502"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", "0.548"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", 
      RowBox[{"-", "0.205"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", "0.0266"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", "0.00445"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", "0.0108"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", "0.00211"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", "0.0000574"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]ci", "=", " ", 
      FractionBox[
       RowBox[{"Z", " ", "e", " ", "B"}], 
       RowBox[{"A", " ", "mp", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", " ", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "-", 
       RowBox[{"2", "*", "\[Delta]v"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "y2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K1", "2"], "+", 
        SuperscriptBox["Kz1", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K2", "2"], "+", 
        SuperscriptBox["Kz2", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ep", "=", 
      RowBox[{"\[Gamma]eiL", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]em", "=", 
      RowBox[{"\[Gamma]eiL", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]e0", "=", 
      RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ip", "=", 
      RowBox[{
       FractionBox["me", "mp"], 
       RowBox[{"(", 
        RowBox[{"\[Gamma]eiL", "+", "\[Gamma]ri"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]im", "=", 
      RowBox[{
       FractionBox["me", "mp"], 
       RowBox[{"(", 
        RowBox[{"\[Gamma]eiL", "+", "\[Gamma]ri"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]i0", "=", 
      RowBox[{
       FractionBox["me", "mp"], 
       RowBox[{"(", 
        RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1e1", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1i1", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s11", "=", 
      RowBox[{"\[Kappa]s1e1", "+", "\[Kappa]s1i1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1e2", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1i2", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s12", "=", 
      RowBox[{"\[Kappa]s1e2", "+", "\[Kappa]s1i2"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2e1", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2i1", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s21", "=", 
      RowBox[{"\[Kappa]s2e1", "+", "\[Kappa]s2i1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2e2", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2i2", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s22", "=", 
      RowBox[{"\[Kappa]s2e2", "+", "\[Kappa]s2i2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\[Kappa]s11", ",", "\[Kappa]s12", ",", "\[Kappa]s21", ",", 
       "\[Kappa]s22"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8619662542964487`*^9, 3.861966255752267*^9}, {
   3.861966286990212*^9, 3.861966310815189*^9}, {3.861966366553494*^9, 
   3.8619664126295967`*^9}, {3.861966460014474*^9, 3.861966483428029*^9}, {
   3.86196654554508*^9, 3.8619666605210953`*^9}, {3.861966709209655*^9, 
   3.86196678522508*^9}, {3.861966857722144*^9, 3.861966977802162*^9}, {
   3.8619670078662767`*^9, 3.8619670086754303`*^9}, {3.861967823028294*^9, 
   3.861967865685066*^9}, {3.861967957327875*^9, 3.861967968782711*^9}, {
   3.861968034251009*^9, 3.8619680398823147`*^9}, {3.861968080697742*^9, 
   3.861968292401668*^9}, {3.861968369720783*^9, 3.8619684150963163`*^9}, {
   3.8619687055175047`*^9, 3.8619687111944933`*^9}, {3.861968936893284*^9, 
   3.861968958711403*^9}, {3.861969646033495*^9, 3.861969668735609*^9}, {
   3.8620571419812107`*^9, 3.8620571591419067`*^9}, {3.8620572319040737`*^9, 
   3.862057237408332*^9}, {3.862057475001934*^9, 3.862057483808165*^9}, {
   3.8620575360617447`*^9, 3.862057543897107*^9}, {3.862110942743116*^9, 
   3.86211098309041*^9}, 3.862111016017262*^9, {3.8621110568299513`*^9, 
   3.862111121471571*^9}, {3.862111353442923*^9, 3.8621113538948927`*^9}, {
   3.862112308960351*^9, 3.862112323281927*^9}, {3.862112384822692*^9, 
   3.8621123879649*^9}, {3.862200170712943*^9, 3.862200180229312*^9}, {
   3.862203182069058*^9, 3.862203182648527*^9}, 3.8622163742307997`*^9, {
   3.862216414326277*^9, 3.862216449143799*^9}, {3.8622164956373568`*^9, 
   3.862216582432743*^9}, 3.862216825168517*^9, 3.862216860282577*^9, 
   3.862462402463912*^9, {3.862462640879861*^9, 3.86246267317045*^9}, {
   3.862471850384742*^9, 3.862471862663044*^9}, {3.862539117644586*^9, 
   3.862539141086739*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b31cc2f8-e8a2-4e8c-92c4-e986fc8dfa24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["free free opacity", "Section",
 CellChangeTimes->{{3.862111302735526*^9, 
  3.8621113078983707`*^9}},ExpressionUUID->"750a1e48-a2d7-415c-91e7-\
b6eab27e8bb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freeopacity", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Epsilon]p", ",", "\[Eta]p", ",", "\[Epsilon]", ",", "\[Eta]", ",", 
      "g", ",", "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", 
      "Epi", ",", "Eci", ",", "Epe", ",", "ue", ",", "ui", ",", "ve", ",", 
      "vi", ",", "\[Gamma]re", ",", "\[Gamma]ri", ",", "r1", ",", "r2", ",", 
      "\[Gamma]eiL", ",", "\[Gamma]eip", ",", "\[Epsilon]pg", ",", 
      "\[Epsilon]mg", ",", "\[Alpha]F", ",", "BQ", ",", "b", ",", "a", ",", 
      "q", ",", "m", ",", "r", ",", "\[Beta]", ",", "K1", ",", "K2", ",", 
      "Kz1", ",", "Kz2", ",", "ep1", ",", "ep2", ",", "em1", ",", "em2", ",", 
      "e01", ",", "e02", ",", "\[Gamma]p", ",", "\[Gamma]m", ",", 
      "\[CapitalLambda]p", ",", "\[CapitalLambda]m", ",", "\[Kappa]p", ",", 
      "\[Kappa]m", ",", "\[Kappa]o", ",", "\[Kappa]ff1", ",", "\[Kappa]ff2", 
      ",", "\[Tau]mid", ",", "x", ",", "Mns", ",", "Rns", ",", "gns", ",", 
      "gp", ",", "gl", ",", "\[Rho]", ",", "T", ",", "\[Delta]v"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "27.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.793"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", " ", "0.122"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", 
      RowBox[{"-", "0.502"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", "0.548"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", 
      RowBox[{"-", "0.205"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", "0.0266"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", "0.00445"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", "0.0108"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", "0.00211"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", "0.0000574"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", " ", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "-", 
       RowBox[{"2", "*", "\[Delta]v"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "r1"}], "*", "r2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"r2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "r1"}], "*", "r2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "r2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"r2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]F", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["e", "2"], "/", "hbar"}], "/", "c"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BQ", "=", 
      RowBox[{
       SuperscriptBox["me", "2"], "*", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c", "3"], "/", "e"}], "/", "hbar"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]p", "=", 
      RowBox[{"\[Gamma]eiL", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["ue", "0.5"]}], ")"}], "\[Gamma]ri"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["ui", "0.5"]}], ")"}], "\[Gamma]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]m", "=", 
      RowBox[{"\[Gamma]eiL", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["ue", "0.5"]}], ")"}], "\[Gamma]ri"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["ui", "0.5"]}], ")"}], "\[Gamma]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]p", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["ue", "0.5"]}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["ui", "0.5"]}], ")"}], "2"]}], "+", 
         SuperscriptBox["\[Gamma]p", "2"]}], ")"}], 
       RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]m", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["ue", "0.5"]}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["ui", "0.5"]}], ")"}], "2"]}], "+", 
         SuperscriptBox["\[Gamma]m", "2"]}], ")"}], 
       RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]p", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", " ", "\[CapitalLambda]p", " ",
        "\[Gamma]eiL"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]m", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", " ", "\[CapitalLambda]m", " ",
        "\[Gamma]eiL"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]o", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", "*", "\[Gamma]eip"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]ff1", "=", 
      RowBox[{
       RowBox[{"\[Kappa]p", "*", "ep1"}], " ", "+", " ", 
       RowBox[{"\[Kappa]m", "*", "em1"}], " ", "+", " ", 
       RowBox[{"\[Kappa]o", "*", "e01"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]ff2", "=", 
      RowBox[{
       RowBox[{"\[Kappa]p", "*", "ep2"}], " ", "+", " ", 
       RowBox[{"\[Kappa]m", "*", "em2"}], "+", " ", 
       RowBox[{"\[Kappa]o", "*", "e02"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]ff1", ",", "\[Kappa]ff2"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.862111315259729*^9, 3.862111341481821*^9}, {
   3.862111375592436*^9, 3.862111389641347*^9}, {3.862112257094551*^9, 
   3.862112282827321*^9}, 3.862116480450753*^9, {3.8622172708110237`*^9, 
   3.862217310231078*^9}, {3.862217358058984*^9, 3.862217388842092*^9}, 
   3.862462431714108*^9, {3.862462705290111*^9, 3.862462711843533*^9}, {
   3.8624705039967117`*^9, 3.862470504512423*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"441ad3d1-55e4-45f4-b2c4-36afd192e5bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freeopacity1", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Eci", ",", 
      "Epe", ",", "Epi", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "b",
       ",", "a", ",", "q", ",", "m", ",", "r", ",", "\[Epsilon]p", ",", 
      "\[Eta]p", ",", "g", ",", "\[Epsilon]", ",", "\[Eta]", ",", "\[Beta]", 
      ",", "K1", ",", "K2", ",", "Kz1", ",", "Kz2", ",", "ep1", ",", "em1", 
      ",", "ep2", ",", "em2", ",", "e01", ",", "e02", ",", "ne", ",", "ni", 
      ",", "\[Alpha]0", ",", "gl", ",", "gp", ",", "y1", ",", "y2", ",", 
      "\[Omega]ci", ",", "\[Nu]re", ",", "\[Nu]ep", ",", "\[Nu]em", ",", 
      "\[Nu]e0", ",", "\[Nu]ip", ",", "\[Nu]im", ",", "\[Nu]i0", ",", "ffe1", 
      ",", "ffi1", ",", "ffe2", ",", "ffi2", ",", "ff1", ",", "ff2", ",", "T",
       ",", "\[Rho]", ",", "Mns", ",", "Rns", ",", "gns", ",", "\[Tau]mid", 
      ",", "x", ",", "\[Delta]v"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "27.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.793"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", " ", "0.122"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", 
      RowBox[{"-", "0.502"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", "0.548"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", 
      RowBox[{"-", "0.205"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", "0.0266"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", "0.00445"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", "0.0108"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", "0.00211"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", "0.0000574"}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]ci", "=", " ", 
      FractionBox[
       RowBox[{"Z", " ", "e", " ", "B"}], 
       RowBox[{"A", " ", "mp", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", " ", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "-", 
       RowBox[{"2", "*", "\[Delta]v"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"ve", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            FractionBox[
             RowBox[{"A", " ", "mp"}], 
             RowBox[{"Z", " ", "me"}]], " ", "ui"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "ui"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "ue"}], ")"}]}]]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", "ve"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      FractionBox[
       RowBox[{"ve", "*", 
        SuperscriptBox["ue", "0.5"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "ui"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", "ue"}], ")"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K1", "2"], "+", 
        SuperscriptBox["Kz1", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K2", "2"], "+", 
        SuperscriptBox["Kz2", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ne", "=", 
      RowBox[{"\[Rho]", "/", "mp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ni", "=", "ne"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]0", "=", 
      RowBox[{"4", "*", 
       SuperscriptBox["\[Pi]", "2"], 
       SuperscriptBox["Z", "2"], 
       SuperscriptBox["\[Alpha]F", "3"], " ", 
       FractionBox[
        RowBox[{
         SuperscriptBox["hbar", "2"], " ", 
         SuperscriptBox["c", "2"]}], 
        SuperscriptBox["me", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", 
          FractionBox["me", 
           RowBox[{"\[Pi]", " ", "kb", " ", "T"}]]}], ")"}], 
        RowBox[{"1", "/", "2"}]], 
       FractionBox[
        RowBox[{"ne", " ", "ni"}], 
        SuperscriptBox["\[Omega]", "3"]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "hbar"}], " ", "\[Omega]"}], 
           RowBox[{"kb", " ", "*", "T"}]], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "y2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Nu]re", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "*", 
         SuperscriptBox["e", "2"]}], 
        RowBox[{"3", " ", "me", " ", 
         SuperscriptBox["c", "3"]}]], 
       SuperscriptBox["\[Omega]", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]ep", "=", 
      RowBox[{"\[Nu]re", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]0", "*", "gl"}], 
         RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]em", "=", 
      RowBox[{"\[Nu]re", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]0", "*", "gl"}], 
         RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]e0", "=", 
      RowBox[{"\[Nu]re", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]0", "*", "gp"}], 
         RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]ip", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Nu]re", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Alpha]0", "*", "gl"}], 
           RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}], ")"}], 
       FractionBox["me", "mp"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]im", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Nu]re", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Alpha]0", "*", "gl"}], 
           RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}], ")"}], 
       FractionBox["me", "mp"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]i0", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Nu]re", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Alpha]0", "*", "gp"}], 
           RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}], ")"}], 
       FractionBox["me", "mp"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffe1", "=", 
      RowBox[{
       FractionBox["\[Alpha]0", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"1", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]ep", "2"]}]], ")"}], "ep1", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "-", 
                RowBox[{"1", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]em", "2"]}]], ")"}], "em1", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"0", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]e0", "2"]}]], ")"}], "e01", "*", "gp"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffi1", "=", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["Z", "3"]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], 
       FractionBox["\[Alpha]0", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "-", 
                RowBox[{"1", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]ip", "2"]}]], ")"}], "ep1", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"1", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]im", "2"]}]], ")"}], "em1", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"0", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]i0", "2"]}]], ")"}], "e01", "*", "gp"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffe2", "=", 
      RowBox[{
       FractionBox["\[Alpha]0", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"1", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]ep", "2"]}]], ")"}], "ep2", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "-", 
                RowBox[{"1", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]em", "2"]}]], ")"}], "em2", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"0", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]e0", "2"]}]], ")"}], "e02", "*", "gp"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffi2", "=", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["Z", "3"]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], 
       FractionBox["\[Alpha]0", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "-", 
                RowBox[{"1", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]ip", "2"]}]], ")"}], "ep2", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"1", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]im", "2"]}]], ")"}], "em2", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"0", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]i0", "2"]}]], ")"}], "e02", "*", "gp"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ff1", "=", 
      RowBox[{"ffe1", "+", "ffi1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ff2", "=", 
      RowBox[{"ffe2", "+", "ffi2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ff1", ",", "ff2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.862218855170843*^9, 3.862462447876086*^9, {3.862462761501288*^9, 
   3.862462769145114*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"e0a3b7db-d3d8-4b8b-8200-daca4cb5096d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["jump condition", "Section",
 CellChangeTimes->{{3.8621116025960693`*^9, 
  3.862111605381013*^9}},ExpressionUUID->"6670b494-a3c8-4fb5-a991-\
dce31b98d1ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]reson", "[", 
    RowBox[{"Es_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q", ",", "m", ",", "\[Omega]c", ",", "Ebi", ",", "Mns", ",", "Rns", 
       ",", "Ead", ",", "b", ",", "\[Delta]v", ",", "fB", ",", "gns", ",", 
       "\[Rho]v", ",", "\[Tau]v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]v", "=", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"45", " ", "\[Pi]"}]], 
        SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fB", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"3", "*", "\[Delta]v"}], 
          RowBox[{"q", "+", "m"}]], ")"}], "0.5"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mns", "=", 
       RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rns", "=", 
       SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gns", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"G", "*", "Mns"}], 
         SuperscriptBox["Rns", "2"]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", "G", " ", "Mns"}], 
            RowBox[{"Rns", " ", 
             SuperscriptBox["c", "2"]}]]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]v", "=", 
       RowBox[{"0.96", "*", " ", 
        SuperscriptBox["Ye", 
         RowBox[{"-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Es", "/", "1"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"B", "/", 
           SuperscriptBox["10", "14"]}], ")"}], "2"], 
        SuperscriptBox["fB", 
         RowBox[{"-", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]v", "=", 
       RowBox[{"\[Tau]x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"temperature", "[", "\[Tau]x", "]"}], "-", 
            RowBox[{"\[Tau]x", "*", 
             FractionBox[
              RowBox[{"mp", " ", "gns"}], 
              RowBox[{"\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb"}]]}]}],
            "\[Equal]", "0"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]x", ",", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"mp", " ", "gns"}], 
               RowBox[{
               "\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb", "*", "5", 
                "*", 
                SuperscriptBox["10", "6"]}]], ")"}], 
             RowBox[{"-", "1"}]]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[Tau]v"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pjump", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Tau]v", ",", "Tv", ",", "H\[Rho]", ",", "jump", ",", "b", ",", "q", 
      ",", "m", ",", "\[Delta]v", ",", "fB", ",", "Mns", ",", "Rns", ",", 
      "gns", ",", "\[Omega]c", ",", "Ebi", ",", "\[Rho]v", ",", "Ead"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", " ", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"7", "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", "4"}], "\[Delta]v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fB", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"3", "*", "\[Delta]v"}], 
         RowBox[{"q", "+", "m"}]], ")"}], "0.5"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ebi", "=", 
      RowBox[{"hbar", "*", "\[Omega]c", "*", 
       RowBox[{
        FractionBox["me", "mp"], "/", "kev2erg"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", 
      RowBox[{"0.96", "*", " ", 
       SuperscriptBox["Ye", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Es", "/", "1"}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"B", "/", 
          SuperscriptBox["10", "14"]}], ")"}], "2"], 
       SuperscriptBox["fB", 
        RowBox[{"-", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]v", "=", 
      RowBox[{"\[Tau]x", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"temperature", "[", "\[Tau]x", "]"}], "-", 
           RowBox[{"\[Tau]x", "*", 
            FractionBox[
             RowBox[{"mp", " ", "gns"}], 
             RowBox[{"\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb"}]]}]}], 
          "\[Equal]", "0"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"\[Tau]x", ",", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"mp", " ", "gns"}], 
              RowBox[{
              "\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb", "*", "5", "*", 
               SuperscriptBox["10", "6"]}]], ")"}], 
            RowBox[{"-", "1"}]]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tv", "=", 
      RowBox[{"temperature", "[", "\[Tau]v", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"H\[Rho]", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"2", "*", "kb", "*", 
        RowBox[{"Tv", "/", 
         RowBox[{"(", 
          RowBox[{"mp", " ", "*", " ", "gns", " ", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ead", "=", 
      RowBox[{"2.52", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"fB", "*", 
            RowBox[{"Tan", "[", "\[Theta]b", "]"}]}], ")"}], "2"], ")"}], 
        RowBox[{"1", "/", "3"}]], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Abs", "[", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["Ebi", "Es"], ")"}], "2"]}], "]"}], ")"}], 
        RowBox[{"2", "/", "3"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", "H\[Rho]"], ")"}], 
        RowBox[{"1", "/", "3"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jump", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "\[Pi]"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["Es", "Ead"], ")"}], "3"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"N", "[", "jump", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.862112202826563*^9, 3.862112203943747*^9}, {
  3.8624629110938597`*^9, 3.862462926351473*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"22914adb-9b21-4244-8aa6-4c18220b252f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Pjump", "[", 
    RowBox[{"1", ",", 
     SuperscriptBox["10", "13"], ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8624627900772552`*^9, 3.8624628963746367`*^9}, {
  3.862462976595648*^9, 3.862462977281878*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a547c8d1-d15f-4623-849d-4420102a2f66"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"2.5402439333372045`*^7\\\"}], \\\"]\\\"}]\\) is too small to represent as \
a normalized machine number; precision may be lost.\"", 2, 31, 1, 
   24467406112762944239, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.862462820051526*^9, 3.8624628972822104`*^9}, 
   3.862462941396894*^9, 3.862462978079221*^9, 3.862470628065648*^9, 
   3.862471942868772*^9, 3.862539247797625*^9, 3.862547377246523*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[31]:=",ExpressionUUID->"d7c0004f-4763-4b09-b6d6-\
8725645729de"],

Cell[BoxData[
 GraphicsBox[{{{{}, {}, 
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1: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
8T+f9Gde
        "]], LineBox[CompressedData["
1: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

        "]]},
      Annotation[#, 
       "Charting`Private`Tag$4018#1"]& ], {}}, {{}, {}}, {{}, {}}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.862462820067992*^9, 3.862462898660857*^9}, {
   3.862462961790777*^9, 3.86246298861938*^9}, 3.8624706375579653`*^9, 
   3.862471952489834*^9, 3.862539257528914*^9, 3.862547387173139*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"a6764698-2f64-413b-8ce2-d1503aecf2de"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generating the grid", "Section",
 CellChangeTimes->{{3.862113769441164*^9, 
  3.862113774126528*^9}},ExpressionUUID->"915f5a80-a629-4723-82a6-\
1bdb230f2708"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Es", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   SuperscriptBox["10", "13"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]v", "=", 
   RowBox[{"\[Tau]reson", "[", 
    RowBox[{"Es", ",", "B"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]x1", "=", 
   RowBox[{"logspace", "[", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", "\[Tau]v"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]v"}], "]"}], "]"}], "+", "3"}], ")"}], 
      "*", "10"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]x2", "=", 
   RowBox[{"logspace", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", "\[Tau]v"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"10", ",", "2"}], "]"}], "+", "4"}], ",", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "2"}], "]"}], "+", "4", "-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]v"}], "]"}]}], ")"}], "]"}], "*", 
      "30"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"\[Tau]x1", ",", "\[Tau]x2"}], "}"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"position", "=", 
    RowBox[{
     RowBox[{"IntegerPart", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "2"}], "]"}], "+", "4", "-", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]v"}], "]"}]}], ")"}], "]"}], "*", "30"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Tau]", "=", 
     RowBox[{"Reverse", "[", 
      RowBox[{"logspace", "[", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "4", ",", "150"}], "]"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]x", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"Range", "[", 
       RowBox[{"0.0001", ",", "89.9", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"89.9", "-", "0.0001"}], ")"}], "/", "30"}]}], "]"}], "]"}],
      "/", "180"}], "*", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1u", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I2u", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1d", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I2d", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1u", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox["1", "2"], ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "*", 
     RowBox[{"Planck", "[", 
      RowBox[{"Es", ",", 
       RowBox[{"temperature", "[", 
        RowBox[{"First", "[", "\[Tau]", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I2u", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox["1", "2"], ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "*", 
     RowBox[{"Planck", "[", 
      RowBox[{"Es", ",", 
       RowBox[{"temperature", "[", 
        RowBox[{"First", "[", "\[Tau]", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1d", "[", 
    RowBox[{"[", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", "1", ",", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I2d", "[", 
     RowBox[{"[", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "]"}], "]"}], "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "give", " ", "the", " ", "initial", " ", "data", " ", "for", " ", "source",
     " ", "function"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Tau]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Tau]1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "1"}], ",", 
   RowBox[{"j", "\[LessEqual]", 
    RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"S1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", "2"], "*", 
         RowBox[{"Planck", "[", 
          RowBox[{"Es", ",", 
           RowBox[{"temperature", "[", 
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"S2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", "2"], "*", 
         RowBox[{"Planck", "[", 
          RowBox[{"Es", ",", 
           RowBox[{"temperature", "[", 
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}]}]}], "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQHc6peiD12BvHui2TwfQ+j6DjILpk54RTYPH3yedA
dMzj+TdB9PJbqk9B9LMyJzCtaqf3CkRvCnIA01/q8+LTgHTHsduJIHpOmc0T
ED3vTQGYfuvekpkBpM3W3M0C0QfWSW8H0ReelO0E0c8usDBnAulF9ZJgelvp
DttsIP1ug7gdiJ6jfOVyAZDW+nsXTK+7X3MLRE+Zpn0HRAt+qPraD6T/39rx
HUR/W8KwdgbI/XfYwLSf1KTJO4G0B9s6MP2mzVt+F5CWUAgH04e6PBgFjr9x
3PFrChOI3nbjvweINqjr8ALR50VaXSWAdMl+Ry8QfebJG2UpIL3ua7s6iA6a
uMZJFkgzBrwA09dOvm8yBdKaB162gGgAxKPQ2Q==
  "],
 CellLabel->"In[32]:=",ExpressionUUID->"dac479d8-99b9-4857-842f-02ffce54d0db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ff1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc11", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc12", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc21", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc22", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]t2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ap1", ",", "Ap2", ",", "Am1", ",", "Am2", ",", "A01", ",", "A02"}], 
      "}"}], "=", 
     RowBox[{"Aint", "[", 
      RowBox[{"Es", ",", "B", ",", 
       RowBox[{"\[Tau]", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"free", "=", 
        RowBox[{"freeopacity", "[", 
         RowBox[{"Es", ",", "B", ",", 
          RowBox[{"\[Tau]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]x", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ff1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"free", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"ff2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"free", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"scatter", "=", 
        RowBox[{"scatteropacity", "[", 
         RowBox[{"Es", ",", "B", ",", 
          RowBox[{"\[Tau]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]x", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "Ap1", ",", "Ap2", ",", "Am1",
           ",", "Am2", ",", "A01", ",", "A02"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc11", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc12", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc21", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc22", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Kappa]t1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"ff1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc11", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc12", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Kappa]t2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"ff2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc21", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc22", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.862115138038172*^9, 3.862115160476248*^9}, {
   3.8621152907759857`*^9, 3.862115296377151*^9}, {3.862115328660122*^9, 
   3.862115373677397*^9}, 3.8621163682830467`*^9, {3.8621166575966043`*^9, 
   3.862116675456362*^9}, {3.862118702061414*^9, 3.862118725051208*^9}, {
   3.862218884000979*^9, 3.86221890574004*^9}, {3.862285473422971*^9, 
   3.862285495742639*^9}, {3.862291275915362*^9, 3.862291280050645*^9}, {
   3.862539628871091*^9, 3.862539631074451*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"c8e58968-f91f-4ee3-a0b6-5085db58a74e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", 
    RowBox[{"k", "\[LessEqual]", "10"}], ",", 
    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"m", "=", "1"}], ",", 
       RowBox[{"m", "\[LessEqual]", 
        RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
       RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"u1", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "=", 
         RowBox[{"2", "*", 
          FractionBox["\[Pi]", "c"], "*", 
          RowBox[{"(", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{"Transpose", "@", 
                 RowBox[{"{", 
                  RowBox[{"\[Theta]x", ",", 
                   RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]x", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I1u", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", 
                    RowBox[{"I1d", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              "t", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"Min", "[", "\[Theta]x", "]"}], ",", 
               RowBox[{"Max", "[", "\[Theta]x", "]"}]}], "}"}]}], "]"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u2", "[", 
          RowBox[{"[", "m", "]"}], "]"}], "=", 
         RowBox[{"2", "*", 
          FractionBox["\[Pi]", "c"], "*", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Transpose", "@", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]x", ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Theta]x", "]"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I2u", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", 
                    RowBox[{"I2d", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Min", "[", "\[Theta]x", "]"}], ",", 
              RowBox[{"Max", "[", "\[Theta]x", "]"}]}], "}"}]}], 
           "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"S1", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"ff1", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t1", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"Planck", "[", 
              RowBox[{"Es", ",", 
               RowBox[{"temperature", "[", 
                RowBox[{"\[Tau]", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "2"]}], "+", 
           
           RowBox[{
            FractionBox[
             RowBox[{"sc11", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t1", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"u1", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"sc12", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t1", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"u2", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"S2", "[", 
           RowBox[{"[", "m", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"ff2", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t2", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"Planck", "[", 
              RowBox[{"Es", ",", 
               RowBox[{"temperature", "[", 
                RowBox[{"\[Tau]", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "2"]}], "+", 
           
           RowBox[{
            FractionBox[
             RowBox[{"sc21", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t2", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"u1", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"sc22", "[", 
              RowBox[{"[", "m", "]"}], "]"}], 
             RowBox[{"\[Kappa]t2", "[", 
              RowBox[{"[", "m", "]"}], "]"}]], "*", 
            FractionBox[
             RowBox[{"c", " ", 
              RowBox[{"u2", "[", 
               RowBox[{"[", "m", "]"}], "]"}]}], 
             RowBox[{"4", " ", "\[Pi]"}]]}]}]}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Theta]", "=", 
         RowBox[{"\[Theta]x", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Mu]", "=", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
         "upward", " ", "integration", " ", "and", " ", "downward", " ", 
          "integration"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"S1", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"ff1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{" ", 
                RowBox[{"\[Kappa]t1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}]], "*", 
              FractionBox[
               RowBox[{"Planck", "[", 
                RowBox[{"Es", ",", 
                 RowBox[{"temperature", "[", 
                  RowBox[{"\[Tau]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "2"]}], 
             "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc11", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc12", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S2", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"ff2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{" ", 
                RowBox[{"\[Kappa]t2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}]], "*", 
              FractionBox[
               RowBox[{"Planck", "[", 
                RowBox[{"Es", ",", 
                 RowBox[{"temperature", "[", 
                  RowBox[{"\[Tau]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "2"]}], 
             "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc21", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc22", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u2", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[Delta]\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"\[Tau]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"\[Tau]", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"I1u", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Delta]\[Tau]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Kappa]t1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Delta]\[Tau]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                    RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], 
                   RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
                RowBox[{"I1u", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "-", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Delta]\[Tau]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                  
                  RowBox[{
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"I2u", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Delta]\[Tau]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Kappa]t2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Delta]\[Tau]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                    RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], 
                   RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
                RowBox[{"I2u", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "-", 
               RowBox[{
                FractionBox[
                 RowBox[{"\[Delta]\[Tau]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                  
                  RowBox[{
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ax", "=", 
            RowBox[{"I1u", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bx", "=", 
            RowBox[{"I2u", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"i1", "=", 
            RowBox[{
             RowBox[{"Length", "[", "\[Tau]", "]"}], "+", "1", "-", "i"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S1", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"ff1", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{" ", 
                RowBox[{"\[Kappa]t1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]], "*", 
              FractionBox[
               RowBox[{"Planck", "[", 
                RowBox[{"Es", ",", 
                 RowBox[{"temperature", "[", 
                  RowBox[{"\[Tau]", "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "]"}]}], "]"}], "2"]}], 
             "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc11", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t1", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc12", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t1", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u2", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"S2", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"ff2", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{" ", 
                RowBox[{"\[Kappa]t2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]], "*", 
              FractionBox[
               RowBox[{"Planck", "[", 
                RowBox[{"Es", ",", 
                 RowBox[{"temperature", "[", 
                  RowBox[{"\[Tau]", "[", 
                   RowBox[{"[", "i1", "]"}], "]"}], "]"}]}], "]"}], "2"]}], 
             "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc21", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t2", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"sc22", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], 
               RowBox[{"\[Kappa]t2", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}]], "*", 
              FractionBox[
               RowBox[{"c", " ", 
                RowBox[{"u2", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}]}], 
               RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[Delta]\[Tau]1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"\[Tau]", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "-", 
             RowBox[{"\[Tau]", "[", 
              RowBox[{"[", 
               RowBox[{"i1", "+", "1"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"I1d", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Delta]\[Tau]1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Kappa]t1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Delta]\[Tau]1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                    RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], 
                   RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
                RowBox[{"I1d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
               
               RowBox[{
                FractionBox[
                 RowBox[{"\[Delta]\[Tau]1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], 
                 RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"I2d", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"1", "+", 
               FractionBox[
                RowBox[{
                 RowBox[{"\[Delta]\[Tau]1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                 RowBox[{"\[Kappa]t2", "[", 
                  RowBox[{"[", 
                   RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Delta]\[Tau]1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                    RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], 
                   RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
                RowBox[{"I2d", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
               
               RowBox[{
                FractionBox[
                 RowBox[{"\[Delta]\[Tau]1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], 
                 RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"S2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ay", "=", 
            RowBox[{"I1d", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"by", "=", 
            RowBox[{"I2d", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "position"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"I1u", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Pjump", "[", 
                  RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                 "ax"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Pjump", "[", 
                    RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}],
                  "*", "bx"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"I2u", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Pjump", "[", 
                  RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                 "bx"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Pjump", "[", 
                    RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}],
                  "*", "ax"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"I1d", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Pjump", "[", 
                  RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                 "ay"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Pjump", "[", 
                    RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}],
                  "*", "by"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"I2d", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Pjump", "[", 
                  RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                 "by"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Pjump", "[", 
                    RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}],
                  "*", "ay"}]}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"I1u", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "ax"}], ";", 
              RowBox[{
               RowBox[{"I2u", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "bx"}], ";", 
              RowBox[{
               RowBox[{"I1d", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", "ay"}], ";", 
              RowBox[{
               RowBox[{"I2d", "[", 
                RowBox[{"[", 
                 RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", "by"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.86211717606938*^9, 3.86211717704187*^9}, {
   3.862118778887952*^9, 3.862118786404895*^9}, {3.862200674204689*^9, 
   3.862200723064382*^9}, {3.862201073869687*^9, 3.8622010832143507`*^9}, {
   3.862201211385579*^9, 3.862201219996892*^9}, 3.862202022613443*^9, {
   3.862202107025631*^9, 3.8622021073236113`*^9}, {3.8622855111535482`*^9, 
   3.862285628133222*^9}, {3.862464010810512*^9, 3.862464045571164*^9}, {
   3.862465118580196*^9, 3.862465141555545*^9}, {3.862465515730858*^9, 
   3.862465556539021*^9}, {3.862465787876522*^9, 3.8624658163764477`*^9}, {
   3.862466351527713*^9, 3.862466387658711*^9}, {3.862466470092944*^9, 
   3.86246648266285*^9}, 3.862466548503352*^9, {3.862467697084566*^9, 
   3.862467698519033*^9}, {3.862476448424714*^9, 3.8624764491107063`*^9}, {
   3.862476490867093*^9, 3.862476492988926*^9}, {3.862478739558859*^9, 
   3.8624787471287527`*^9}, {3.8624810135456333`*^9, 3.862481015783154*^9}, {
   3.862481218762476*^9, 3.8624812274046097`*^9}, {3.86248328186487*^9, 
   3.862483284310398*^9}, {3.862489631038165*^9, 3.862489650185152*^9}, {
   3.8624898655614433`*^9, 3.862489882128085*^9}, {3.862490001496478*^9, 
   3.862490058663912*^9}, {3.8625293695230703`*^9, 3.862529416264266*^9}, {
   3.862540622462933*^9, 3.862540800092957*^9}, {3.862540898066008*^9, 
   3.8625409735722847`*^9}, {3.8625410756469517`*^9, 3.862541095253031*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"741dba48-168c-4222-a15d-8017a21e0164"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"3.4347602502074024`*^10\\\"}], \\\"]\\\"}]\\) is too small to represent \
as a normalized machine number; precision may be lost.\"", 2, 64, 2, 
   24467406112762944239, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.862489722849084*^9, 3.86248989654357*^9, 
  3.862490113986578*^9, 3.862541046792886*^9, 3.8625411513398542`*^9, 
  3.8625480059913807`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[64]:=",ExpressionUUID->"2f4e67da-6949-4ca1-bec3-\
e393fb83587a"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"3.4347602502074024`*^10\\\"}], \\\"]\\\"}]\\) is too small to represent \
as a normalized machine number; precision may be lost.\"", 2, 64, 3, 
   24467406112762944239, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.862489722849084*^9, 3.86248989654357*^9, 
  3.862490113986578*^9, 3.862541046792886*^9, 3.8625411513398542`*^9, 
  3.862548006023467*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[64]:=",ExpressionUUID->"78255641-ab9b-47f5-97da-\
77afdb34e964"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"3.4347602502074024`*^10\\\"}], \\\"]\\\"}]\\) is too small to represent \
as a normalized machine number; precision may be lost.\"", 2, 64, 4, 
   24467406112762944239, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.862489722849084*^9, 3.86248989654357*^9, 
  3.862490113986578*^9, 3.862541046792886*^9, 3.8625411513398542`*^9, 
  3.8625480060447187`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[64]:=",ExpressionUUID->"a7f68e46-19dd-4959-8196-\
514d5b766271"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 64, 5, 24467406112762944239, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.862489722849084*^9, 3.86248989654357*^9, 
  3.862490113986578*^9, 3.862541046792886*^9, 3.8625411513398542`*^9, 
  3.862548006057435*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[64]:=",ExpressionUUID->"9366cb67-fe16-4c1f-90e8-\
25949a6562aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I1u", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.862477553845439*^9, 3.8624775814731283`*^9}, {
   3.862477619731798*^9, 3.862477695480503*^9}, 3.862477783020915*^9, {
   3.8624810501949587`*^9, 3.862481065870566*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"95d85aee-72be-43b3-a80a-b22c2dc4d270"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "18511.479593145625`", ",", "14718.376453952449`", ",", 
   "11116.499166161275`", ",", "9198.7028215778`", ",", "8553.296323984965`", 
   ",", "8945.035161673462`", ",", "9882.400010209818`", ",", 
   "10975.181551295522`", ",", "12023.169760392946`", ",", 
   "12949.802938953362`", ",", "13739.144864414859`", ",", 
   "14400.30855342072`", ",", "14950.505389213109`", ",", 
   "15407.754088569349`", ",", "15788.104630522912`", ",", 
   "16104.833515360886`", ",", "16368.427582406654`", ",", 
   "16586.82457609569`", ",", "16765.675850775988`", ",", 
   "16908.52483367331`", ",", "17016.841172383243`", ",", 
   "17089.851759497018`", ",", "17124.07511296089`", ",", 
   "17112.381144660485`", ",", "17042.214440024676`", ",", 
   "16892.19732559861`", ",", "16625.255961391445`", ",", 
   "16173.22578299502`", ",", "15395.63184442551`", ",", 
   "13915.412555337172`", ",", "7201.995215815746`"}], "}"}]], "Output",
 CellChangeTimes->{{3.862477568539873*^9, 3.862477582032981*^9}, {
   3.862477623396839*^9, 3.862477696196679*^9}, {3.862481052059066*^9, 
   3.8624810663241796`*^9}, 3.8624812949644823`*^9, 3.862483891026601*^9, 
   3.862489784636671*^9, 3.8624899489055367`*^9, 3.8624902848778267`*^9, 
   3.862541215384027*^9, 3.86254806451746*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"a155734a-a610-4a6a-9c48-9db7e2cc9db0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I2u", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.862479213451756*^9, 3.862479251391534*^9}, {
  3.862481073217841*^9, 3.86248107936697*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"60e994fd-2717-43ea-81e0-0a571841f7d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "18515.879781768275`", ",", "15434.719315140086`", ",", "13692.0030574033`",
    ",", "13905.05876495548`", ",", "14171.125016799358`", ",", 
   "13743.0615444301`", ",", "12816.693471795421`", ",", "11704.41445854605`",
    ",", "10593.816339051144`", ",", "9567.764149349547`", ",", 
   "8652.267092072174`", ",", "7847.2644550967425`", ",", 
   "7142.403361021831`", ",", "6524.357482122561`", ",", "5979.952103590384`",
    ",", "5497.331190456738`", ",", "5066.252718140612`", ",", 
   "4678.021192021642`", ",", "4325.28912549022`", ",", "4001.829031273167`", 
   ",", "3702.317418630012`", ",", "3422.1455820228175`", ",", 
   "3157.2615742909074`", ",", "2904.0467475567325`", ",", 
   "2659.2385637098473`", ",", "2419.9392048196414`", ",", 
   "2183.838733779287`", ",", "1950.1146815019401`", ",", 
   "1723.0830456597273`", ",", "1533.3193397634093`", ",", 
   "2242.1457525202018`"}], "}"}]], "Output",
 CellChangeTimes->{{3.862479222497324*^9, 3.862479251984695*^9}, 
   3.862481079882607*^9, 3.862481297868678*^9, 3.862483896916253*^9, 
   3.862489790629202*^9, 3.862489952198249*^9, 3.862490301198339*^9, 
   3.8625412247210197`*^9, 3.862548064555436*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"3f69ace1-8884-407b-99a4-cf38fec7a996"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"\[Theta]x", ",", 
      RowBox[{"I1u", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], ",", 
      RowBox[{"I2u", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<first.dat\>\"", ",", "data"}], "]"}], ";"}]}], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"44c5da45-b0b1-482c-95af-a438ebf7a971"],

Cell[BoxData["\<\"/Users/yonggao/Desktop/paper_calc/X-ray\"\>"], "Output",
 CellChangeTimes->{3.862481147941053*^9, 3.86249036550191*^9, 
  3.86254806463909*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"d118c081-2c5d-41bd-962e-090d5a6b86fe"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1370, 810},
WindowMargins->{{34, Automatic}, {Automatic, 180}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) \
(2020\:5e743\:670813\:65e5)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Report"}, "StandardReport.nb", CharacterEncoding -> 
       "UTF-8"]]], 
   Cell[
    StyleData["Input"], FontSize -> 24], 
   Cell[
    StyleData["Output"], FontSize -> 24], 
   Cell[
    StyleData["Text"], FontSize -> 24]}, 
  WindowMargins -> {{316, Automatic}, {-81, Automatic}}, Visible -> False, 
  FrontEndVersion -> 
  "12.1 for Mac OS X x86 (64-bit) (2020\:5e743\:670813\:65e5)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"11b09b82-8214-49ec-aea7-f7fca90ff1d5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 283, 4, 97, "Title",ExpressionUUID->"85ee1e26-2fae-4e19-98ad-c5d22ed128fd"],
Cell[CellGroupData[{
Cell[888, 30, 281, 4, 69, "Section",ExpressionUUID->"1409faf0-fa3b-48b9-b0fe-28cdb8fefba3"],
Cell[1172, 36, 5022, 157, 1127, "Input",ExpressionUUID->"a36d15ba-8ec5-4d46-843a-f18f6d2fab97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6231, 198, 166, 3, 69, "Section",ExpressionUUID->"01ed5fe8-1806-4689-902c-6ccdd2a3b8df"],
Cell[CellGroupData[{
Cell[6422, 205, 3656, 87, 885, "Input",ExpressionUUID->"c532bf20-f6b3-406c-9708-12145a47ac2b"],
Cell[10081, 294, 12761, 260, 532, "Output",ExpressionUUID->"0c2aee2b-72b3-4fc9-83fe-a08c13b4bf30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22879, 559, 212, 3, 55, "Input",ExpressionUUID->"0ddc5fc2-881e-4e13-95f9-9e5f8d6565d8"],
Cell[23094, 564, 243, 4, 55, "Output",ExpressionUUID->"434e4965-7509-4f0a-b9d9-69dbe2fd82a5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23386, 574, 159, 3, 69, "Section",ExpressionUUID->"e66a0de1-3c1c-49b8-83a7-4953f4343738"],
Cell[23548, 579, 24992, 652, 5398, "Input",ExpressionUUID->"0c32b016-d668-47dd-b836-94deef2c4550"],
Cell[48543, 1233, 39093, 1043, 6884, "Input",ExpressionUUID->"b31cc2f8-e8a2-4e8c-92c4-e986fc8dfa24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87673, 2281, 164, 3, 69, "Section",ExpressionUUID->"750a1e48-a2d7-415c-91e7-b6eab27e8bb3"],
Cell[87840, 2286, 25108, 671, 4958, "Input",ExpressionUUID->"441ad3d1-55e4-45f4-b2c4-36afd192e5bf"],
Cell[112951, 2959, 26321, 714, 5484, "Input",ExpressionUUID->"e0a3b7db-d3d8-4b8b-8200-daca4cb5096d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139309, 3678, 161, 3, 69, "Section",ExpressionUUID->"6670b494-a3c8-4fb5-a991-dce31b98d1ed"],
Cell[139473, 3683, 8343, 227, 2054, "Input",ExpressionUUID->"22914adb-9b21-4244-8aa6-4c18220b252f"],
Cell[CellGroupData[{
Cell[147841, 3914, 488, 11, 84, "Input",ExpressionUUID->"a547c8d1-d15f-4623-849d-4420102a2f66"],
Cell[148332, 3927, 658, 13, 31, "Message",ExpressionUUID->"d7c0004f-4763-4b09-b6d6-8725645729de"],
Cell[148993, 3942, 13500, 242, 246, "Output",ExpressionUUID->"a6764698-2f64-413b-8ce2-d1503aecf2de"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[162542, 4190, 164, 3, 69, "Section",ExpressionUUID->"915f5a80-a629-4723-82a6-1bdb230f2708"],
Cell[162709, 4195, 8237, 248, 1915, "Input",ExpressionUUID->"dac479d8-99b9-4857-842f-02ffce54d0db"],
Cell[170949, 4445, 6649, 183, 1114, "Input",ExpressionUUID->"c8e58968-f91f-4ee3-a0b6-5085db58a74e"],
Cell[CellGroupData[{
Cell[177623, 4632, 30756, 752, 3742, "Input",ExpressionUUID->"741dba48-168c-4222-a15d-8017a21e0164"],
Cell[208382, 5386, 612, 13, 31, "Message",ExpressionUUID->"2f4e67da-6949-4ca1-bec3-e393fb83587a"],
Cell[208997, 5401, 610, 13, 31, "Message",ExpressionUUID->"78255641-ab9b-47f5-97da-77afdb34e964"],
Cell[209610, 5416, 612, 13, 31, "Message",ExpressionUUID->"a7f68e46-19dd-4959-8196-514d5b766271"],
Cell[210225, 5431, 572, 12, 24, "Message",ExpressionUUID->"9366cb67-fe16-4c1f-90e8-25949a6562aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210834, 5448, 369, 7, 55, "Input",ExpressionUUID->"95d85aee-72be-43b3-a80a-b22c2dc4d270"],
Cell[211206, 5457, 1380, 23, 170, "Output",ExpressionUUID->"a155734a-a610-4a6a-9c48-9db7e2cc9db0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212623, 5485, 291, 6, 55, "Input",ExpressionUUID->"60e994fd-2717-43ea-81e0-0a571841f7d1"],
Cell[212917, 5493, 1292, 21, 170, "Output",ExpressionUUID->"3f69ace1-8884-407b-99a4-cf38fec7a996"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214246, 5519, 653, 18, 208, "Input",ExpressionUUID->"44c5da45-b0b1-482c-95af-a438ebf7a971"],
Cell[214902, 5539, 240, 3, 55, "Output",ExpressionUUID->"d118c081-2c5d-41bd-962e-090d5a6b86fe"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

