(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    217168,       5728]
NotebookOptionsPosition[    211771,       5622]
NotebookOutlinePosition[    212697,       5654]
CellTagsIndexPosition[    212654,       5651]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["grid and integration ", "Title",
 CellChangeTimes->{{3.861949729115543*^9, 3.8619497555245047`*^9}, {
  3.862013358777443*^9, 3.862013370505025*^9}, {3.862110010914356*^9, 
  3.862110027031199*^9}},
 TextAlignment->Center,ExpressionUUID->"85ee1e26-2fae-4e19-98ad-c5d22ed128fd"],

Cell[CellGroupData[{

Cell["1. Global constants and basic functions", "Section",
 CellChangeTimes->{{3.8619497826752243`*^9, 3.861949792911045*^9}, {
  3.861950789185286*^9, 3.861950796134797*^9}, {3.862110038365808*^9, 
  3.862110045210286*^9}},ExpressionUUID->"1409faf0-fa3b-48b9-b0fe-\
28cdb8fefba3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hbar", "=", 
   RowBox[{"1.0545718176461565", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "27"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", "=", 
   RowBox[{"4.803204712570263", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "10"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"me", "=", 
   RowBox[{"9.1093837015", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "28"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mp", "=", 
   RowBox[{"1.67262192369", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "24"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", "1"}], ";", 
  RowBox[{"Z", "=", "1"}], ";", 
  RowBox[{"Ye", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kb", "=", 
   RowBox[{"1.380649", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "16"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kev2erg", "=", 
   RowBox[{"1.6021766339999998", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", "29979245800.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]T", "=", 
   RowBox[{"8", "*", 
    FractionBox["\[Pi]", "3"], "*", 
    FractionBox[
     SuperscriptBox["e", "4"], 
     RowBox[{
      SuperscriptBox["c", "4"], " ", 
      SuperscriptBox["me", "2"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]T", "=", 
   FractionBox["\[Sigma]T", "mp"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"6.674299999999999", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "8"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Ms", "=", 
   RowBox[{"1.988409870698051", "*", 
    RowBox[{"10", "^", "33"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"km", "=", 
   SuperscriptBox["10", "5"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]F", "=", 
   FractionBox[
    SuperscriptBox["e", "2"], 
    RowBox[{"hbar", " ", "c"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BQ", "=", 
   RowBox[{
    SuperscriptBox["me", "2"], "*", 
    RowBox[{
     RowBox[{
      SuperscriptBox["c", "3"], "/", "e"}], "/", "hbar"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"10.0", "^", 
    RowBox[{"Range", "[", 
     RowBox[{"a", ",", "b", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"linearspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Range", "[", 
    RowBox[{"a", ",", "b", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", "-", "a"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C0", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "a"}], "-", 
    RowBox[{
     RowBox[{"Exp", "[", "a", "]"}], "*", 
     RowBox[{"ExpIntegralE", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"C1", "[", "a_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "a"}], ")"}], "*", 
     RowBox[{"Exp", "[", "a", "]"}], "*", 
     RowBox[{"ExpIntegralE", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radian", "[", "x_", "]"}], ":=", 
   RowBox[{
    FractionBox["x", "180"], "*", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Planck", "[", 
    RowBox[{"Es_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"2", "*", "hbar", "*", "2", "*", "\[Pi]", "*", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Es", "*", 
        RowBox[{
         RowBox[{
          RowBox[{"kev2erg", "/", "hbar"}], "/", "2"}], "/", "\[Pi]"}]}], 
       ")"}], "^", "3"}], "/", 
     RowBox[{"c", "^", "2"}]}], "*", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Es", "*", "kev2erg"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}]}], "]"}], "-", "1"}], ")"}]}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.86195011325911*^9, 3.861950161810429*^9}, {
  3.861950226622788*^9, 3.8619502705418053`*^9}, {3.861950450560298*^9, 
  3.86195050074433*^9}, {3.861950692125059*^9, 3.8619507100833673`*^9}, {
  3.861950761050561*^9, 3.861950765426078*^9}, {3.861961074401415*^9, 
  3.861961076247954*^9}, {3.862022828791157*^9, 3.8620228294910097`*^9}, {
  3.8621100714817133`*^9, 3.862110072547246*^9}, {3.862110711005892*^9, 
  3.862110711904375*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"a36d15ba-8ec5-4d46-843a-f18f6d2fab97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temperature profile", "Section",
 CellChangeTimes->{{3.8620163980057573`*^9, 
  3.862016401340963*^9}},ExpressionUUID->"01ed5fe8-1806-4689-902c-\
6ccdd2a3b8df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"temperature", "[", "\[Tau]_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Tau]mid", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Tau]mid", "=", "0.683"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a1", "=", "0.00828"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a2", "=", " ", "0.0614"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a3", "=", 
       RowBox[{"-", "0.304"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a4", "=", "0.266"}], ";", "\[IndentingNewLine]", 
      RowBox[{"a5", "=", " ", 
       RowBox[{"-", "0.0719"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a6", "=", "0.00652"}], ";", "\[IndentingNewLine]", 
      RowBox[{"b3", "=", 
       RowBox[{"-", "0.313"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b4", "=", 
       RowBox[{"\[Minus]", "0.374"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b5", "=", 
       RowBox[{"\[Minus]", "0.612"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b6", "=", 
       RowBox[{"\[Minus]", "0.0234"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"temperature", "[", "\[Tau]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Tau]", ",", "0.001", ",", 
     SuperscriptBox["10", "4"]}], "}"}], ",", 
   RowBox[{"Background", "\[Rule]", "White"}], ",", 
   RowBox[{"PlotTheme", "->", "\"\<Monochrome\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.862110292583253*^9, {3.8624550664402857`*^9, 3.8624551582894583`*^9}, {
   3.8624552005910463`*^9, 3.862455228690687*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"c532bf20-f6b3-406c-9708-12145a47ac2b"],

Cell[BoxData[
 GraphicsBox[{{{{}, {}, 
     TagBox[
      {GrayLevel[0], AbsoluteThickness[1.6], Opacity[1.], Dashing[{}], 
       CapForm["Butt"], LineBox[CompressedData["
1:eJwV1Xk0ldsbB3DOMU9n4oaTeTzvWypp1OVRUYkGShElkakMyXAdFLnuDSkk
yVAypkijktq7kFuhDEUU0aGocBBl/L2/P/ba67P2Wt+1nmc9az9abv52HjQR
EZHH1Pn/XdADh/yKFXGZ4gK+p4Iydop6uOVQsCLeN5tltqNVES+2W9ya38zB
5/xlT31NlcDOmsJurQYOXlWX6Ks+KY7jh+5+y6nj4Jlc8n6Pkzj+Gr+OnlFF
WTJBk6ErhvOrtxqfKeRgHxOpP2aqRLHqCp9zweEcnHZ5s2MJawpJKBfZWGlz
cFdwuvik8ie0ot9nb/VCDi5OU40RtnQi97tG7rCAg20rzCXlw9vQ0x33+Wvl
qPdFDhyxggYUcbq2xGiCjZXW+B9UPXDVfHTqs9SCl2wcwRrhswQ95t0fNWu/
BLLxZv6jq/TxX+bGmzYmRh1h44sdiYWhX36bx5V72it5snF4pWIQrWPK3OhU
Wc96ZzYey3lRub9qxjzCcN1cthWVZ3VeT8tUBFSD9qzaxWXjIr2wxMxuOjhI
JV3DNSx8IkZRYqhVBkoCbwXsQSx8Ic40Mg9kYa6jddXQQxa+75Ea8+O6LBSU
cp9zb7Lwn6XReyBaDsbtrvWGZLCwtqsLfUBfAZKza7iL/ai8lz7H1t9kQr3x
9JmMBSwsES2zxhdzgPEj2O8Mm4VnG8suFHzngF3RyLZoeRam6VrI3lNWhHZu
P8ObzsJtdUnX7AMUQSDWlLx6mInb+i68SlFTgpl3hWltz5k4s8mPuSzgD1jE
t8tWCmHisIfyFjcnlMF/RUOkdCATL7xxyvaZmgrcHt60f9aXiV+K0AWlG1Vg
tfufGn0HmdjUageXkaICG20Nc+/aMvGGVWWFM4QqOGvM5dvrMfFeMYlbmbu5
oPyPvaPONQaekXbrzEtSgydOPJVlOQxsEkOb7r6jBh5G8+1mqQz8cgJlC9vV
4Pbbkr1OkQwcu5kjTNNWh626tL3JOxn4vI3ckf476hD1tNxh/rcC1g+vCqpu
1IC+afldndYKuP6jaqnhmCYkvv7MGTBXwCtq3NPM6FpgnPewZcJEAS/90WVp
wdGCKGsPe7aGAn62ssBMfrkWKGdU2W0Zk8ddZ4Y2Pw3UApuVvjsrMuUx3cQo
rOibFtwO+G9b6nc5zI/QRe1N2rCq38ZiX68ctv6dk/+oSxuq9jUt12mXw3qP
3cPOftOG51Ydyneq5bBkVCNXRlwHOhZ+722+JIedqqeKbFbpAO0FI5S9RQ5v
WLEpmJWhAzu19lxOLpDF3ZGhX3/s1IV3FzqTHTNlsZN31i9xF11wknON1UqW
xSVGwmCmly64T3p534qQxSub/+ufidSFsIbw5U32slijLLzf5JouXPkrp45J
k8VaDbFh5KwujDT1DZ/dL4MPtXShmEw9QJE8x4RdMvjG9TaZ1/l6kMQ7+izO
WgZnt74oYpTpARk9fj5ypQz+fM1C1A/rweGl9LW+CjKYX6+8+4pADz4macZa
PZHGfK8jcQJCH15u3ac8qyaN12R02Rnf1IeMyZzoXxxpfEFb/N7CCn3wyusd
HJOmnP28dOaJPkhMez8e/CmFbwZGxWc36oNFSZhbe4MUrhqPpLv/0IcHUhdu
3ImUwrpimeFyPAMoqH0DPh8l8dbLxtUKGQZw/s14cUKzJO7W0Xuz/YoBxHYq
s0rrJPFK5T6xuCIDcBO69gzfksRDHjyl5nsGoK4mjA6Ok8R3znarDjYZwMXj
rOqTSyTxgdH7EzpShpCoY2eZHi2BdzZ3/sU4agh8o5DSByESODpIZFI2yBB8
1lxS6vCVwMUxETLzYYawZXtv30IHCawxkK75ItYQJPjH4q4SErj8dsW6oUxD
ONmcUlfaIo4rp388/Ps/Qzge3bKlRk8c/8j8cNGEy4P1RoWCy1xxnL7grzW1
Gjxgdoad4LPE8asd719v0+XBdRP1e8azYtg/W2HeZjEPer94aea2imFa/65t
E2Y82LltbiLylBgOOTDeRj/IAyMuL39VDx0veTf4Yv0VHszUTZtx2ug43dSh
RTSfBy+PN74fqqfjE+k6zZVFPPBoDGIUPqBjr6boRtWbPMiKfhKueI6OAwf5
6amPeSDz1X6n0IyOr38Qofu/58GXu1FzJVk0/DlQfUJEnoB3eNnFG8k0HCc4
4L6NSUBNvWBZWRwNe3rbNqZxCLgisPa4FUDDlzd0PmCrErBXcUF9xUYaNns7
/qlWn4CXQTczar6LUv+BmIGKOQEPTrgtf95D7YWxBH+Z9QQUJig11L0Txa+z
TMwnNhJwKo8v8gqL4oef69IeWxOwrmWTZ9N5UWyrFCkr50BAmfEnk651opjP
DHa56UtAlllqY/cyUXznnpGorR8B8dZWXj36ojiEaVreF0CAp9uNTAFTFBfX
7t0hFUKAZkoY7ZtABCe1eoZyThKQLGS+mUwUwcKCSrPNqQQMuJ56p105j3Ry
76ofvE+AU5/nZGL+PBJveJvi8YCqx9tGeTJpHuWlVfAOVxJQckzJ6dWheZTj
ktKx7wkBPrFFH4Pk59Hxlgma6nMCBoteCWpc51D6LhviSyuVt6hcfMnWORTx
XKOn/B2VV35eP2PFHFo+INAObafyHrp4HZWZQ80GLq6/OwnwfTX8TenuLHqi
sTjwbS8B34c4Y4clZ9G+wIyNwmECnIN+cZqEM4h7biYxTkhA/eQHE9MPM2gz
J/6p8hgBN0QKQxi3ZlCCVqSEyQQBR9mrpyqcZlBfVFGu1QwBQyucRaXLptEl
I5ZSjyQJIxH5jOu7ppDw9aE/WWokqFn2p52GKbRYXj56jToJ1vKGC70WTaH7
6UOlBzRIKMi+bqgnNoViOo62FGiR4PTktsXlO7/RB+d7VSr6JNTM46BU9m/U
6uQVmGdEwsWYj238N5Po749+SXvNSKi11tjvVDWJ5owVnS3NSRhlHxSsLp5E
Kk+Xn14KJNjmCUZ+nphEDj7rGLT1JNBqvkkHLJlELO5j/RRLEo6IT5m6J02g
R1PY3tuGBPN//7hiY/MTOSoOSEg7klCmoKIbuvIniiX/G2ijvDCNW5yr+RMx
Cix3FTiR8CtXs3xifBwlbM9qMHUmofwRga9kj6OHh8+U7TlAguaw2afxoTE0
LNcxYetBgqiDp2Z28ig6cUk6ZEsACQEfvPPr+KMo44SG5TDlLrcjhqMeoygh
mPs7NZCESv/ApZvWjiLjrx4qHcdIOHaaD8JeIUqIF0Y4BpPQW3XW1dJEiH63
Z1Trh5Pwz6YAi87SYZTX92iH9Ckqr3OJosrfw0jt7FBvHGWTgOF+B+dhhOxC
79JjSfh00S+xWWYYqfcZqU5TXjt4pO2F5xDSWn6A0RNHwlCi99EHWj9Q+LMN
cfHxJOxqdstISxtElll3zjsmk1ByWPtIy5FBZOg22IUpi073mLE2DiInYMQY
pFD90zkoSBwdQLXuqHWUsmTwgSWx2weQzdbie9HnqfoWONcek/6K9iSL555M
J0HLZbdwe2QfUvQ4WkHPJmHq6AWkt7MPeSv/3O1CuTmq7cy0bh9Kpt1edp9y
zBVHoqhegFxeDOZ45FD9+OxyaI4rQImhuy0eXSbhqs/htzcqe5FEzgjL4ioJ
4fyivJikXtTWWbcmibJd4tfAvW69KE3xWGoHZVqZj4KYTC86LWnaHpBHUvvB
b9M+xx4UmJVzOjWfBKuRoWOckW6U1eZ7oryQhAlWIAOld6OIJLW1I5QLl49d
9zHvRvaN19hLikiQCJ0UPE3qQk2P9BaUUK6bnXcIWPwRuVolQ1oxCWEaMWPc
tx/Qs6drHjdQNrQQO1cX8QGtX33KWvwaCf/GSr1Qr+9EcfEVZwMpb5ZlmTb4
dKAat/GzZiXU/C1KbQtjdyA39lIXf8rF25SO61a+R0q5ReRlylIpKqV86ffI
N2C0eppyf86rs3WV7Yh0XXpP5zoJ/wPeJ56c
        "]], LineBox[CompressedData["
1:eJwd13c4lt0fAPDHY2ZH5DXCU6Eeq0GSOl/jJREqeiXKSAORkciI0rKy06K0
vNkSJdxkZGVUShnJqt6sJJvn9/X7674+131f51znnO84t7yjx15nOo1GW8lG
oy09aWsvPrAVaafq1t/28s1ggp/2g5dt5h8pa+3Cs61oJVsF69CpD1TzPblt
M+grqetj2w0/UIaM641/ZzLBWGET++WB99Tb6Xy7d+ids9lWTdHvqbBinfrf
aMOm9eliWu8p9W5Tc9EsJhj4MnY/CH9HVRm3pJuj9XelpP7c9I6a1lwX4obW
WyU5vrHrLWXQ+u70FTTULL9eofaWUuD8UlGKJjejfvB8aqVOVcpIfUTvcF+m
Y3G+lSrxc0keReuIs33tft9CHar/wrEqmwnujT1W07+bqKnvfY2n0G4+7bOX
DJsoqk7P/QLaRbolVezGG+qr19yORLSzG/Vj445Git1Z0KcQ7biiKLoipoEq
C1XvqEbbl2RvsuirpxoFdc68R9vypwSdvFJHnZ9L2DeKtilIZMx/rqXam9KS
5tDWtlGvw1VqKYdZyRXcOUzYz3HR7a+Q19Ss68E3y9GWmYHL09/WUJUKFZVS
6L2WPoWaa2soR/306TVoi3nXg9VnqikYcz2pgjZ74ESzrK+iWj2PrtZAm5ge
fNgrXUU1M35J6aB3Tuzd5elRSQX7HLHWQxve3jXKqnhFjYys/GyENjDQS4he
8YrS2uCYZorWG9q6VeZYBVX5KznfAg0JG7ozXpRTFxeF+S3RO3TWXdDmL6fI
9lW5+9F+tboWcaVlVE2G6F1rtLfEhps5jqUU2Ot3HUC7H5frb+QuoRyuLh63
Qbs8F1L9L7OYeuaeaLDkozysM9x7X1CfT/3jufS9o/VIxZqpIqpqWfzYP+hD
6V18ercLqYXGxEor9IHpRqvDus+o78cyf+5d2q+dJamBg08p1j2Gi/nS/iRn
/LgRkU9J2OmDCdr0+81NRep5VFqitYchOvrUirn0jBzqu2PGNKAvCf+O7vuT
SVlOXejSRgfltjJWwRMq++462c1oH4vcQuvwx9TB2t4yZbTrWPSu+PcPqPu/
J0qXzuOpfXK/8NsUimdK44sIOu2uFf+lozco+2M/2ZehY3pENs/NxlPG/NxR
i3j+7eWS3A1G5ykZJ5/Wb+h3dCubtlcnKa+kv691oH3mQpvpmw6SbLbAwib0
MzJXHLHiKiluFDB8in5wyuNQUXIsUUsdzXm4FM+6Dl+UHicRlYMzN6+jQz3T
xjgd7xL+ZSHT/ugVopfGvwc/IbH2YsNaaP+5xXx5riwyZjoZoIju7jvjbROV
Qw6098eLoS0/b54d2J1PrFa2Oo5h/shkKAT8Y1tE+I4JJN9FW8g6dfxOfU6U
pC+HR6DPx6dui+l7QYpH6gR80YMBEvO1LiWEa0tgvTHaWuHijjsl5UTnveKW
Icx/xpQvJdhQTfZOSufKoLdtSBztdKsh/mb75ehoS9enshmCr0lqxF71Qawv
l7+MnjPaW0vI1W2bstBDr49DyKd6Enpar1sT/SzZpuLXt2YyvC8tbusTJqyR
SXVwobcR7emdqfR0JqjoZpyXt2kjh4xyoj49ZoKmc9H99rw2kia8yMxFG2c1
Dxg6fCDih5MCbdHu22kuq8s/kux1JhF5j5jw3M7BqzPoMxkWqNpp9pAJu1NW
XzCb+ULMJq8eO5DGhJdClnv/8hsger6bkoZuMWFfvmZ1fcEoSRr53OB6jQmF
Tpy5o52jxKyJIaeDjuR12R1OHyO2q9wj+NGjL7W0ctaPkaajCv9mReN6Vn0Q
mDk7RuwCHgj9imKCbr/wi0ipX4TOd2QuMBLj3+OSUIHtOHkpM/068yoTeGuH
w2pOjRP6N+/JEHSJnNVse9g4UQ5+bmKFln27emAhc5zcjfJ2W7zChIHNFcVG
C+Pk2Pqz8XvRnrNzzh13fpOUBP9O+mUmXL3oWUL/MkHm15w/eimMCbOyEpvr
JiYI06NNyA7tUlyWcY33D+HtlJzahDYd5bslrfmHWORfDu29wATBA4/8NaP+
ECd98QQ9dIJyh6bLtkmilLRPVug8Ezheh2ar75kkGjPNfT9CmXDaQUlh6ugk
MfFljFSh9yedFguLmySfgpQ/BKD/oglP3PkxSeLq+mnDIUxIeWeQ13p9iuzR
OaDYdY4JQu4/lZKzpkhIU1BICTqEJ+7uocopQrGKFW6jHbZ/ufZzZIpkbtK2
tUWveezvzmk4TdgNDM/0BDPh37PZzK0T06Tc83jDVBATJMWs7rOWzZBIyxKl
TnR4zpxkjewMyV3e9Kkc7da/k3efyQyxM6O0ItCqZn3f3dJmyOMPVROr0QXy
Eo/uWswSp531xc6BTDju5/B8/MgsIQybOQu0VPOTegP/WXJkuXi4Dvp84PbR
7/dmicgOnfgVaIuPjlobfs+Sgnhz29oA3C/VzF0XuOdI27iFeCG6KOyPbZvU
HLn112u5B+hVG6+E+hvg+1oVpVD0cGRWfUXiHOlOj+Eh6Lt9k52iT+ZI/+5v
u9XQltow6lw2Rx5FfBmQRZd8eyvK+22OnOWuFKSjw/WmbfdqzZPvgfdM6s9i
vb+h6/HAdJ7Qj+9TKUX/Gg0PnbSfJ91bnzvloq3vyDy6eXWe2DJuNV9HK0zr
jfZ+nifWZvlPXNCfzSLZNEbnybPc/7Ts0VEP20Qvsy+QMUajzH70xN7jWkzl
BcK9J2hID53+b96uIFggtdHVH7aiD9LmbJstF0hUz2OJDehXWVGh3kEL5Lq6
4gM5tC/Hx/jq2AXSYLd1RAK97qDco5WPFojuQnPMcnQMz9P6l00LJNH5VA87
2uDwfKdA3wLZIzwUteDPhKlnf48enlogLr+aE6bQh5zaRTnkFonx9ZycIbRI
sbzC/s2LpGzyr6pv6GphV630nYvE7FXdxj6037GCXbO2iyRC789cN1q5bMHW
1HORCFq/le1A96ww8ki5uEjuBSSlfETHu8aEjt1YJKfLfP3eow1ffYrXy8bx
6h9ntaJnJVY/Sni1SHK/2u1oRmd7uD0f/LBIhHsa179BO9Q8q9f6uUi4tJW8
G9ArZFid4axF4ruQtrIeXeu9c7RTlEWqWj0k6tCB9bFsakosQp8uP12LVpfv
EA3VYRFpk1q1JfefWaPwzoJFBKDIcMnXm05qrXVmEZ7BsuIl8x6bNGUGsEiW
2ad7/x+PFeywIZZFYk9XTy7NN3qd23fLYxbx0il/0Yh2VI8J317KItkznD+b
0O9rJVL137FIpN/b8KX1GTnce2r8g0UuzNjfWFp/8cy6WnMWiwRtHBJvR4sb
Hxh5wksDefNs9k60ReKd6SwxGkj96jncg7769Ss9T44GNuqlzAH0KxUFgQIm
DRxvBRz7Dz3v77KySJMGl7dYio6hNWqy5Yt1abA9NFhtEu0u8ptZakqDA24b
SubRX58EQKUjDR6Z8irxYXxITlG7ak7SYDDkFrco2lKfw6rOjwZb2iKspdA1
HZEnmqNpkBhuY66Cpim1er+9QYOqsdQ/muitPmLBbQ9o0BYqIqiLzuRPieso
psHxE0ZJS/E+aN17u7uaBsPxblyOaNmHCo+/tuB8sWE/TqLjtue8/DZIg65J
02WX0Wfcy/t/i7AB35hDQRk6t5hjdFKGDeIG9SveoP/jMp6ZUWIDB/kIvS60
bWqrAI2wgUDHdNoCWq+lV5PflQ3y5Nh69DG/A6QVdYV82cA9tjxhP7rguKuJ
SCgbxLBtoU6gFdkmDktcZ4N1Ct9Px6L5N3JeXVPJBjlHb7oPog2DjeMVm9iA
Tizb5tHn6qPurP/EBn/SJ/NFsX6NO4rnq4+yAYkKe6eH/hiv2KEjRQet6ISs
R+i0P8YqVt50EJp16Q3DehnH11y+JpgOUo8ztNPQofKWlhNX6CBm6M+9VG/t
dx8KiE+hg2fRWtY8etVDr7rWOjr4GsafCMT6fdPylrOZHDtI7WshsVjfw13k
ZmSY7BCW7T70DO0f8jByWIMdekqEhTrQ1pk5TyNN2KEpLLtQAfuJOEcVW4Mv
O4iNH4qtRMc9Hbpj9IYdLmunXRDFfnW+znPDynZ2mG9tSSZozy+TVYO97DAR
yr/WDW3BxzZ0cZodjv3uTqtBCzqJaVet5oBlD/U1QrH/hYvs+ABnOUBUaV8Z
/0Ucz/OaoLYiJ9z3LE0Kwv4bP+DsYb6BEz4KX0krQD84oNNyZBsnuDDuiw+h
a3R/xF4z5wTt0oYttkv9XkRfbOAMJ3zL6LbTDWdCbP6kVEwtJxRFd2yRxfvB
3d926wZPcIHqAo1vXQwT8o5tDp/z5oJhUxHpk+hXHbw/hYO5wMx1IiEP3V9Z
lLktjgumPvOUbYvF/7uE5eqxxVzQtd5nyDKOCTmbqzV1+LhB69bFvJsJTCg7
rWwQl8kNBdsTrnjfwPoUzngUWsQNyeeMDzSgU1MleDxfcUOr94601TexH9dx
NJq3c0O5QtztNrSeTNc+AQ4ekO71Uye3cX1VUU5XDvLAieqRcqVUJjSJjp4P
5l0GDN7XLZZ43/qSl1fhcpwXTHhO8fA+ZcLYmpmxVC9eYBpm6Z5B05NBri2Q
F1xkhzv70QrBzcEklhfU941pVRRgvu8a3raimBc2yx28EFzIhMVepcJSPj4Y
lWzU5yvGeFpx94lwDh8E5In6u1Vg/vhGxxf+4Yejg8To71YmOKXfebbGVwgc
nA189Cdwf67WX7sqvhx+ikbnH5FVht30cfdiGxFQF5Kj4kyUwfm6gBezWBRO
CF8qzwhWhidjlrL76WJwonx64+FcZSgIeTax3EAcWjQ5VvL2KkOeMu+IwL2V
cEN43yy3hAp03g6PrRyUgMC1SesbjFVgVoll/cJIEi6kOD1xDVaBrp+ROyFN
CnZLi64+lasCI16GvSED0tBq7FiV2qUCv8QmUtkMVsGtXxqdxwVUgRH0hlsn
QhbCA+3/S9+qCpECPQ3sR+Wg7Eak5CdnVQhxefdw2Qp5CNuT6H8hWRUi/u20
dCuUhxT1/K3JjarwfcDERfeFPHT/yt5/7Y0qGDBenhMvkYd8c0Huy02qsHjz
xpPyCnlIY1ut4NeiCl6R+2lib+ThSrBUgMN7VbDxaMko7ZMHwfiVHns6VWGd
RhVdaDkDToUcUcweUoVLnpsk+kUZcP9lZ+2LYVXozUpTeSHOgJBjk3I1I6pw
WyHU2kmaAbyahTM9Y6ogLLEju0iRAf/pb3GX/aMK07NFB+x3MEC65Zdb+YIq
WG1R9NDQZYBR+Dau9kVVyPdOCuM1YIBGn9aJMZYquA355BQYM8DknEbsaroa
9HRt4FxmxYDPnlREPJcabJe8J9n9DwNsDJQS87jV4OZ+YfWnNgwYfKbs1cKj
BpbNIzZ29gyw8xLKFOZTgzy+Q6c2OjHgWak330Z+NRDc+eYi91EGxPx7Tt9S
QA1cwnRudR5nwNALP6szgmrwujwjN8+VAUU+D/VuCanB/wBpnfLw
        "]]},
      Annotation[#, 
       "Charting`Private`Tag$4876570#1"]& ], {}}, {{}, {}}, {{}, {}}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-6.907755278982137, -6.014066623004664},
  AxesStyle->GrayLevel[0],
  Background->GrayLevel[1],
  BaseStyle->GrayLevel[0],
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Exp[
       Part[#, 1]], 
      Exp[
       Part[#, 2]]}& ), "CopiedValueFunction" -> ({
      Exp[
       Part[#, 1]], 
      Exp[
       Part[#, 2]]}& )},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->GrayLevel[0],
  FrameTicks->{{Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
     Charting`ScaledFrameTicks[{Log, Exp}]}, {Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , 
     Charting`ScaledFrameTicks[{Log, Exp}]}},
  FrameTicksStyle->GrayLevel[0],
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0], 
    AbsoluteThickness[1], 
    AbsoluteDashing[{1, 2}]],
  ImagePadding->All,
  ImageSize->{838.00390625, Automatic},
  LabelStyle->{FontFamily -> "Helvetica", 
    GrayLevel[0]},
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->NCache[{{-6.907755278982137, 
      Log[10000]}, {-6.014066623004664, 
     15.530481417367225`}}, {{-6.907755278982137, 
    9.210340371976184}, {-6.014066623004664, 15.530481417367225`}}],
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 6}]]& , Quiet[
      Charting`ScaledTicks[{Log, Exp}][#, #2, {6, 
       6}]]& }, {{{-6.907755278982137, 
       FormBox["0.001`", TraditionalForm], {0.01, 0.}}, {-2.3025850929940455`, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.100\"", 0.1, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 3}]& ], TraditionalForm], {0.01, 0.}}, {
      2.302585092994046, 
       FormBox["10", TraditionalForm], {0.01, 0.}}, {6.907755278982137, 
       FormBox["1000", TraditionalForm], {0.01, 0.}}, {-4.605170185988091, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      4.605170185988092, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.210340371976184, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.512925464970229`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.608235644774552`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      11.695247021764184`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}, {{-2.3025850929940455`, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.1\"", 0.1, AutoDelete -> True], NumberForm[#, {
           DirectedInfinity[1], 1}]& ], TraditionalForm], {0.01, 0.}}, {
      4.605170185988092, 
       FormBox["100", TraditionalForm], {0.01, 0.}}, {11.512925464970229`, 
       FormBox[
        TemplateBox[{"10", "5"}, "Superscript", SyntaxForm -> SuperscriptBox],
         TraditionalForm], {0.01, 0.}}, {-9.210340371976182, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-6.907755278982137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-4.605170185988091, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {0., 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      2.302585092994046, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      6.907755278982137, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      9.210340371976184, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      13.815510557964274`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      16.11809565095832, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.420680743952367`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.51599092375669, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.60300230074632, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.683045008419857`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.75715298057358, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.82614585206053, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.890684373198102`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      18.951308995014536`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}, {
      19.008467408854486`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 0.}}}}],
  TicksStyle->GrayLevel[0]]], "Output",
 CellChangeTimes->{3.862016561060396*^9, 3.862022834627824*^9, 
  3.862024180879179*^9, 3.8620242392526817`*^9, 3.862024374373705*^9, 
  3.862110297248711*^9, 3.862110343314375*^9, 3.862110717315637*^9, 
  3.862112709690319*^9, 3.8621128887815657`*^9, 3.862114628829155*^9, 
  3.8621154565154543`*^9, 3.862115592514832*^9, 3.8621159599116983`*^9, 
  3.8621163990147133`*^9, 3.862136449741943*^9, 3.8622001109243507`*^9, 
  3.862216052639635*^9, 3.8622167667948923`*^9, 3.862218101244329*^9, 
  3.8622189566511717`*^9, 3.862276910381792*^9, 3.8622853273272867`*^9, 
  3.862290816360045*^9, 3.86229085268187*^9, 3.862455232417611*^9},
 CellLabel->
  "Out[218]=",ExpressionUUID->"cff9bc3e-9a0d-444a-8024-91a6d8904787"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scatter opacity", "Section",
 CellChangeTimes->{{3.86211078365486*^9, 
  3.862110787266242*^9}},ExpressionUUID->"e66a0de1-3c1c-49b8-83a7-\
4953f4343738"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aint", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Eci", ",", 
      "Epe", ",", "Epi", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "b",
       ",", "a", ",", "q", ",", "m", ",", "ri", ",", "\[Epsilon]p", ",", 
      "\[Eta]p", ",", "g", ",", "\[Epsilon]", ",", "\[Eta]", ",", "\[Beta]i", 
      ",", "K1i", ",", "K2i", ",", "Kz1i", ",", "Kz2i", ",", "ep1i", ",", 
      "em1i", ",", "ep2i", ",", "em2i", ",", "e01i", ",", "e02i", ",", "Ap1", 
      ",", "Am1", ",", "A01", ",", "Ap2", ",", "Am2", ",", "A02", ",", "Ap", 
      ",", "Am", ",", "A0", ",", "\[Rho]", ",", "x", ",", "T", ",", "Mns", 
      ",", "Rns", ",", "gns", ",", "\[Tau]mid", ",", "\[Gamma]eiL", ",", 
      "\[Gamma]eip", ",", "y1", ",", "y2", ",", "\[Gamma]re", ",", 
      "\[Gamma]ri", ",", "gl", ",", "gp", ",", "\[Epsilon]pg", ",", 
      "\[Epsilon]mg"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "63.2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.761"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", " ", "0.00198"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", "0.267"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", 
      RowBox[{"\[Minus]", "0.356"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", "0.179"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", 
      RowBox[{"\[Minus]", "0.0282"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{"\[Minus]", "0.118"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", 
      RowBox[{"\[Minus]", "0.0336"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", 
      RowBox[{"\[Minus]", "0.00428"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", 
      RowBox[{"\[Minus]", "0.00022"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]], 
        RowBox[{"(", 
         RowBox[{"1.195", "-", 
          RowBox[{
           FractionBox["2", "3"], 
           RowBox[{"Log", "[", "b", "]"}]}], "-", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.8553", "+", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          FractionBox["1", 
           RowBox[{"2", 
            SuperscriptBox["b", "2"]}]]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.3070", "+", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         RowBox[{"0.7003", " ", 
          FractionBox["1", 
           SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["2", "3"], "+", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.1447", "-", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         FractionBox["1", 
          SuperscriptBox["b", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "y2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ri", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]i", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1i", "=", 
      RowBox[{"\[Beta]i", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["ri", 
             SuperscriptBox["\[Beta]i", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2i", "=", 
      RowBox[{"\[Beta]i", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["ri", 
             SuperscriptBox["\[Beta]i", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1i", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "K1i"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2i", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]", "]"}], "K2i"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1i", "*", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Kz1i", "*", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2i", "*", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
          RowBox[{"Kz2i", "*", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1i", "*", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Kz1i", "*", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}], "2"], 
       
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2i", "*", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
            RowBox[{"Kz2i", "*", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "]"}], "2"], 
       
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1i", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"Kz1i", "*", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1i", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1i", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02i", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2i", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
          RowBox[{"Kz2i", "*", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2i", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2i", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"ep1i", "+", "ep2i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Am", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"em1i", "+", "em2i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A0", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"e01i", "+", "e02i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap2", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", "ep2i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     RowBox[{"Am2", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", "em2i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"A02", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         FractionBox["3", "4"], "*", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", "e02i"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "10"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "6"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ap1", "=", 
      RowBox[{"Ap", "-", "Ap2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Am1", "=", 
      RowBox[{"Am", "-", "Am2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A01", "=", 
      RowBox[{"A0", "-", "A02"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Ap1", ",", "Ap2", ",", "Am1", ",", "Am2", ",", "A01", ",", "A02"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.862112477793551*^9, 3.862112636743717*^9}, {
   3.862112667241892*^9, 3.862112688654994*^9}, 3.862112731447269*^9, {
   3.8621130987238693`*^9, 3.862113105786236*^9}, {3.8621133699680347`*^9, 
   3.862113382297454*^9}, {3.862115479104953*^9, 3.8621154797951117`*^9}, {
   3.862200119724718*^9, 3.862200129813558*^9}, {3.8622031711794167`*^9, 
   3.862203171521489*^9}, 3.862215349862418*^9, {3.862215400577221*^9, 
   3.8622154438097467`*^9}, {3.862215494701984*^9, 3.8622155171940613`*^9}, {
   3.86221556634977*^9, 3.862215684434338*^9}, {3.862216211947282*^9, 
   3.862216291258833*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0c32b016-d668-47dd-b836-94deef2c4550"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Aint", "[", 
  RowBox[{"2", ",", 
   RowBox[{"5", "*", 
    SuperscriptBox["10", "14"]}], ",", "100"}], "]"}]], "Input",
 CellChangeTimes->{{3.862216065171545*^9, 3.862216082417757*^9}, {
   3.862216160497562*^9, 3.862216162818512*^9}, 3.862216308849449*^9, {
   3.862291026458613*^9, 3.862291027103745*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"61f5cb0d-5c62-4e8f-80b5-32006e62f784"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.75264843861995967575315063034233599558`9.781357395305957", ",", 
   "0.24626955564799821023062907625594738069`10.", ",", 
   "0.74735029794488436475656990593394350558`9.776441110655833", ",", 
   "0.25157399480624865868087605550211474485`10.", ",", 
   "1.28099873482605204777235759885149`3.8055829094028537*^-6", ",", 
   "1.00215643198217419428479598494385681659`10."}], "}"}]], "Output",
 CellChangeTimes->{
  3.86221608294982*^9, 3.86221616436199*^9, {3.862216303968128*^9, 
   3.862216309256215*^9}, 3.862216787445373*^9, 3.862218102446987*^9, 
   3.862218957855568*^9, 3.862276924851519*^9, 3.862285340400538*^9, 
   3.862290910204115*^9, 3.862291028794738*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"fbcc22e1-a4b6-491a-95d8-b56954c4f7e1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"scatteropacity", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Eci", ",", 
      "Epe", ",", "Epi", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "b",
       ",", "a", ",", "q", ",", "m", ",", "r", ",", "\[Epsilon]p", ",", 
      "\[Eta]p", ",", "g", ",", "\[Epsilon]", ",", "\[Eta]", ",", "\[Beta]", 
      ",", "K1", ",", "K2", ",", "Kz1", ",", "Kz2", ",", "ep1", ",", "em1", 
      ",", "ep2", ",", "em2", ",", "e01", ",", "e02", ",", "gl", ",", "gp", 
      ",", "\[Omega]ci", ",", "\[Tau]mid", ",", "x", ",", "T", ",", "\[Rho]", 
      ",", "Mns", ",", "Rns", ",", "gns", ",", "\[Gamma]eiL", ",", 
      "\[Gamma]eip", ",", "y1", ",", "y2", ",", "\[Gamma]re", ",", 
      "\[Gamma]ri", ",", "\[Epsilon]pg", ",", "\[Epsilon]mg", ",", 
      "\[Gamma]ep", ",", "\[Gamma]em", ",", "\[Gamma]e0", ",", "\[Gamma]ip", 
      ",", "\[Gamma]im", ",", "\[Gamma]i0", ",", "\[Kappa]s1e1", ",", 
      "\[Kappa]s1i1", ",", "\[Kappa]s2e1", ",", "\[Kappa]s2i1", ",", 
      "\[Kappa]s11", ",", "\[Kappa]s12", ",", "\[Kappa]s1e2", ",", 
      "\[Kappa]s1i2", ",", "\[Kappa]s2e2", ",", "\[Kappa]s2i2", ",", 
      "\[Kappa]s21", ",", "\[Kappa]s22"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "63.2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.761"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", " ", "0.00198"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", "0.267"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", 
      RowBox[{"\[Minus]", "0.356"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", "0.179"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", 
      RowBox[{"\[Minus]", "0.0282"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{"\[Minus]", "0.118"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", 
      RowBox[{"\[Minus]", "0.0336"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", 
      RowBox[{"\[Minus]", "0.00428"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", 
      RowBox[{"\[Minus]", "0.00022"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]ci", "=", " ", 
      FractionBox[
       RowBox[{"Z", " ", "e", " ", "B"}], 
       RowBox[{"A", " ", "mp", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]], 
        RowBox[{"(", 
         RowBox[{"1.195", "-", 
          RowBox[{
           FractionBox["2", "3"], 
           RowBox[{"Log", "[", "b", "]"}]}], "-", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.8553", "+", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          FractionBox["1", 
           RowBox[{"2", 
            SuperscriptBox["b", "2"]}]]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.3070", "+", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         RowBox[{"0.7003", " ", 
          FractionBox["1", 
           SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["2", "3"], "+", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.1447", "-", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         FractionBox["1", 
          SuperscriptBox["b", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "y2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K1", "2"], "+", 
        SuperscriptBox["Kz1", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K2", "2"], "+", 
        SuperscriptBox["Kz2", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ep", "=", 
      RowBox[{"\[Gamma]eiL", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]em", "=", 
      RowBox[{"\[Gamma]eiL", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]e0", "=", 
      RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ip", "=", 
      RowBox[{
       RowBox[{
        FractionBox["me", "mp"], "\[Gamma]eiL"}], "+", "\[Gamma]ri"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]im", "=", 
      RowBox[{
       RowBox[{
        FractionBox["me", "mp"], "\[Gamma]eiL"}], "+", "\[Gamma]ri"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]i0", "=", 
      RowBox[{
       RowBox[{
        FractionBox["me", "mp"], "\[Gamma]eip"}], "+", "\[Gamma]ri"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1e1", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1i1", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s11", "=", 
      RowBox[{"\[Kappa]s1e1", "+", "\[Kappa]s1i1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1e2", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s1i2", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep1", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em1", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e01", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s12", "=", 
      RowBox[{"\[Kappa]s1e2", "+", "\[Kappa]s1i2"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2e1", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2i1", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am1"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A01"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s21", "=", 
      RowBox[{"\[Kappa]s2e1", "+", "\[Kappa]s2i1"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2e2", "=", 
      RowBox[{"Ye", "*", "\[Kappa]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ep", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ue", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]em", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ue", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]e0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s2i2", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], "*", 
       FractionBox["\[Kappa]T", "A"], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]ip", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "ep2", "*", "Ap2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["ui", "0.5"]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]im", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "em2", "*", "Am2"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"0", "*", 
                 SuperscriptBox["ui", "0.5"]}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Gamma]i0", "2"]}], ")"}], 
           RowBox[{"-", "1"}]], "e02", "*", "A02"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]s22", "=", 
      RowBox[{"\[Kappa]s2e2", "+", "\[Kappa]s2i2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\[Kappa]s11", ",", "\[Kappa]s12", ",", "\[Kappa]s21", ",", 
       "\[Kappa]s22"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8619662542964487`*^9, 3.861966255752267*^9}, {
   3.861966286990212*^9, 3.861966310815189*^9}, {3.861966366553494*^9, 
   3.8619664126295967`*^9}, {3.861966460014474*^9, 3.861966483428029*^9}, {
   3.86196654554508*^9, 3.8619666605210953`*^9}, {3.861966709209655*^9, 
   3.86196678522508*^9}, {3.861966857722144*^9, 3.861966977802162*^9}, {
   3.8619670078662767`*^9, 3.8619670086754303`*^9}, {3.861967823028294*^9, 
   3.861967865685066*^9}, {3.861967957327875*^9, 3.861967968782711*^9}, {
   3.861968034251009*^9, 3.8619680398823147`*^9}, {3.861968080697742*^9, 
   3.861968292401668*^9}, {3.861968369720783*^9, 3.8619684150963163`*^9}, {
   3.8619687055175047`*^9, 3.8619687111944933`*^9}, {3.861968936893284*^9, 
   3.861968958711403*^9}, {3.861969646033495*^9, 3.861969668735609*^9}, {
   3.8620571419812107`*^9, 3.8620571591419067`*^9}, {3.8620572319040737`*^9, 
   3.862057237408332*^9}, {3.862057475001934*^9, 3.862057483808165*^9}, {
   3.8620575360617447`*^9, 3.862057543897107*^9}, {3.862110942743116*^9, 
   3.86211098309041*^9}, 3.862111016017262*^9, {3.8621110568299513`*^9, 
   3.862111121471571*^9}, {3.862111353442923*^9, 3.8621113538948927`*^9}, {
   3.862112308960351*^9, 3.862112323281927*^9}, {3.862112384822692*^9, 
   3.8621123879649*^9}, {3.862200170712943*^9, 3.862200180229312*^9}, {
   3.862203182069058*^9, 3.862203182648527*^9}, 3.8622163742307997`*^9, {
   3.862216414326277*^9, 3.862216449143799*^9}, {3.8622164956373568`*^9, 
   3.862216582432743*^9}, 3.862216825168517*^9, 3.862216860282577*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"b31cc2f8-e8a2-4e8c-92c4-e986fc8dfa24"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "Ap1", ",", "Ap2", ",", "Am1", ",", "Am2", ",", "A01", ",", "A02"}], "}"}],
   "=", 
  RowBox[{"Aint", "[", 
   RowBox[{"1", ",", 
    RowBox[{"5", "*", 
     SuperscriptBox["10", "14"]}], ",", "100"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"scatteropacity", "[", 
  RowBox[{"0.01", ",", 
   RowBox[{"5", "*", 
    SuperscriptBox["10", "14"]}], ",", "100", ",", 
   FractionBox["\[Pi]", "100"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.862116012430331*^9, 3.862116094217808*^9}, {
  3.862200198887041*^9, 3.862200200584041*^9}, {3.8622769438865232`*^9, 
  3.862276978832838*^9}, {3.86229115344877*^9, 3.8622911540096893`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"956783e7-4737-4fb3-a4ba-dfae4a63e2b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.75016107623219322704065108894261925051`9.784599338889963", ",", 
   "0.2408407168491780651194638978734268892`10.", ",", 
   "0.74983891983568235653893174400182855681`9.78429781312301", ",", 
   "0.24116487985677716369702990230512738016`10.", ",", 
   "4.05577360623518447934864036951`1.2992983178026902*^-9", ",", 
   "1.01799440317039578327266668339117829177`10."}], "}"}]], "Output",
 CellChangeTimes->{
  3.862116058104205*^9, 3.862116095063505*^9, 3.862116399344514*^9, 
   3.862136466808971*^9, {3.862200189312159*^9, 3.8622002047916193`*^9}, 
   3.862216591842497*^9, 3.862216804983356*^9, 3.862216841601541*^9, 
   3.862216876189221*^9, 3.862218105558607*^9, 3.862218960593256*^9, {
   3.862276935305067*^9, 3.862276979375992*^9}, 3.862285351493025*^9, 
   3.862291091299342*^9, 3.862291159145853*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"78867bc9-2a89-4f69-ac07-6a0416943b13"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.7806072823375406`*^-12", ",", "5.721736421397859`*^-13", ",", 
   "1.7806133100583946`*^-12", ",", "1.4929430537201079`*^-9"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.862116058104205*^9, 3.862116095063505*^9, 3.862116399344514*^9, 
   3.862136466808971*^9, {3.862200189312159*^9, 3.8622002047916193`*^9}, 
   3.862216591842497*^9, 3.862216804983356*^9, 3.862216841601541*^9, 
   3.862216876189221*^9, 3.862218105558607*^9, 3.862218960593256*^9, {
   3.862276935305067*^9, 3.862276979375992*^9}, 3.862285351493025*^9, 
   3.862291091299342*^9, 3.862291159178133*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"68477877-6ff0-4be6-9472-90d722710a54"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["free free opacity", "Section",
 CellChangeTimes->{{3.862111302735526*^9, 
  3.8621113078983707`*^9}},ExpressionUUID->"750a1e48-a2d7-415c-91e7-\
b6eab27e8bb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freeopacity", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Epsilon]p", ",", "\[Eta]p", ",", "\[Epsilon]", ",", "\[Eta]", ",", 
      "g", ",", "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", 
      "Epi", ",", "Eci", ",", "Epe", ",", "ue", ",", "ui", ",", "ve", ",", 
      "vi", ",", "\[Gamma]re", ",", "\[Gamma]ri", ",", "r1", ",", "r2", ",", 
      "\[Gamma]eiL", ",", "\[Gamma]eip", ",", "\[Epsilon]pg", ",", 
      "\[Epsilon]mg", ",", "\[Alpha]F", ",", "BQ", ",", "b", ",", "a", ",", 
      "q", ",", "m", ",", "r", ",", "\[Beta]", ",", "K1", ",", "K2", ",", 
      "Kz1", ",", "Kz2", ",", "ep1", ",", "ep2", ",", "em1", ",", "em2", ",", 
      "e01", ",", "e02", ",", "\[Gamma]p", ",", "\[Gamma]m", ",", 
      "\[CapitalLambda]p", ",", "\[CapitalLambda]m", ",", "\[Kappa]p", ",", 
      "\[Kappa]m", ",", "\[Kappa]o", ",", "\[Kappa]ff1", ",", "\[Kappa]ff2", 
      ",", "\[Tau]mid", ",", "x", ",", "Mns", ",", "Rns", ",", "gns", ",", 
      "gp", ",", "gl", ",", "\[Rho]", ",", "T"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "63.2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.761"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", " ", "0.00198"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", "0.267"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", 
      RowBox[{"\[Minus]", "0.356"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", "0.179"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", 
      RowBox[{"\[Minus]", "0.0282"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{"\[Minus]", "0.118"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", 
      RowBox[{"\[Minus]", "0.0336"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", 
      RowBox[{"\[Minus]", "0.00428"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", 
      RowBox[{"\[Minus]", "0.00022"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]], 
        RowBox[{"(", 
         RowBox[{"1.195", "-", 
          RowBox[{
           FractionBox["2", "3"], 
           RowBox[{"Log", "[", "b", "]"}]}], "-", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.8553", "+", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          FractionBox["1", 
           RowBox[{"2", 
            SuperscriptBox["b", "2"]}]]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.3070", "+", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         RowBox[{"0.7003", " ", 
          FractionBox["1", 
           SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["2", "3"], "+", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.1447", "-", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         FractionBox["1", 
          SuperscriptBox["b", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]re", "=", 
      RowBox[{"9.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]ri", "=", 
      RowBox[{"5.2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]], "*", 
       FractionBox[
        SuperscriptBox["Z", "2"], "A"], "*", 
       FractionBox["Es", "1"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "r1"}], "*", "r2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"r2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "r1"}], "*", "r2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "r2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"r2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eiL", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]eip", "=", 
      RowBox[{"9.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]], "*", 
       FractionBox[
        RowBox[{
         SuperscriptBox["Z", "2"], "*", 
         RowBox[{"(", 
          RowBox[{"\[Rho]", "/", "1"}], ")"}]}], 
        RowBox[{"A", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"T", "/", 
            SuperscriptBox["10", "6"]}], ")"}], "0.5"], 
         SuperscriptBox["Es", "2"]}]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "Ec"}], "/", 
           RowBox[{"(", 
            RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]pg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "+", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]mg", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"ve", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
         RowBox[{"vi", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]re"}], "-", 
            SuperscriptBox["ue", "0.5"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
            SuperscriptBox["ui", "0.5"]}], ")"}]}], "+", 
         RowBox[{"I", "*", "\[Gamma]eiL"}]}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", 
       FractionBox["ve", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}]], "-", 
       FractionBox["vi", 
        RowBox[{"1", "+", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}]]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]F", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["e", "2"], "/", "hbar"}], "/", "c"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BQ", "=", 
      RowBox[{
       SuperscriptBox["me", "2"], "*", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c", "3"], "/", "e"}], "/", "hbar"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]], 
        RowBox[{"(", 
         RowBox[{"1.195", "-", 
          RowBox[{
           FractionBox["2", "3"], 
           RowBox[{"Log", "[", "b", "]"}]}], "-", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.8553", "+", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          FractionBox["1", 
           RowBox[{"2", 
            SuperscriptBox["b", "2"]}]]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.3070", "+", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         RowBox[{"0.7003", " ", 
          FractionBox["1", 
           SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["2", "3"], "+", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.1447", "-", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         FractionBox["1", 
          SuperscriptBox["b", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz1", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "K2", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "Kz2", "]"}], "2"]}]]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]p", "=", 
      RowBox[{"\[Gamma]eiL", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["ue", "0.5"]}], ")"}], "\[Gamma]ri"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["ui", "0.5"]}], ")"}], "\[Gamma]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]m", "=", 
      RowBox[{"\[Gamma]eiL", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["ue", "0.5"]}], ")"}], "\[Gamma]ri"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["ui", "0.5"]}], ")"}], "\[Gamma]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]p", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["ue", "0.5"]}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["ui", "0.5"]}], ")"}], "2"]}], "+", 
         SuperscriptBox["\[Gamma]p", "2"]}], ")"}], 
       RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]m", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["ue", "0.5"]}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["ui", "0.5"]}], ")"}], "2"]}], "+", 
         SuperscriptBox["\[Gamma]m", "2"]}], ")"}], 
       RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]p", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", " ", "\[CapitalLambda]p", " ",
        "\[Gamma]eiL"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]m", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", " ", "\[CapitalLambda]m", " ",
        "\[Gamma]eiL"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]o", "=", 
      RowBox[{
       FractionBox["\[Omega]", 
        RowBox[{" ", 
         RowBox[{"c", " ", "\[Rho]"}]}]], "ve", "*", "\[Gamma]eip"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]ff1", "=", 
      RowBox[{
       RowBox[{"\[Kappa]p", "*", "ep1"}], " ", "+", " ", 
       RowBox[{"\[Kappa]m", "*", "em1"}], " ", "+", " ", 
       RowBox[{"\[Kappa]o", "*", "e01"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]ff2", "=", 
      RowBox[{
       RowBox[{"\[Kappa]p", "*", "ep2"}], " ", "+", " ", 
       RowBox[{"\[Kappa]m", "*", "em2"}], "+", " ", 
       RowBox[{"\[Kappa]o", "*", "e02"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]ff1", ",", "\[Kappa]ff2"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.862111315259729*^9, 3.862111341481821*^9}, {
   3.862111375592436*^9, 3.862111389641347*^9}, {3.862112257094551*^9, 
   3.862112282827321*^9}, 3.862116480450753*^9, {3.8622172708110237`*^9, 
   3.862217310231078*^9}, {3.862217358058984*^9, 3.862217388842092*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"441ad3d1-55e4-45f4-b2c4-36afd192e5bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"freeopacity", "[", 
  RowBox[{"1", ",", 
   SuperscriptBox["10", "13"], ",", "100", ",", 
   FractionBox["\[Pi]", "10"]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8622174400431023`*^9, {3.862276999228675*^9, 3.862277010379035*^9}, 
   3.862285395948441*^9},
 CellLabel->
  "In[107]:=",ExpressionUUID->"910bc1cd-483a-4bbf-ab87-bc23b4d0eca6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3942994495170964`", ",", "19.256260731121174`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8622174409210987`*^9, 3.8622181058574123`*^9, 3.862218960857786*^9, {
   3.862276993222172*^9, 3.862277011072319*^9}, {3.862285390255454*^9, 
   3.8622853965886927`*^9}},
 CellLabel->
  "Out[107]=",ExpressionUUID->"890485f8-9aae-4d99-bb8a-34f4e4ae1617"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"freeopacity1", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Tau]_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ec", ",", "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Eci", ",", 
      "Epe", ",", "Epi", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "b",
       ",", "a", ",", "q", ",", "m", ",", "r", ",", "\[Epsilon]p", ",", 
      "\[Eta]p", ",", "g", ",", "\[Epsilon]", ",", "\[Eta]", ",", "\[Beta]", 
      ",", "K1", ",", "K2", ",", "Kz1", ",", "Kz2", ",", "ep1", ",", "em1", 
      ",", "ep2", ",", "em2", ",", "e01", ",", "e02", ",", "ne", ",", "ni", 
      ",", "\[Alpha]0", ",", "gl", ",", "gp", ",", "y1", ",", "y2", ",", 
      "\[Omega]ci", ",", "\[Nu]re", ",", "\[Nu]ep", ",", "\[Nu]em", ",", 
      "\[Nu]e0", ",", "\[Nu]ip", ",", "\[Nu]im", ",", "\[Nu]i0", ",", "ffe1", 
      ",", "ffi1", ",", "ffe2", ",", "ffi2", ",", "ff1", ",", "ff2", ",", "T",
       ",", "\[Rho]", ",", "Mns", ",", "Rns", ",", "gns", ",", "\[Tau]mid", 
      ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Tau]mid", "=", "63.2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a1", "=", "0.761"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", " ", "0.00198"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a3", "=", "0.267"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a4", "=", 
      RowBox[{"\[Minus]", "0.356"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a5", "=", " ", "0.179"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a6", "=", 
      RowBox[{"\[Minus]", "0.0282"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b3", "=", 
      RowBox[{"\[Minus]", "0.118"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b4", "=", 
      RowBox[{"\[Minus]", "0.0336"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b5", "=", 
      RowBox[{"\[Minus]", "0.00428"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b6", "=", 
      RowBox[{"\[Minus]", "0.00022"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Piecewise", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"a3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"a4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"a5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"a6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
            RowBox[{"\[Tau]", "\[LessEqual]", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             SuperscriptBox["10", "6"], "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"a1", "+", 
                RowBox[{"a2", "*", "x"}], "+", 
                RowBox[{"b3", "*", 
                 SuperscriptBox["x", "2"]}], "+", 
                RowBox[{"b4", "*", 
                 SuperscriptBox["x", "3"]}], "+", 
                RowBox[{"b5", "*", 
                 SuperscriptBox["x", "4"]}], "+", 
                RowBox[{"b6", "*", 
                 SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Tau]", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&", 
            " ", 
            RowBox[{"\[Tau]", "\[GreaterEqual]", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]", "=", 
      RowBox[{"mp", "*", 
       FractionBox["gns", 
        RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
       "\[Tau]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ec", "=", 
      RowBox[{"Es", "*", "kev2erg"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Ec", "/", "hbar"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]ci", "=", " ", 
      FractionBox[
       RowBox[{"Z", " ", "e", " ", "B"}], 
       RowBox[{"A", " ", "mp", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ece", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
     RowBox[{"Eci", "=", 
      RowBox[{"Ece", "*", 
       FractionBox[
        RowBox[{"Z", " ", "me"}], 
        RowBox[{"A", " ", "mp"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epe", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "*", "\[Pi]", "*", 
           RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
           
           RowBox[{
            SuperscriptBox["e", "2"], "/", "me"}]}], ")"}], "0.5"], "/", 
        "kev2erg"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Epi", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"Z", " ", "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "0.5"], "*", "Epe"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ue", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Ece", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ui", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Eci", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"ve", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epe", "Es"], ")"}], "2"]}], ";", 
     RowBox[{"vi", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["Epi", "Es"], ")"}], "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"turn", " ", "on", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]], 
        RowBox[{"(", 
         RowBox[{"1.195", "-", 
          RowBox[{
           FractionBox["2", "3"], 
           RowBox[{"Log", "[", "b", "]"}]}], "-", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.8553", "+", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          FractionBox["1", 
           RowBox[{"2", 
            SuperscriptBox["b", "2"]}]]}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.3070", "+", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         RowBox[{"0.7003", " ", 
          FractionBox["1", 
           SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["2", "3"], "+", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.1447", "-", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         FractionBox["1", 
          SuperscriptBox["b", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{"turn", " ", "off", " ", "the", " ", "vacuum"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["m", "a"], 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]p", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"ve", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
            FractionBox[
             RowBox[{"A", " ", "mp"}], 
             RowBox[{"Z", " ", "me"}]], " ", "ui"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "ui"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "ue"}], ")"}]}]]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Eta]p", "=", 
      RowBox[{"1", "-", "ve"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      FractionBox[
       RowBox[{"ve", "*", 
        SuperscriptBox["ue", "0.5"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "ui"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", "ue"}], ")"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Eta]", "=", 
      RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Epsilon]", "2"], "-", 
           SuperscriptBox["g", "2"], "-", 
           RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"m", "/", "a"}]}], ")"}]}]}], 
          RowBox[{"2", "g", " ", "\[Eta]"}]], ")"}]}], "*", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"], 
        RowBox[{"Cos", "[", "\[Theta]b", "]"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"K1", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"K2", "=", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SuperscriptBox["\[Beta]", "2"]]}], ")"}], 
          RowBox[{"1", "/", "2"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Kz1", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Kz2", "=", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
          RowBox[{"g", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Epsilon]p", "*", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Theta]b", "]"}], "2"]}], "+", "a", "-", 
        "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ep1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ep2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"K2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em1", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K1", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz1", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K1", "2"], "+", 
          SuperscriptBox["Kz1", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"em2", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"K2", "*", 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
            RowBox[{"Kz2", "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], ")"}], "2"], 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["K2", "2"], "+", 
          SuperscriptBox["Kz2", "2"]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e01", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K1", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz1", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K1", "2"], "+", 
        SuperscriptBox["Kz1", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"e02", "=", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K2", " ", "*", " ", 
           RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
          RowBox[{"Kz2", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], ")"}], "2"], 
       RowBox[{"1", "+", 
        SuperscriptBox["K2", "2"], "+", 
        SuperscriptBox["Kz2", "2"]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ne", "=", 
      RowBox[{"\[Rho]", "/", "mp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ni", "=", "ne"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]0", "=", 
      RowBox[{"4", "*", 
       SuperscriptBox["\[Pi]", "2"], 
       SuperscriptBox["Z", "2"], 
       SuperscriptBox["\[Alpha]F", "3"], " ", 
       FractionBox[
        RowBox[{
         SuperscriptBox["hbar", "2"], " ", 
         SuperscriptBox["c", "2"]}], 
        SuperscriptBox["me", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"2", 
          FractionBox["me", 
           RowBox[{"\[Pi]", " ", "kb", " ", "T"}]]}], ")"}], 
        RowBox[{"1", "/", "2"}]], 
       FractionBox[
        RowBox[{"ne", " ", "ni"}], 
        SuperscriptBox["\[Omega]", "3"]], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "hbar"}], " ", "\[Omega]"}], 
           RowBox[{"kb", " ", "*", "T"}]], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y1", "=", 
      RowBox[{"hbar", "*", 
       RowBox[{"\[Omega]c", "/", 
        RowBox[{"(", 
         RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y2", "=", 
      RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gl", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", 
         RowBox[{"C1", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gp", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "y1"}], "*", "y2", "*", 
           SuperscriptBox[
            RowBox[{"Sinh", "[", "x1", "]"}], "2"]}], "]"}], "*", "2", "*", 
         "y2", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"2", "x1"}], "]"}], 
         RowBox[{"C0", "[", 
          RowBox[{"y2", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", " ", "x1"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", 
          RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"\[Nu]re", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"2", "*", 
         SuperscriptBox["e", "2"]}], 
        RowBox[{"3", " ", "me", " ", 
         SuperscriptBox["c", "3"]}]], 
       SuperscriptBox["\[Omega]", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]ep", "=", 
      RowBox[{"\[Nu]re", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]0", "*", "gl"}], 
         RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]em", "=", 
      RowBox[{"\[Nu]re", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]0", "*", "gl"}], 
         RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]e0", "=", 
      RowBox[{"\[Nu]re", "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Alpha]0", "*", "gp"}], 
         RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]ip", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Nu]re", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Alpha]0", "*", "gl"}], 
           RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}], ")"}], 
       FractionBox["me", "mp"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]im", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Nu]re", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Alpha]0", "*", "gl"}], 
           RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}], ")"}], 
       FractionBox["me", "mp"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]i0", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Nu]re", "+", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Alpha]0", "*", "gp"}], 
           RowBox[{"ne", " ", "\[Sigma]T"}]], "\[Nu]re"}]}], ")"}], 
       FractionBox["me", "mp"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffe1", "=", 
      RowBox[{
       FractionBox["\[Alpha]0", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"1", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]ep", "2"]}]], ")"}], "ep1", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "-", 
                RowBox[{"1", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]em", "2"]}]], ")"}], "em1", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"0", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]e0", "2"]}]], ")"}], "e01", "*", "gp"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffi1", "=", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["Z", "3"]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], 
       FractionBox["\[Alpha]0", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "-", 
                RowBox[{"1", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]ip", "2"]}]], ")"}], "ep1", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"1", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]im", "2"]}]], ")"}], "em1", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"0", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]i0", "2"]}]], ")"}], "e01", "*", "gp"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffe2", "=", 
      RowBox[{
       FractionBox["\[Alpha]0", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"1", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]ep", "2"]}]], ")"}], "ep2", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "-", 
                RowBox[{"1", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]em", "2"]}]], ")"}], "em2", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"0", "*", "\[Omega]c"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]e0", "2"]}]], ")"}], "e02", "*", "gp"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ffi2", "=", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["Z", "3"]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "2"], "me"}], 
          RowBox[{"A", " ", "mp"}]], ")"}], "2"], 
       FractionBox["\[Alpha]0", "\[Rho]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "-", 
                RowBox[{"1", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]ip", "2"]}]], ")"}], "ep2", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"1", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]im", "2"]}]], ")"}], "em2", "*", "gl"}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           FractionBox[
            SuperscriptBox["\[Omega]", "2"], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Omega]", "+", 
                RowBox[{"0", "*", "\[Omega]ci"}]}], ")"}], "2"], "+", 
             SuperscriptBox["\[Nu]i0", "2"]}]], ")"}], "e02", "*", "gp"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ff1", "=", 
      RowBox[{"ffe1", "+", "ffi1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ff2", "=", 
      RowBox[{"ffe2", "+", "ffi2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ff1", ",", "ff2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{3.862218855170843*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"e0a3b7db-d3d8-4b8b-8200-daca4cb5096d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["jump condition", "Section",
 CellChangeTimes->{{3.8621116025960693`*^9, 
  3.862111605381013*^9}},ExpressionUUID->"6670b494-a3c8-4fb5-a991-\
dce31b98d1ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]reson", "[", 
    RowBox[{"Es_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q", ",", "m", ",", "\[Omega]c", ",", "Ebi", ",", "Mns", ",", "Rns", 
       ",", "Ead", ",", "b", ",", "\[Delta]v", ",", "fB", ",", "gns", ",", 
       "\[Rho]v", ",", "\[Tau]v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Alpha]F", 
          RowBox[{"2", "\[Pi]"}]]}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.3070", "+", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          RowBox[{"0.7003", " ", 
           FractionBox["1", 
            SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Alpha]F", 
          RowBox[{"2", "\[Pi]"}]]}], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["2", "3"], "+", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.1447", "-", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          FractionBox["1", 
           SuperscriptBox["b", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]v", "=", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"45", "*", "\[Pi]"}]], 
        SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fB", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"3", "*", "\[Delta]v"}], 
          RowBox[{"q", "+", "m"}]], ")"}], "0.5"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mns", "=", 
       RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rns", "=", 
       SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gns", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"G", "*", "Mns"}], 
         SuperscriptBox["Rns", "2"]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", "G", " ", "Mns"}], 
            RowBox[{"Rns", " ", 
             SuperscriptBox["c", "2"]}]]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]v", "=", 
       RowBox[{"0.96", "*", " ", 
        SuperscriptBox["Ye", 
         RowBox[{"-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Es", "/", "1"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"B", "/", 
           SuperscriptBox["10", "14"]}], ")"}], "2"], 
        SuperscriptBox["fB", 
         RowBox[{"-", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]v", "=", 
       RowBox[{"\[Tau]x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"temperature", "[", "\[Tau]x", "]"}], "-", 
            RowBox[{"\[Tau]x", "*", 
             FractionBox[
              RowBox[{"mp", " ", "gns"}], 
              RowBox[{"\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb"}]]}]}],
            "\[Equal]", "0"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]x", ",", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"mp", " ", "gns"}], 
               RowBox[{
               "\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb", "*", "5", 
                "*", 
                SuperscriptBox["10", "6"]}]], ")"}], 
             RowBox[{"-", "1"}]]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[Tau]v"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pjump", "[", 
   RowBox[{"Es_", ",", "B_", ",", "\[Theta]b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Tau]v", ",", "Tv", ",", "H\[Rho]", ",", "jump", ",", "b", ",", "q", 
      ",", "m", ",", "\[Delta]v", ",", "fB", ",", "Mns", ",", "Rns", ",", 
      "gns", ",", "\[Omega]c", ",", "Ebi", ",", "\[Rho]v", ",", "Ead"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", "=", 
      RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.3070", "+", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         RowBox[{"0.7003", " ", 
          FractionBox["1", 
           SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[Alpha]F", 
         RowBox[{"2", "\[Pi]"}]]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["2", "3"], "+", 
         RowBox[{
          FractionBox["1", "b"], 
          RowBox[{"(", 
           RowBox[{"0.1447", "-", 
            RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
         FractionBox["1", 
          SuperscriptBox["b", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Delta]v", "=", 
      RowBox[{
       FractionBox["\[Alpha]F", 
        RowBox[{"45", "*", "\[Pi]"}]], 
       SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fB", "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"3", "*", "\[Delta]v"}], 
         RowBox[{"q", "+", "m"}]], ")"}], "0.5"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mns", "=", 
      RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rns", "=", 
      SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gns", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"G", "*", "Mns"}], 
        SuperscriptBox["Rns", "2"]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{"2", "G", " ", "Mns"}], 
           RowBox[{"Rns", " ", 
            SuperscriptBox["c", "2"]}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]c", "=", 
      FractionBox[
       RowBox[{"e", " ", "B"}], 
       RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ebi", "=", 
      RowBox[{"hbar", "*", "\[Omega]c", "*", 
       RowBox[{
        FractionBox["me", "mp"], "/", "kev2erg"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", 
      RowBox[{"0.96", "*", " ", 
       SuperscriptBox["Ye", 
        RowBox[{"-", "1"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Es", "/", "1"}], ")"}], "2"], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"B", "/", 
          SuperscriptBox["10", "14"]}], ")"}], "2"], 
       SuperscriptBox["fB", 
        RowBox[{"-", "2"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Tau]v", "=", 
      RowBox[{"\[Tau]x", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"temperature", "[", "\[Tau]x", "]"}], "-", 
           RowBox[{"\[Tau]x", "*", 
            FractionBox[
             RowBox[{"mp", " ", "gns"}], 
             RowBox[{"\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb"}]]}]}], 
          "\[Equal]", "0"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"\[Tau]x", ",", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"mp", " ", "gns"}], 
              RowBox[{
              "\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb", "*", "5", "*", 
               SuperscriptBox["10", "6"]}]], ")"}], 
            RowBox[{"-", "1"}]]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tv", "=", 
      RowBox[{"temperature", "[", "\[Tau]v", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"H\[Rho]", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"2", "*", "kb", "*", 
        RowBox[{"Tv", "/", 
         RowBox[{"(", 
          RowBox[{"mp", " ", "*", " ", "gns", " ", "*", 
           RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ead", "=", 
      RowBox[{"2.52", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"fB", "*", 
            RowBox[{"Tan", "[", "\[Theta]b", "]"}]}], ")"}], "2"], ")"}], 
        RowBox[{"1", "/", "3"}]], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Abs", "[", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["Ebi", "Es"], ")"}], "2"]}], "]"}], ")"}], 
        RowBox[{"2", "/", "3"}]], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", "H\[Rho]"], ")"}], 
        RowBox[{"1", "/", "3"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"jump", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "\[Pi]"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["Es", "Ead"], ")"}], "3"]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"N", "[", "jump", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.862112202826563*^9, 3.862112203943747*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"22914adb-9b21-4244-8aa6-4c18220b252f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generating the grid", "Section",
 CellChangeTimes->{{3.862113769441164*^9, 
  3.862113774126528*^9}},ExpressionUUID->"915f5a80-a629-4723-82a6-\
1bdb230f2708"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Es", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"5", "*", 
    SuperscriptBox["10", "14"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]v", "=", 
   RowBox[{"\[Tau]reson", "[", 
    RowBox[{"Es", ",", "B"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]x1", "=", 
   RowBox[{"logspace", "[", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", "\[Tau]v"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]v"}], "]"}], "]"}], "+", "3"}], ")"}], 
      "*", "20"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]x2", "=", 
   RowBox[{"logspace", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", "\[Tau]v"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Log", "[", 
       RowBox[{"10", ",", "2"}], "]"}], "+", "4"}], ",", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "2"}], "]"}], "+", "4", "-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]v"}], "]"}]}], ")"}], "]"}], "*", 
      "20"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"\[Tau]x1", ",", "\[Tau]x2"}], "}"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"position", "=", 
   RowBox[{
    RowBox[{"IntegerPart", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "2"}], "]"}], "+", "4", "-", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", "\[Tau]v"}], "]"}]}], ")"}], "]"}], "*", "20"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]x", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"Range", "[", 
       RowBox[{"0.001", ",", "89.9", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"89.9", "-", "0.001"}], ")"}], "/", "30"}]}], "]"}], "]"}], 
     "/", "180"}], "*", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1u", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I2u", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1d", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I2d", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1u", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox["1", "2"], ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "*", 
     RowBox[{"Planck", "[", 
      RowBox[{"Es", ",", 
       RowBox[{"temperature", "[", 
        RowBox[{"First", "[", "\[Tau]", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I2u", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       FractionBox["1", "2"], ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "*", 
     RowBox[{"Planck", "[", 
      RowBox[{"Es", ",", 
       RowBox[{"temperature", "[", 
        RowBox[{"First", "[", "\[Tau]", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"I1d", "[", 
    RowBox[{"[", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], "]"}], "]"}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", "1", ",", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"I2d", "[", 
     RowBox[{"[", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "]"}], "]"}], "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "give", " ", "the", " ", "initial", " ", "data", " ", "for", " ", "source",
     " ", "function"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Tau]", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]\[Tau]1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "1"}], ",", 
   RowBox[{"j", "\[LessEqual]", 
    RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"S1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", "2"], "*", 
         RowBox[{"Planck", "[", 
          RowBox[{"Es", ",", 
           RowBox[{"temperature", "[", 
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"S2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", "2"], "*", 
         RowBox[{"Planck", "[", 
          RowBox[{"Es", ",", 
           RowBox[{"temperature", "[", 
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}]}]}]}], "]"}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.86211379315739*^9, 3.8621137966157827`*^9}, {
  3.8621138505713797`*^9, 3.8621138765226383`*^9}, {3.862113907122985*^9, 
  3.862113996996504*^9}, {3.862114089182941*^9, 3.862114090077014*^9}, {
  3.862114129445086*^9, 3.8621141300100946`*^9}, {3.8621150674531193`*^9, 
  3.862115086867985*^9}, {3.8621161298894787`*^9, 3.862116131528884*^9}, {
  3.86211924413378*^9, 3.862119254927272*^9}, {3.862119864865082*^9, 
  3.862119883715431*^9}, {3.8621204721505003`*^9, 3.86212047279683*^9}, {
  3.862125037764369*^9, 3.862125040740348*^9}, {3.862136478629347*^9, 
  3.862136478937154*^9}, {3.8621365319023046`*^9, 3.862136545362131*^9}, {
  3.862200235841805*^9, 3.862200253776733*^9}, {3.862218088020137*^9, 
  3.8622180882143993`*^9}, {3.862285468565711*^9, 3.8622854694382668`*^9}, {
  3.86228658636022*^9, 3.8622865867226677`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"dac479d8-99b9-4857-842f-02ffce54d0db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ff1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc11", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc12", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc21", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc22", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]t1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Kappa]t2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"Length", "[", "\[Tau]", "]"}], ",", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Ap1", ",", "Ap2", ",", "Am1", ",", "Am2", ",", "A01", ",", "A02"}], 
      "}"}], "=", 
     RowBox[{"Aint", "[", 
      RowBox[{"Es", ",", "B", ",", 
       RowBox[{"\[Tau]", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"free", "=", 
        RowBox[{"freeopacity", "[", 
         RowBox[{"Es", ",", "B", ",", 
          RowBox[{"\[Tau]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]x", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ff1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"free", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"ff2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"free", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"scatter", "=", 
        RowBox[{"scatteropacity", "[", 
         RowBox[{"Es", ",", "B", ",", 
          RowBox[{"\[Tau]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]x", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc11", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc12", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc21", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sc22", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{"scatter", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Kappa]t1", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"ff1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc11", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc12", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Kappa]t2", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"ff2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc21", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"sc22", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",\

 CellChangeTimes->{{3.862115138038172*^9, 3.862115160476248*^9}, {
   3.8621152907759857`*^9, 3.862115296377151*^9}, {3.862115328660122*^9, 
   3.862115373677397*^9}, 3.8621163682830467`*^9, {3.8621166575966043`*^9, 
   3.862116675456362*^9}, {3.862118702061414*^9, 3.862118725051208*^9}, {
   3.862218884000979*^9, 3.86221890574004*^9}, {3.862285473422971*^9, 
   3.862285495742639*^9}, {3.862291275915362*^9, 3.862291280050645*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"c8e58968-f91f-4ee3-a0b6-5085db58a74e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "1"}], ",", 
   RowBox[{"k", "\[LessEqual]", "10"}], ",", 
   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "=", 
        RowBox[{"\[Theta]x", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ";", 
       RowBox[{"\[Mu]", "=", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "upward", " ", "integration", " ", "and", " ", "downward", " ", 
         "integration"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]\[Tau]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"I1u", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Delta]\[Tau]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                RowBox[{"\[Kappa]t1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
               RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[Delta]\[Tau]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], 
                  RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
               RowBox[{"I1u", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "-", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Delta]\[Tau]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Kappa]t1", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                  RowBox[{"S1", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                 
                 RowBox[{
                  RowBox[{"\[Kappa]t1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                  RowBox[{"S1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"I2u", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Delta]\[Tau]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                RowBox[{"\[Kappa]t2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
               RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[Delta]\[Tau]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], 
                  RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
               RowBox[{"I2u", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "-", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Delta]\[Tau]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Kappa]t2", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                  RowBox[{"S2", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                 
                 RowBox[{
                  RowBox[{"\[Kappa]t2", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                  RowBox[{"S2", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ax", "=", 
           RowBox[{"I1u", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bx", "=", 
           RowBox[{"I2u", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "position"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"I1u", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Pjump", "[", 
                 RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                "ax"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"Pjump", "[", 
                   RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}], 
                "*", "bx"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"I2u", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Pjump", "[", 
                 RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                "bx"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"Pjump", "[", 
                   RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}], 
                "*", "ax"}]}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"I1u", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "ax"}], ";", 
             RowBox[{
              RowBox[{"I2u", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "bx"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"i1", "=", 
           RowBox[{
            RowBox[{"Length", "[", "\[Tau]", "]"}], "+", "1", "-", "i"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Delta]\[Tau]1", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "-", 
            RowBox[{"\[Tau]", "[", 
             RowBox[{"[", 
              RowBox[{"i1", "+", "1"}], "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"I1d", "[", 
            RowBox[{"[", 
             RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"1", "+", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Delta]\[Tau]1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                RowBox[{"\[Kappa]t1", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], 
               RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[Delta]\[Tau]1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                   RowBox[{"\[Kappa]t1", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], 
                  RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
               RowBox[{"I1d", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Delta]\[Tau]1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Kappa]t1", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                  RowBox[{"S1", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Kappa]t1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}], "*", 
                  RowBox[{"S1", "[", 
                   RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"I2d", "[", 
            RowBox[{"[", 
             RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"1", "+", 
              FractionBox[
               RowBox[{
                RowBox[{"\[Delta]\[Tau]1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                RowBox[{"\[Kappa]t2", "[", 
                 RowBox[{"[", 
                  RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], 
               RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[Delta]\[Tau]1", "[", 
                    RowBox[{"[", "i1", "]"}], "]"}], "*", " ", 
                   RowBox[{"\[Kappa]t2", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], 
                  RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]]}], ")"}], 
               RowBox[{"I2d", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"\[Delta]\[Tau]1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], 
                RowBox[{"2", "*", "\[Mu]", "*", "\[Kappa]T"}]], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Kappa]t2", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}], "*", 
                  RowBox[{"S2", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i1", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"\[Kappa]t2", "[", 
                   RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}], "*", 
                  RowBox[{"S2", "[", 
                   RowBox[{"[", 
                    RowBox[{"i1", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ay", "=", 
           RowBox[{"I1d", "[", 
            RowBox[{"[", 
             RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"by", "=", 
           RowBox[{"I2d", "[", 
            RowBox[{"[", 
             RowBox[{"i1", ",", "j"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i1", "\[Equal]", 
             RowBox[{
              RowBox[{"Length", "[", "\[Tau]", "]"}], "+", "1", "-", 
              "position"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"I1d", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Pjump", "[", 
                 RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                "ay"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"Pjump", "[", 
                   RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}], 
                "*", "by"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"I2d", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Pjump", "[", 
                 RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}], "*", 
                "by"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"Pjump", "[", 
                   RowBox[{"Es", ",", "B", ",", "\[Theta]"}], "]"}]}], ")"}], 
                "*", "ay"}]}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"I1d", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", "ay"}], ";", 
             RowBox[{
              RowBox[{"I2d", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "j"}], "]"}], "]"}], "=", "by"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"m", "=", "1"}], ",", 
      RowBox[{"m", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
      RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"u1", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{"2", "*", 
         FractionBox["\[Pi]", "c"], "*", 
         RowBox[{"(", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Transpose", "@", 
                RowBox[{"{", 
                 RowBox[{"\[Theta]x", ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Theta]x", "]"}], "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"I1u", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", 
                    RowBox[{"I1d", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], "]"}], "[", 
             "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Min", "[", "\[Theta]x", "]"}], ",", 
              RowBox[{"Max", "[", "\[Theta]x", "]"}]}], "}"}]}], "]"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"u2", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{"2", "*", 
         FractionBox["\[Pi]", "c"], "*", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Interpolation", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"\[Theta]x", ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "\[Theta]x", "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"I2u", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "+", 
                    RowBox[{"I2d", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], ")"}]}]}], "}"}]}], ",", 
              RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], "]"}], "[", 
            "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Min", "[", "\[Theta]x", "]"}], ",", 
             RowBox[{"Max", "[", "\[Theta]x", "]"}]}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"S1", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"ff1", "[", 
            RowBox[{"[", "m", "]"}], "]"}], 
           RowBox[{"\[Kappa]t1", "[", 
            RowBox[{"[", "m", "]"}], "]"}]], "*", 
          FractionBox[
           RowBox[{"Planck", "[", 
            RowBox[{"Es", ",", 
             RowBox[{"temperature", "[", 
              RowBox[{"\[Tau]", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "2"]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"sc11", "[", 
            RowBox[{"[", "m", "]"}], "]"}], 
           RowBox[{"\[Kappa]t1", "[", 
            RowBox[{"[", "m", "]"}], "]"}]], "*", 
          FractionBox[
           RowBox[{"c", " ", 
            RowBox[{"u1", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], 
           RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"sc12", "[", 
            RowBox[{"[", "m", "]"}], "]"}], 
           RowBox[{"\[Kappa]t1", "[", 
            RowBox[{"[", "m", "]"}], "]"}]], "*", 
          FractionBox[
           RowBox[{"c", " ", 
            RowBox[{"u2", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], 
           RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"S2", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"ff2", "[", 
            RowBox[{"[", "m", "]"}], "]"}], 
           RowBox[{"\[Kappa]t2", "[", 
            RowBox[{"[", "m", "]"}], "]"}]], "*", 
          FractionBox[
           RowBox[{"Planck", "[", 
            RowBox[{"Es", ",", 
             RowBox[{"temperature", "[", 
              RowBox[{"\[Tau]", "[", 
               RowBox[{"[", "m", "]"}], "]"}], "]"}]}], "]"}], "2"]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"sc21", "[", 
            RowBox[{"[", "m", "]"}], "]"}], 
           RowBox[{"\[Kappa]t2", "[", 
            RowBox[{"[", "m", "]"}], "]"}]], "*", 
          FractionBox[
           RowBox[{"c", " ", 
            RowBox[{"u1", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], 
           RowBox[{"4", " ", "\[Pi]"}]]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"sc22", "[", 
            RowBox[{"[", "m", "]"}], "]"}], 
           RowBox[{"\[Kappa]t2", "[", 
            RowBox[{"[", "m", "]"}], "]"}]], "*", 
          FractionBox[
           RowBox[{"c", " ", 
            RowBox[{"u2", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], 
           RowBox[{"4", " ", "\[Pi]"}]]}]}]}], ";"}]}], "\[IndentingNewLine]",
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 CellChangeTimes->{{3.86211717606938*^9, 3.86211717704187*^9}, {
   3.862118778887952*^9, 3.862118786404895*^9}, {3.862200674204689*^9, 
   3.862200723064382*^9}, {3.862201073869687*^9, 3.8622010832143507`*^9}, {
   3.862201211385579*^9, 3.862201219996892*^9}, 3.862202022613443*^9, {
   3.862202107025631*^9, 3.8622021073236113`*^9}, {3.8622855111535482`*^9, 
   3.862285628133222*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"741dba48-168c-4222-a15d-8017a21e0164"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"1.6256548523556635`*^9\\\"}], \\\"]\\\"}]\\) is too small to represent as \
a normalized machine number; precision may be lost.\"", 2, 190, 10, 
   24465684152783220394, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8622012362617903`*^9, 3.862201901272346*^9, 
  3.862202107959249*^9, 3.8622024369168*^9, 3.8622177255588617`*^9, 
  3.862218502077059*^9, 3.86221946224786*^9, 3.862285863626157*^9, 
  3.862286902350731*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[190]:=",ExpressionUUID->"b23ef86b-6856-4a2b-\
aa82-e389ffe5111a"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"1.6256548523556635`*^9\\\"}], \\\"]\\\"}]\\) is too small to represent as \
a normalized machine number; precision may be lost.\"", 2, 190, 11, 
   24465684152783220394, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8622012362617903`*^9, 3.862201901272346*^9, 
  3.862202107959249*^9, 3.8622024369168*^9, 3.8622177255588617`*^9, 
  3.862218502077059*^9, 3.86221946224786*^9, 3.862285863626157*^9, 
  3.862286902391994*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[190]:=",ExpressionUUID->"42c55f0d-3ea6-41ff-\
958c-dd854cdf09b2"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"1.6256548523556635`*^9\\\"}], \\\"]\\\"}]\\) is too small to represent as \
a normalized machine number; precision may be lost.\"", 2, 190, 12, 
   24465684152783220394, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8622012362617903`*^9, 3.862201901272346*^9, 
  3.862202107959249*^9, 3.8622024369168*^9, 3.8622177255588617`*^9, 
  3.862218502077059*^9, 3.86221946224786*^9, 3.862285863626157*^9, 
  3.862286902403903*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[190]:=",ExpressionUUID->"7cc4c076-319f-4994-\
a438-a1c9fe3b6c3b"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 190, 13, 24465684152783220394, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8622012362617903`*^9, 3.862201901272346*^9, 
  3.862202107959249*^9, 3.8622024369168*^9, 3.8622177255588617`*^9, 
  3.862218502077059*^9, 3.86221946224786*^9, 3.862285863626157*^9, 
  3.8622869024145927`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[190]:=",ExpressionUUID->"dbda3717-0498-4e28-\
a70d-b6e156e35cb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I1u", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8621170183224487`*^9, 3.862117046909174*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"7488e431-9cc3-4777-a609-31bf12c2931c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "39117.07574524499`", ",", "15194.370204915138`", ",", 
   "15127.978552765899`", ",", "15136.995618532876`", ",", 
   "15177.681496308142`", ",", "15213.567473248524`", ",", 
   "15189.939244775765`", ",", "15072.538609810415`", ",", 
   "14885.92884648411`", ",", "14713.704285269687`", ",", 
   "14648.884043586704`", ",", "14754.257874257386`", ",", 
   "15052.402385555286`", ",", "15533.728194435871`", ",", 
   "16169.302970252253`", ",", "16921.826390766182`", ",", 
   "17752.995874937013`", ",", "18627.63649460649`", ",", 
   "19515.530734512853`", ",", "20391.810036009767`", ",", 
   "21236.52551067489`", ",", "22033.77472603359`", ",", "22770.56475004134`",
    ",", "23435.419734385956`", ",", "24016.53350581634`", ",", 
   "24498.87294295913`", ",", "24858.582830034244`", ",", 
   "25049.41318521019`", ",", "24959.228370751793`", ",", 
   "24190.54528461338`", ",", "16034.616227449129`"}], "}"}]], "Output",
 CellChangeTimes->{{3.862117025614909*^9, 3.862117047386599*^9}, 
   3.862117231246866*^9, 3.8621191597814703`*^9, 3.8621196873335867`*^9, 
   3.862120343536029*^9, 3.862120880415615*^9, 3.862127402419107*^9, 
   3.8622005697963057`*^9, 3.862200995695158*^9, 3.862201370122973*^9, 
   3.862201990623723*^9, 3.8622021624693213`*^9, 3.862202494585897*^9, 
   3.862217797439095*^9, 3.8622185486562357`*^9, 3.862219507727685*^9, 
   3.862285957380035*^9, 3.862286952088073*^9},
 CellLabel->
  "Out[191]=",ExpressionUUID->"c3f8616e-4906-441c-a121-4d93da86ebb4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I2u", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.86211705892096*^9, 3.862117069068962*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"ee3a3ac3-c5ad-41dc-8f72-0ab0f92c4105"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "32992.950326850376`", ",", "12606.470855139452`", ",", 
   "8527.934309298838`", ",", "6271.518961483349`", ",", "4793.900942020935`",
    ",", "3777.5280613148343`", ",", "3051.3719915036977`", ",", 
   "2517.4519907472463`", ",", "2116.0504656197727`", ",", 
   "1808.8827154736773`", ",", "1570.395019356548`", ",", 
   "1382.9694821132848`", ",", "1234.1362132007366`", ",", 
   "1114.8753567163712`", ",", "1018.5438743665292`", ",", 
   "940.173875660565`", ",", "876.0017044281597`", ",", "823.1442092030759`", 
   ",", "779.3715130788282`", ",", "742.9449699026562`", ",", 
   "712.4996136966381`", ",", "686.9576331144789`", ",", "665.4635985853238`",
    ",", "647.3343056814301`", ",", "632.0168798692416`", ",", 
   "619.0463987928806`", ",", "607.9846044678815`", ",", "598.288513345187`", 
   ",", "588.95133479724`", ",", "577.5458330116595`", ",", 
   "556.83978017215`"}], "}"}]], "Output",
 CellChangeTimes->{{3.86211706388507*^9, 3.862117069430592*^9}, 
   3.8621172342615633`*^9, 3.86211916413433*^9, 3.862119693236929*^9, 
   3.862120347570086*^9, 3.8621208868979893`*^9, 3.8621274060192747`*^9, 
   3.862200580632661*^9, 3.862200999756854*^9, 3.8622024989895678`*^9, 
   3.862217809771996*^9, 3.862218548663431*^9, 3.862219507745672*^9, 
   3.862285964982525*^9, 3.862286955503076*^9},
 CellLabel->
  "Out[192]=",ExpressionUUID->"3b6aa3be-8fe4-43a3-a54b-a8e385d6a659"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"I1u", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], "+", 
    RowBox[{"I2u", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], 
  RowBox[{"Cos", "[", "\[Theta]x", "]"}]}]], "Input",
 CellChangeTimes->{{3.8621173839540586`*^9, 3.862117410643417*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"f70e04bd-6406-46c7-80f7-1035d9ee9434"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "72110.02606111238`", ",", "27762.801049639238`", ",", 
   "23526.570612154097`", ",", "21145.47188293326`", ",", 
   "19536.058463639754`", ",", "18345.347246760044`", ",", 
   "17350.405877927955`", ",", "16424.15244066085`", ",", 
   "15535.209410346157`", ",", "14725.566811304992`", ",", 
   "14050.92905346847`", ",", "13539.34233736782`", ",", 
   "13182.666347839195`", ",", "12946.211870235544`", ",", 
   "12782.315591907227`", ",", "12641.248630747174`", ",", 
   "12478.001000655937`", ",", "12255.60281598505`", ",", 
   "11946.117008844392`", ",", "11530.285066722328`", ",", 
   "10996.511909188841`", ",", "10339.616104373983`", ",", 
   "9559.586768696627`", ",", "8660.472368573279`", ",", "7649.463165415341`",
    ",", "6536.206179516998`", ",", "5332.412498297315`", ",", 
   "4051.926638918007`", ",", "2711.8681793658616`", ",", 
   "1337.975736275142`", ",", "28.95753880165454`"}], "}"}]], "Output",
 CellChangeTimes->{{3.862117388303362*^9, 3.862117411893095*^9}, 
   3.862119171817377*^9, 3.862119695985281*^9, 3.862120352439927*^9, 
   3.862120890271472*^9, 3.862127408853621*^9, 3.86220058337039*^9, 
   3.8622010024385443`*^9, 3.862202502380629*^9, 3.862217814053358*^9, 
   3.8622185486975203`*^9, 3.862219507777314*^9, 3.862285967602833*^9, 
   3.8622869580892553`*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"8d0c8b24-9366-4a5d-8f57-02984215c4e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{"\[Theta]x", ",", 
      RowBox[{"I1u", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], ",", 
      RowBox[{"I2u", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<first.dat\>\"", ",", "data"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8621174636281652`*^9, 3.86211753426136*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"31a3e6ac-6c59-444d-ad5e-bf850d447f99"],

Cell[BoxData["\<\"/Users/yonggao/Desktop/paper_calc/X-ray\"\>"], "Output",
 CellChangeTimes->{3.862117534533361*^9, 3.862119183656598*^9, 
  3.862119705358273*^9, 3.862120357977948*^9, 3.862120902919289*^9, 
  3.862127415952503*^9, 3.862137233626828*^9, 3.8622005901580153`*^9, 
  3.8622010067608843`*^9, 3.8622025046492357`*^9, 3.862217822075321*^9, 
  3.862218548733214*^9, 3.862219507789637*^9, 3.862285976329885*^9},
 CellLabel->
  "Out[156]=",ExpressionUUID->"06a34b04-bbd5-41ac-9fff-e0aaae2e7506"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"x", "\[GreaterEqual]", "4"}], ",", 
   RowBox[{
    RowBox[{"y", "=", "x"}], ";", 
    RowBox[{"z", "=", 
     RowBox[{"x", "+", "1"}]}]}], ",", 
   RowBox[{
    RowBox[{"y", "=", 
     RowBox[{"x", "+", "1"}]}], ";", 
    RowBox[{"z", "=", "x"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.862281309319003*^9, 3.862281315421176*^9}, {
   3.862281404511382*^9, 3.8622814254144497`*^9}, {3.8622814815266647`*^9, 
   3.86228153311377*^9}, 3.862281564095739*^9},
 CellLabel->
  "In[226]:=",ExpressionUUID->"a8bc07a6-d420-4ba1-8c90-bb805d78a07d"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.862281314246524*^9, {3.862281520919917*^9, 3.862281533818099*^9}, 
   3.862281564486724*^9},
 CellLabel->
  "Out[229]=",ExpressionUUID->"a9706180-e105-4746-8481-12e526a5bf72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["z"], "Input",
 CellChangeTimes->{{3.8622815691183987`*^9, 3.862281573652156*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"ea36276c-e31b-4058-8cd2-8f963f2c17ae"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.862281569541937*^9, 3.862281574016718*^9}},
 CellLabel->
  "Out[231]=",ExpressionUUID->"bd5a3b76-4e52-4308-b0f0-9c7640bbe8fc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1290, 811},
WindowMargins->{{0, Automatic}, {Automatic, 180}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) \
(2020\:5e743\:670813\:65e5)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Report"}, "StandardReport.nb", CharacterEncoding -> 
       "UTF-8"]]], 
   Cell[
    StyleData["Input"], FontSize -> 24], 
   Cell[
    StyleData["Output"], FontSize -> 24], 
   Cell[
    StyleData["Text"], FontSize -> 24]}, 
  WindowMargins -> {{316, Automatic}, {-80, Automatic}}, Visible -> False, 
  FrontEndVersion -> 
  "12.1 for Mac OS X x86 (64-bit) (2020\:5e743\:670813\:65e5)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"11b09b82-8214-49ec-aea7-f7fca90ff1d5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 283, 4, 97, "Title",ExpressionUUID->"85ee1e26-2fae-4e19-98ad-c5d22ed128fd"],
Cell[CellGroupData[{
Cell[888, 30, 281, 4, 69, "Section",ExpressionUUID->"1409faf0-fa3b-48b9-b0fe-28cdb8fefba3"],
Cell[1172, 36, 5027, 158, 1127, "Input",ExpressionUUID->"a36d15ba-8ec5-4d46-843a-f18f6d2fab97"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6236, 199, 166, 3, 69, "Section",ExpressionUUID->"01ed5fe8-1806-4689-902c-6ccdd2a3b8df"],
Cell[CellGroupData[{
Cell[6427, 206, 3854, 94, 885, "Input",ExpressionUUID->"c532bf20-f6b3-406c-9708-12145a47ac2b"],
Cell[10284, 302, 16546, 326, 576, "Output",ExpressionUUID->"cff9bc3e-9a0d-444a-8024-91a6d8904787"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26879, 634, 159, 3, 69, "Section",ExpressionUUID->"e66a0de1-3c1c-49b8-83a7-4953f4343738"],
Cell[27041, 639, 26153, 698, 5658, "Input",ExpressionUUID->"0c32b016-d668-47dd-b836-94deef2c4550"],
Cell[CellGroupData[{
Cell[53219, 1341, 411, 8, 60, "Input",ExpressionUUID->"61f5cb0d-5c62-4e8f-80b5-32006e62f784"],
Cell[53633, 1351, 791, 14, 60, "Output",ExpressionUUID->"fbcc22e1-a4b6-491a-95d8-b56954c4f7e1"]
}, Open  ]],
Cell[54439, 1368, 40052, 1080, 6582, "Input",ExpressionUUID->"b31cc2f8-e8a2-4e8c-92c4-e986fc8dfa24"],
Cell[CellGroupData[{
Cell[94516, 2452, 770, 19, 121, "Input",ExpressionUUID->"956783e7-4737-4fb3-a4ba-dfae4a63e2b5"],
Cell[95289, 2473, 932, 16, 60, "Output",ExpressionUUID->"78867bc9-2a89-4f69-ac07-6a0416943b13"],
Cell[96224, 2491, 695, 13, 95, "Output",ExpressionUUID->"68477877-6ff0-4be6-9472-90d722710a54"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96968, 2510, 164, 3, 69, "Section",ExpressionUUID->"750a1e48-a2d7-415c-91e7-b6eab27e8bb3"],
Cell[97135, 2515, 28072, 770, 5219, "Input",ExpressionUUID->"441ad3d1-55e4-45f4-b2c4-36afd192e5bf"],
Cell[CellGroupData[{
Cell[125232, 3289, 365, 9, 77, "Input",ExpressionUUID->"910bc1cd-483a-4bbf-ab87-bc23b4d0eca6"],
Cell[125600, 3300, 390, 9, 55, "Output",ExpressionUUID->"890485f8-9aae-4d99-bb8a-34f4e4ae1617"]
}, Open  ]],
Cell[126005, 3312, 27547, 757, 5040, "Input",ExpressionUUID->"e0a3b7db-d3d8-4b8b-8200-daca4cb5096d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153589, 4074, 161, 3, 69, "Section",ExpressionUUID->"6670b494-a3c8-4fb5-a991-dce31b98d1ed"],
Cell[153753, 4079, 10085, 285, 2260, "Input",ExpressionUUID->"22914adb-9b21-4244-8aa6-4c18220b252f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163875, 4369, 164, 3, 69, "Section",ExpressionUUID->"915f5a80-a629-4723-82a6-1bdb230f2708"],
Cell[164042, 4374, 8435, 244, 1851, "Input",ExpressionUUID->"dac479d8-99b9-4857-842f-02ffce54d0db"],
Cell[172480, 4620, 6516, 181, 1114, "Input",ExpressionUUID->"c8e58968-f91f-4ee3-a0b6-5085db58a74e"],
Cell[CellGroupData[{
Cell[179021, 4805, 21832, 547, 3114, "Input",ExpressionUUID->"741dba48-168c-4222-a15d-8017a21e0164"],
Cell[200856, 5354, 681, 14, 31, "Message",ExpressionUUID->"b23ef86b-6856-4a2b-aa82-e389ffe5111a"],
Cell[201540, 5370, 681, 14, 31, "Message",ExpressionUUID->"42c55f0d-3ea6-41ff-958c-dd854cdf09b2"],
Cell[202224, 5386, 681, 14, 31, "Message",ExpressionUUID->"7cc4c076-319f-4994-a438-a1c9fe3b6c3b"],
Cell[202908, 5402, 646, 13, 24, "Message",ExpressionUUID->"dbda3717-0498-4e28-a70d-b6e156e35cb9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203591, 5420, 249, 6, 55, "Input",ExpressionUUID->"7488e431-9cc3-4777-a609-31bf12c2931c"],
Cell[203843, 5428, 1527, 26, 170, "Output",ExpressionUUID->"c3f8616e-4906-441c-a121-4d93da86ebb4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205407, 5459, 246, 6, 55, "Input",ExpressionUUID->"ee3a3ac3-c5ad-41dc-8f72-0ab0f92c4105"],
Cell[205656, 5467, 1433, 24, 170, "Output",ExpressionUUID->"3b6aa3be-8fe4-43a3-a54b-a8e385d6a659"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207126, 5496, 440, 13, 80, "Input",ExpressionUUID->"f70e04bd-6406-46c7-80f7-1035d9ee9434"],
Cell[207569, 5511, 1426, 25, 205, "Output",ExpressionUUID->"8d0c8b24-9366-4a5d-8f57-02984215c4e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209032, 5541, 724, 20, 208, "Input",ExpressionUUID->"31a3e6ac-6c59-444d-ad5e-bf850d447f99"],
Cell[209759, 5563, 503, 7, 108, "Output",ExpressionUUID->"06a34b04-bbd5-41ac-9fff-e0aaae2e7506"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210299, 5575, 806, 22, 194, "Input",ExpressionUUID->"a8bc07a6-d420-4ba1-8c90-bb805d78a07d"],
Cell[211108, 5599, 228, 5, 55, "Output",ExpressionUUID->"a9706180-e105-4746-8481-12e526a5bf72"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211373, 5609, 178, 3, 55, "Input",ExpressionUUID->"ea36276c-e31b-4058-8cd2-8f963f2c17ae"],
Cell[211554, 5614, 177, 3, 108, "Output",ExpressionUUID->"bd5a3b76-4e52-4308-b0f0-9c7640bbe8fc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

