(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45050,       1271]
NotebookOptionsPosition[     44187,       1242]
NotebookOutlinePosition[     45066,       1272]
CellTagsIndexPosition[     45023,       1269]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"hbar", "=", 
   RowBox[{"1.0545718176461565", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "27"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"e", "=", 
   RowBox[{"4.803204712570263", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "10"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"me", "=", 
   RowBox[{"9.1093837015", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "28"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c", "=", "29979245800.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kb", "=", 
   RowBox[{"1.380649", "*", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "16"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kev2erg", "=", 
   RowBox[{"1.6021766339999998", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mp", "=", 
   RowBox[{"1.67262192369", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "24"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"6.674299999999999", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "8"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Ms", "=", 
   RowBox[{"1.988409870698051", "*", 
    RowBox[{"10", "^", "33"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]T", "=", 
   RowBox[{"6.65", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "25"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Kappa]T", "=", 
   RowBox[{"\[Sigma]T", "/", "mp"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"logspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"10.0", "^", 
    RowBox[{"Range", "[", 
     RowBox[{"a", ",", "b", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"linearspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Range", "[", 
    RowBox[{"a", ",", "b", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", "-", "a"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Planck", "[", 
     RowBox[{"Es_", ",", "T_"}], "]"}], ":=", 
    RowBox[{"2", "*", "hbar", "*", "2", "*", "\[Pi]", "*", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Es", "*", 
         RowBox[{
          RowBox[{
           RowBox[{"kev2erg", "/", "hbar"}], "/", "2"}], "/", "\[Pi]"}]}], 
        ")"}], "^", "3"}], "/", 
      RowBox[{"c", "^", "2"}]}], "*", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Es", "*", "kev2erg"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"kb", "*", "T"}], ")"}]}], "]"}], "-", "1"}], ")"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C0", "[", "a_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"1", "/", "a"}], "-", 
    RowBox[{
     RowBox[{"Exp", "[", "a", "]"}], "*", 
     RowBox[{"ExpIntegralE", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"C1", "[", "a_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "a"}], ")"}], "*", 
     RowBox[{"Exp", "[", "a", "]"}], "*", 
     RowBox[{"ExpIntegralE", "[", 
      RowBox[{"1", ",", "a"}], "]"}]}], "-", "1"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"freeopacity", "[", 
    RowBox[{"B_", ",", "Es_", ",", "\[Tau]_", ",", "\[Theta]b_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Epsilon]p", ",", "\[Eta]p", ",", "\[Epsilon]", ",", "\[Eta]", ",", 
       "g", ",", "Z", ",", "A", ",", "Ye", ",", "M", ",", "Ec", ",", 
       "\[Omega]", ",", "\[Omega]c", ",", "Ece", ",", "Epi", ",", "Eci", ",", 
       "Epe", ",", "ue", ",", "ui", ",", "ve", ",", "vi", ",", "\[Gamma]re", 
       ",", "\[Gamma]ri", ",", "r1", ",", "r2", ",", "\[Gamma]eiL", ",", 
       "\[Gamma]eip", ",", "\[Epsilon]pg", ",", "\[Epsilon]mg", ",", 
       "\[Alpha]F", ",", "BQ", ",", "b", ",", "a", ",", "q", ",", "m", ",", 
       "r", ",", "\[Beta]", ",", "K1", ",", "K2", ",", "Kz1", ",", "Kz2", ",",
        "ep1", ",", "ep2", ",", "em1", ",", "em2", ",", "e01", ",", "e02", 
       ",", "\[Gamma]p", ",", "\[Gamma]m", ",", "\[CapitalLambda]p", ",", 
       "\[CapitalLambda]m", ",", "\[Kappa]p", ",", "\[Kappa]m", ",", 
       "\[Kappa]o", ",", "\[Kappa]ff1", ",", "\[Kappa]ff2", ",", "\[Tau]mid", 
       ",", "x", ",", "Mns", ",", "Rns", ",", "gns", ",", "\[Rho]", ",", "T", 
       ",", "gp", ",", "gl"}], "}"}], ",", "\n", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Z", "=", "1"}], ";", 
      RowBox[{"A", "=", "1"}], ";", 
      RowBox[{"Ye", "=", 
       RowBox[{"Z", "/", "A"}]}], ";", 
      RowBox[{"M", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Z", " ", "me"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"A", " ", "mp"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]mid", "=", "63.2"}], ";", "\n", 
      RowBox[{"a1", "=", "0.761"}], ";", "\n", 
      RowBox[{"a2", "=", " ", "0.00198"}], ";", "\n", 
      RowBox[{"a3", "=", "0.267"}], ";", "\n", 
      RowBox[{"a4", "=", 
       RowBox[{"\[Minus]", "0.356"}]}], ";", "\n", 
      RowBox[{"a5", "=", " ", "0.179"}], ";", "\n", 
      RowBox[{"a6", "=", 
       RowBox[{"\[Minus]", "0.0282"}]}], ";", "\n", 
      RowBox[{"b3", "=", 
       RowBox[{"\[Minus]", "0.118"}]}], ";", "\n", 
      RowBox[{"b4", "=", 
       RowBox[{"\[Minus]", "0.0336"}]}], ";", "\n", 
      RowBox[{"b5", "=", 
       RowBox[{"\[Minus]", "0.00428"}]}], ";", "\n", 
      RowBox[{"b6", "=", 
       RowBox[{"\[Minus]", "0.00022"}]}], ";", "\n", 
      RowBox[{"x", "=", 
       RowBox[{
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]"}], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", "\n", 
      RowBox[{"T", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"10", "^", "6"}], "*", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"a1", "+", 
                 RowBox[{"a2", "*", "x"}], "+", 
                 RowBox[{"a3", "*", 
                  RowBox[{"x", "^", "2"}]}], "+", 
                 RowBox[{"a4", "*", 
                  RowBox[{"x", "^", "3"}]}], "+", 
                 RowBox[{"a5", "*", 
                  RowBox[{"x", "^", "4"}]}], "+", 
                 RowBox[{"a6", "*", 
                  RowBox[{"x", "^", "5"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"\[Tau]", ">", "\[Tau]mid"}], " ", "&&", " ", 
             RowBox[{"\[Tau]", "<=", 
              RowBox[{"2", "*", 
               RowBox[{"10", "^", "4"}]}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"10", "^", "6"}], "*", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"a1", "+", 
                 RowBox[{"a2", "*", "x"}], "+", 
                 RowBox[{"b3", "*", 
                  RowBox[{"x", "^", "2"}]}], "+", 
                 RowBox[{"b4", "*", 
                  RowBox[{"x", "^", "3"}]}], "+", 
                 RowBox[{"b5", "*", 
                  RowBox[{"x", "^", "4"}]}], "+", 
                 RowBox[{"b6", "*", 
                  RowBox[{"x", "^", "5"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"\[Tau]", "<=", " ", "\[Tau]mid"}], " ", "&&", " ", 
             RowBox[{"\[Tau]", ">=", " ", 
              RowBox[{"10", "^", 
               RowBox[{"-", "3"}]}]}]}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mns", "=", 
       RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rns", "=", 
       SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gns", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"G", "*", "Mns"}], 
         SuperscriptBox["Rns", "2"]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", "G", " ", "Mns"}], 
            RowBox[{"Rns", " ", 
             SuperscriptBox["c", "2"]}]]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", 
       RowBox[{"mp", "*", 
        FractionBox["gns", 
         RowBox[{"2", "*", "\[Kappa]T", "*", "kb", "*", "T"}]], "*", 
        "\[Tau]"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"Ec", "=", 
       RowBox[{"Es", "*", "kev2erg"}]}], ";", "\n", 
      RowBox[{"\[Omega]", "=", 
       RowBox[{"Ec", "/", "hbar"}]}], ";", "\n", 
      RowBox[{"\[Omega]c", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "B"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"me", " ", "c"}], ")"}]}]}], ";", "\n", 
      RowBox[{"Ece", "=", 
       RowBox[{"hbar", "*", 
        RowBox[{"\[Omega]c", "/", "kev2erg"}]}]}], ";", 
      RowBox[{"Eci", "=", 
       RowBox[{"Ece", "*", "M"}]}], ";", 
      RowBox[{"Epe", "=", 
       RowBox[{"hbar", "*", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "*", "\[Pi]", "*", 
            RowBox[{"\[Rho]", "/", "mp"}], " ", "*", " ", "Ye", " ", "*", " ", 
            RowBox[{
             RowBox[{"e", "^", "2"}], "/", "me"}]}], ")"}], "^", "0.5"}], "/",
          "kev2erg"}]}]}], ";", "\n", 
      RowBox[{"Epi", "=", 
       RowBox[{
        RowBox[{"M", "^", "0.5"}], "*", "Epe"}]}], ";", "\n", 
      RowBox[{"ue", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ece", "/", "Es"}], ")"}], "^", "2"}]}], ";", 
      RowBox[{"ui", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Eci", "/", "Es"}], ")"}], "^", "2"}]}], ";", 
      RowBox[{"ve", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Epe", "/", "Es"}], ")"}], "^", "2"}]}], ";", 
      RowBox[{"vi", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Epi", "/", "Es"}], ")"}], "^", "2"}]}], ";", "\n", 
      RowBox[{"\[Gamma]re", "=", 
       RowBox[{"9.5", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}], "*", 
        RowBox[{"Es", "/", "1"}]}]}], ";", "\n", 
      RowBox[{"\[Gamma]ri", "=", 
       RowBox[{"5.2", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}], "*", 
        RowBox[{
         RowBox[{"Z", "^", "2"}], "/", "A"}], "*", 
        RowBox[{"Es", "/", "1"}]}]}], ";", "\n", 
      RowBox[{"r1", "=", 
       RowBox[{"hbar", "*", 
        RowBox[{"\[Omega]c", "/", 
         RowBox[{"(", 
          RowBox[{"kb", "*", "T"}], ")"}]}]}]}], ";", "\n", 
      RowBox[{"r2", "=", 
       RowBox[{"\[Omega]", "/", "\[Omega]c"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gl", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "r1"}], "*", "r2", "*", 
            RowBox[{
             RowBox[{"Sinh", "[", "x", "]"}], "^", "2"}]}], "]"}], "*", 
          RowBox[{"C1", "[", 
           RowBox[{"r2", "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "x"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{"gp", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "r1"}], "*", "r2", "*", 
            RowBox[{
             RowBox[{"Sinh", "[", "x", "]"}], "^", "2"}]}], "]"}], "*", "2", 
          "*", "r2", "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"2", "x"}], "]"}], 
          RowBox[{"C0", "[", 
           RowBox[{"r2", "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "x"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{"\[Gamma]eiL", "=", 
       RowBox[{"9.24", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "5"}]}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Z", "^", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{"\[Rho]", "/", "1"}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"A", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"T", "/", 
              RowBox[{"10", "^", "6"}]}], ")"}], "^", "0.5"}], " ", 
           RowBox[{"Es", "^", "2"}]}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "Ec"}], "/", 
            RowBox[{"(", 
             RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gl"}]}],
       ";", "\n", 
      RowBox[{"\[Gamma]eip", "=", 
       RowBox[{"9.24", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "5"}]}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Z", "^", "2"}], "*", 
           RowBox[{"(", 
            RowBox[{"\[Rho]", "/", "1"}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"A", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"T", "/", 
              RowBox[{"10", "^", "6"}]}], ")"}], "^", "0.5"}], " ", 
           RowBox[{"Es", "^", "2"}]}], ")"}]}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "Ec"}], "/", 
            RowBox[{"(", 
             RowBox[{"kb", "*", "T"}], ")"}]}], "]"}]}], ")"}], "*", "gp"}]}],
       ";", "\n", "\n", 
      RowBox[{"\[Epsilon]pg", "=", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ve", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
           RowBox[{"vi", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", "*", "\[Gamma]re"}], "+", 
              RowBox[{"ue", "^", "0.5"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", "*", "\[Gamma]ri"}], "-", 
              RowBox[{"ui", "^", "0.5"}]}], ")"}]}], "+", 
           RowBox[{"I", "*", "\[Gamma]eiL"}]}], ")"}]}]}]}], ";", "\n", 
      RowBox[{"\[Epsilon]mg", "=", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ve", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", " ", "*", " ", "\[Gamma]ri"}]}], ")"}]}], "+", 
           RowBox[{"vi", "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", "*", "\[Gamma]re"}]}], ")"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", "*", "\[Gamma]re"}], "-", 
              RowBox[{"ue", "^", "0.5"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", "*", "\[Gamma]ri"}], "+", 
              RowBox[{"ui", "^", "0.5"}]}], ")"}]}], "+", 
           RowBox[{"I", "*", "\[Gamma]eiL"}]}], ")"}]}]}]}], ";", "\n", 
      RowBox[{"\[Epsilon]p", "=", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]pg", "+", "\[Epsilon]mg"}], ")"}]}]}], ";", "\n", 
      
      RowBox[{"g", "=", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]pg", "-", "\[Epsilon]mg"}], ")"}]}]}], ";", "\n", 
      
      RowBox[{"\[Eta]p", "=", 
       RowBox[{"1", "-", 
        RowBox[{"ve", "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"I", "*", 
            RowBox[{"(", 
             RowBox[{"\[Gamma]eip", "+", "\[Gamma]re"}], ")"}]}]}], ")"}]}], 
        "-", 
        RowBox[{"vi", "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"I", "*", 
            RowBox[{"(", 
             RowBox[{"\[Gamma]eip", "+", "\[Gamma]ri"}], ")"}]}]}], 
          ")"}]}]}]}], ";", "\n", "\n", 
      RowBox[{"\[Alpha]F", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"e", "^", "2"}], "/", "hbar"}], "/", "c"}]}], ";", "\n", 
      RowBox[{"BQ", "=", 
       RowBox[{
        RowBox[{"me", "^", "2"}], "*", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "^", "3"}], "/", "e"}], "/", "hbar"}]}]}], ";", "\n", 
      RowBox[{"b", "=", 
       RowBox[{"B", "/", "BQ"}]}], ";", "\n", 
      RowBox[{"a", "=", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"\[Alpha]F", "/", 
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"1.195", "-", 
           RowBox[{
            RowBox[{"2", "/", "3"}], " ", 
            RowBox[{"Log", "[", "b", "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", "b"}], " ", 
            RowBox[{"(", 
             RowBox[{"0.8553", "+", 
              RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"2", 
              RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ";", "\n", 
      RowBox[{"q", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]F", "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}]}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"2", "/", "3"}], ")"}]}], "b"}], "+", "1.272", "-", 
          RowBox[{
           RowBox[{"1", "/", "b"}], " ", 
           RowBox[{"(", 
            RowBox[{"0.3070", "+", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          RowBox[{"0.7003", " ", 
           RowBox[{"1", "/", 
            RowBox[{"b", "^", "2"}]}]}]}], ")"}]}]}], ";", "\n", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]F", "/", 
           RowBox[{"(", 
            RowBox[{"2", "\[Pi]"}], ")"}]}], ")"}]}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "/", "3"}], "+", 
          RowBox[{
           RowBox[{"1", "/", "b"}], " ", 
           RowBox[{"(", 
            RowBox[{"0.1447", "-", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          RowBox[{"1", "/", 
           RowBox[{"b", "^", "2"}]}]}], ")"}]}]}], ";", "\n", 
      RowBox[{"\[Epsilon]", "=", 
       RowBox[{"\[Epsilon]p", "+", "a", "-", "1"}]}], ";", "\n", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"\[Eta]p", "+", "a", "+", "q", "-", "1"}]}], ";", "\n", 
      RowBox[{"r", "=", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"m", "/", "a"}], " ", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "^", "2"}]}]}]}], ";", "\n", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Epsilon]", "^", "2"}], "-", 
             RowBox[{"g", "^", "2"}], "-", 
             RowBox[{"\[Epsilon]", " ", "*", "\[Eta]", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"m", "/", "a"}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "g", " ", "\[Eta]"}], ")"}]}], ")"}]}], "*", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]b", "]"}], "^", "2"}], "/", 
         RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}]}], ";", "\n", 
      RowBox[{"K1", "=", 
       RowBox[{"\[Beta]", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"r", "/", 
              RowBox[{"\[Beta]", "^", "2"}]}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ";", "\n", 
      RowBox[{"K2", "=", 
       RowBox[{"\[Beta]", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"r", "/", 
              RowBox[{"\[Beta]", "^", "2"}]}]}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}]}], ")"}]}]}], ";", "\n", 
      RowBox[{"Kz1", "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K1"}], " ", "+", " ", 
            RowBox[{"g", " ", "*", " ", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]p", "*", 
             RowBox[{
              RowBox[{"Sin", "[", "\[Theta]b", "]"}], "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]b", "]"}], "^", "2"}]}], "+", "a", 
            "-", "1"}], ")"}]}], ")"}]}]}], ";", "\n", "\n", 
      RowBox[{"Kz2", "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Epsilon]p", "-", "\[Eta]p", "-", "q"}], ")"}], "*", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}], 
             RowBox[{"Cos", "[", "\[Theta]b", "]"}], "K2"}], " ", "+", " ", 
            RowBox[{"g", " ", "*", " ", 
             RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Epsilon]p", "*", 
             RowBox[{
              RowBox[{"Sin", "[", "\[Theta]b", "]"}], "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Eta]p", "+", "q"}], ")"}], 
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]b", "]"}], "^", "2"}]}], "+", "a", 
            "-", "1"}], ")"}]}], ")"}]}]}], ";", "\n", 
      RowBox[{"ep1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"1", "+", 
           RowBox[{"K1", "*", 
            RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
           RowBox[{"Kz1", "*", 
            RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "^", "2"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"Abs", "[", "K1", "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"Abs", "[", "Kz1", "]"}], "^", "2"}]}], ")"}]}], 
         ")"}]}]}], ";", "\n", 
      RowBox[{"ep2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"1", "+", 
           RowBox[{"K2", "*", 
            RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
           RowBox[{"Kz2", "*", 
            RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], "]"}], "^", "2"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"Abs", "[", "K2", "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"Abs", "[", "Kz2", "]"}], "^", "2"}]}], ")"}]}], 
         ")"}]}]}], ";", "\n", 
      RowBox[{"em1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"K1", "*", 
              RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
             RowBox[{"Kz1", "*", 
              RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "^",
          "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"Abs", "[", "K1", "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"Abs", "[", "Kz1", "]"}], "^", "2"}]}], ")"}]}], 
         ")"}]}]}], ";", "\n", 
      RowBox[{"em2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"K2", "*", 
              RowBox[{"Cos", "[", "\[Theta]b", "]"}]}], "+", 
             RowBox[{"Kz2", "*", 
              RowBox[{"Sin", "[", "\[Theta]b", "]"}]}]}], ")"}]}], "]"}], "^",
          "2"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"Abs", "[", "K2", "]"}], "^", "2"}], "+", 
            RowBox[{
             RowBox[{"Abs", "[", "Kz2", "]"}], "^", "2"}]}], ")"}]}], 
         ")"}]}]}], ";", "\n", 
      RowBox[{"e01", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"K1", " ", "*", " ", 
            RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
           RowBox[{"Kz1", "*", 
            RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "^", "2"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"Abs", "[", "K1", "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"Abs", "[", "Kz1", "]"}], "^", "2"}]}], ")"}]}]}], ";", 
      "\n", 
      RowBox[{"e02", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"K2", " ", "*", " ", 
            RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "-", 
           RowBox[{"Kz2", "*", 
            RowBox[{"Cos", "[", "\[Theta]b", "]"}]}]}], "]"}], "^", "2"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"Abs", "[", "K2", "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"Abs", "[", "Kz2", "]"}], "^", "2"}]}], ")"}]}]}], ";", 
      "\n", 
      RowBox[{"\[Gamma]p", "=", 
       RowBox[{"\[Gamma]eiL", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"ue", "^", "0.5"}]}], ")"}], "\[Gamma]ri"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ui", "^", "0.5"}]}], ")"}], "\[Gamma]re"}]}]}], ";", "\n",
       "\n", 
      RowBox[{"\[Gamma]m", "=", 
       RowBox[{"\[Gamma]eiL", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ue", "^", "0.5"}]}], ")"}], "\[Gamma]ri"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"ui", "^", "0.5"}]}], ")"}], "\[Gamma]re"}]}]}], ";", "\n", 
      RowBox[{"\[CapitalLambda]p", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"ue", "^", "0.5"}]}], ")"}], "^", "2"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ui", "^", "0.5"}]}], ")"}], "^", "2"}]}], "+", 
          RowBox[{"\[Gamma]p", "^", "2"}]}], ")"}], "^", 
        RowBox[{"-", "1"}]}]}], ";", "\n", 
      RowBox[{"\[CapitalLambda]m", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ue", "^", "0.5"}]}], ")"}], "^", "2"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"ui", "^", "0.5"}]}], ")"}], "^", "2"}]}], "+", 
          RowBox[{"\[Gamma]m", "^", "2"}]}], ")"}], "^", 
        RowBox[{"-", "1"}]}]}], ";", "\n", 
      RowBox[{"\[Kappa]p", "=", 
       RowBox[{
        RowBox[{"Ec", "/", 
         RowBox[{"(", 
          RowBox[{"hbar", " ", "c", " ", "\[Rho]"}], ")"}]}], " ", "ve", " ", 
        "\[CapitalLambda]p", " ", "\[Gamma]eiL"}]}], ";", "\n", 
      RowBox[{"\[Kappa]m", "=", 
       RowBox[{
        RowBox[{"Ec", "/", 
         RowBox[{"(", 
          RowBox[{"hbar", " ", "c", " ", "\[Rho]"}], ")"}]}], " ", "ve", " ", 
        "\[CapitalLambda]m", " ", "\[Gamma]eiL"}]}], ";", "\n", 
      RowBox[{"\[Kappa]o", "=", 
       RowBox[{
        RowBox[{"Ec", "/", 
         RowBox[{"(", 
          RowBox[{"hbar", " ", "c", " ", "\[Rho]"}], ")"}]}], " ", "ve", " ", 
        "\[Gamma]eip"}]}], ";", "\n", "\n", 
      RowBox[{"\[Kappa]ff1", "=", 
       RowBox[{
        RowBox[{"\[Kappa]p", "*", "ep1"}], " ", "+", " ", 
        RowBox[{"\[Kappa]m", "*", "em1"}], " ", "+", " ", 
        RowBox[{"\[Kappa]o", "*", "e01"}]}]}], ";", "\n", 
      RowBox[{"\[Kappa]ff2", "=", 
       RowBox[{
        RowBox[{"\[Kappa]p", "*", "ep2"}], " ", "+", " ", 
        RowBox[{"\[Kappa]m", "*", "em2"}], "+", " ", 
        RowBox[{"\[Kappa]o", "*", "e02"}]}]}], ";", "\n", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]ff1", ",", "\[Kappa]ff2"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temperature", "[", "\[Tau]1_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Tau]mid", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Tau]mid", "=", "63.2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a1", "=", "0.761"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a2", "=", " ", "0.00198"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a3", "=", "0.267"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a4", "=", 
        RowBox[{"\[Minus]", "0.356"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a5", "=", " ", "0.179"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a6", "=", 
        RowBox[{"\[Minus]", "0.0282"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b3", "=", 
        RowBox[{"\[Minus]", "0.118"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b4", "=", 
        RowBox[{"\[Minus]", "0.0336"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b5", "=", 
        RowBox[{"\[Minus]", "0.00428"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b6", "=", 
        RowBox[{"\[Minus]", "0.00022"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]1"}], "]"}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]mid"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{
              SuperscriptBox["10", "6"], "*", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"a1", "+", 
                 RowBox[{"a2", "*", "x"}], "+", 
                 RowBox[{"a3", "*", 
                  SuperscriptBox["x", "2"]}], "+", 
                 RowBox[{"a4", "*", 
                  SuperscriptBox["x", "3"]}], "+", 
                 RowBox[{"a5", "*", 
                  SuperscriptBox["x", "4"]}], "+", 
                 RowBox[{"a6", "*", 
                  SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"\[Tau]1", ">", "\[Tau]mid"}], " ", "&&", " ", 
             RowBox[{"\[Tau]1", "\[LessEqual]", 
              RowBox[{"2", "*", 
               SuperscriptBox["10", "4"]}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{
              SuperscriptBox["10", "6"], "*", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"a1", "+", 
                 RowBox[{"a2", "*", "x"}], "+", 
                 RowBox[{"b3", "*", 
                  SuperscriptBox["x", "2"]}], "+", 
                 RowBox[{"b4", "*", 
                  SuperscriptBox["x", "3"]}], "+", 
                 RowBox[{"b5", "*", 
                  SuperscriptBox["x", "4"]}], "+", 
                 RowBox[{"b6", "*", 
                  SuperscriptBox["x", "5"]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"\[Tau]1", "\[LessEqual]", " ", "\[Tau]mid"}], " ", "&&",
              " ", 
             RowBox[{"\[Tau]1", "\[GreaterEqual]", " ", 
              SuperscriptBox["10", 
               RowBox[{"-", "3"}]]}]}]}], "}"}]}], "}"}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]reson", "[", 
    RowBox[{"Es_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q", ",", "m", ",", "\[Alpha]F", ",", "\[Omega]c", ",", "Ebi", ",", "M",
        ",", "R", ",", "Ead", ",", "Z", ",", "A", ",", "Ye", ",", "BQ", ",", 
       "b", ",", "\[Delta]v", ",", "fB", ",", "g", ",", "\[Rho]v", ",", 
       "\[Tau]v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Z", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ye", "=", 
       RowBox[{"Z", "/", "A"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]F", "=", 
       RowBox[{
        RowBox[{
         SuperscriptBox["e", "2"], "/", "hbar"}], "/", "c"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BQ", "=", 
       RowBox[{
        SuperscriptBox["me", "2"], "*", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "3"], "/", "e"}], "/", "hbar"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"B", "/", "BQ"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Alpha]F", 
          RowBox[{"2", "\[Pi]"}]]}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["2", "3"]}], "b"}], "+", "1.272", "-", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.3070", "+", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          RowBox[{"0.7003", " ", 
           FractionBox["1", 
            SuperscriptBox["b", "2"]]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Alpha]F", 
          RowBox[{"2", "\[Pi]"}]]}], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["2", "3"], "+", 
          RowBox[{
           FractionBox["1", "b"], 
           RowBox[{"(", 
            RowBox[{"0.1447", "-", 
             RowBox[{"Log", "[", "b", "]"}]}], ")"}]}], "-", 
          FractionBox["1", 
           SuperscriptBox["b", "2"]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]v", "=", 
       RowBox[{
        FractionBox["\[Alpha]F", 
         RowBox[{"45", "*", "\[Pi]"}]], 
        SuperscriptBox["b", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fB", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"3", "*", "\[Delta]v"}], 
          RowBox[{"q", "+", "m"}]], ")"}], "0.5"]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"1.4", "*", "Ms"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"R", "=", 
       SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"G", "*", "M"}], 
         SuperscriptBox["R", "2"]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"2", "G", " ", "M"}], 
            RowBox[{"R", " ", 
             SuperscriptBox["c", "2"]}]]}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]c", "=", 
       FractionBox[
        RowBox[{"e", " ", "B"}], 
        RowBox[{"me", " ", "c"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ebi", "=", 
       RowBox[{"hbar", "*", "\[Omega]c", "*", 
        RowBox[{
         FractionBox["me", "mp"], "/", "kev2erg"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Rho]v", "=", 
       RowBox[{"0.96", "*", " ", 
        SuperscriptBox["Ye", 
         RowBox[{"-", "1"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Es", "/", "1"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"B", "/", 
           SuperscriptBox["10", "14"]}], ")"}], "2"], 
        SuperscriptBox["fB", 
         RowBox[{"-", "2"}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Tau]v", "=", 
       RowBox[{"\[Tau]1", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"temperature", "[", "\[Tau]1", "]"}], "-", 
            RowBox[{"\[Tau]1", "*", 
             FractionBox[
              RowBox[{"mp", " ", "g"}], 
              RowBox[{"\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb"}]]}]}],
            "\[Equal]", "0"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]1", ",", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox[
               RowBox[{"mp", " ", "g"}], 
               RowBox[{
               "\[Kappa]T", " ", "2", " ", "\[Rho]v", " ", "kb", "*", "5", 
                "*", 
                SuperscriptBox["10", "6"]}]], ")"}], 
             RowBox[{"-", "1"}]]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[Tau]v"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Es", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"5", "*", 
    SuperscriptBox["10", "14"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]v", "=", 
   RowBox[{"\[Tau]reson", "[", 
    RowBox[{"Es", ",", "B"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"10.0", "^", 
    RowBox[{"Range", "[", 
     RowBox[{"a", ",", "b", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linearspace", "[", 
    RowBox[{"a_", ",", "b_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Range", "[", 
    RowBox[{"a", ",", "b", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", "-", "a"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]x1", "=", 
   RowBox[{"logspace", "[", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", "\[Tau]v"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]v"}], "]"}], "]"}], "+", "3"}], ")"}], 
      "*", "20"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]x2", "=", 
   RowBox[{"logspace", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"10", ",", "\[Tau]v"}], "]"}], ",", "4", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "-", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"10", ",", "\[Tau]v"}], "]"}], "]"}]}], ")"}], "*", 
      "20"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"\[Tau]x1", ",", "\[Tau]x2"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]x", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", "89", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"89", "-", "1"}], ")"}], "/", "20"}]}], "]"}], "]"}], "/", 
     "180"}], "*", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ff1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ff2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"Length", "[", "\[Tau]", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Length", "[", "\[Theta]x", "]"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", 
    RowBox[{"k", "\[LessEqual]", 
     RowBox[{"Length", "[", "\[Theta]x", "]"}]}], ",", 
    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", "\[Tau]", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", 
      RowBox[{
       RowBox[{"free", "=", 
        RowBox[{"freeopacity", "[", 
         RowBox[{"B", ",", "Es", ",", 
          RowBox[{"\[Tau]", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]x", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ff1", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}], "=", 
        RowBox[{"free", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"ff2", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}], "=", 
        RowBox[{"free", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<ff1.dat\>\"", ",", "ff1"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<ff2.dat\>\"", ",", "ff2"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8593357377185163`*^9, 3.859335818932798*^9}, 
   3.859337905777779*^9, {3.859347426998925*^9, 3.859347560840873*^9}, {
   3.8593476081770277`*^9, 3.859347689940782*^9}, {3.8593477235245934`*^9, 
   3.8593477303850327`*^9}, {3.859348437841311*^9, 3.859348451818301*^9}, {
   3.8593494017513437`*^9, 3.859349454084115*^9}, {3.859349552832184*^9, 
   3.859349583077594*^9}, {3.859349764718079*^9, 
   3.859349767812955*^9}},ExpressionUUID->"481da65f-2dc2-48c7-8677-\
5a5650423c95"]
},
WindowSize->{1357, 842},
WindowMargins->{{165, Automatic}, {Automatic, -132}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) \
(2020\:5e743\:670813\:65e5)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Report"}, "StandardReport.nb", CharacterEncoding -> 
       "UTF-8"]]], 
   Cell[
    StyleData["Input"], FontSize -> 24], 
   Cell[
    StyleData["Output"], FontSize -> 24]}, 
  WindowMargins -> {{556, Automatic}, {Automatic, -80}}, Visible -> False, 
  FrontEndVersion -> 
  "12.1 for Mac OS X x86 (64-bit) (2020\:5e743\:670813\:65e5)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"469133a3-bfef-4c7c-ad40-5a6bf7ae301d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 43625, 1220, 8249, "Input",ExpressionUUID->"481da65f-2dc2-48c7-8677-5a5650423c95",
 InitializationCell->True]
}
]
*)

